/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/@suprsend";
exports.ids = ["vendor-chunks/@suprsend"];
exports.modules = {

/***/ "(ssr)/./node_modules/@suprsend/react-inbox/dist/index.js":
/*!**********************************************************!*\
  !*** ./node_modules/@suprsend/react-inbox/dist/index.js ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

eval("function _interopDefault (ex) { return (ex && (typeof ex === 'object') && 'default' in ex) ? ex['default'] : ex; }\n\nvar React = __webpack_require__(/*! react */ \"(ssr)/./node_modules/next/dist/server/future/route-modules/app-page/vendored/ssr/react.js\");\nvar React__default = _interopDefault(React);\nvar SuprsendJSInbox = _interopDefault(__webpack_require__(/*! @suprsend/js-inbox */ \"(ssr)/./node_modules/@suprsend/js-inbox/dist/index.cjs\"));\nvar reactPopper = __webpack_require__(/*! react-popper */ \"(ssr)/./node_modules/react-popper/lib/cjs/index.js\");\nvar styled = _interopDefault(__webpack_require__(/*! @emotion/styled */ \"(ssr)/./node_modules/@emotion/styled/dist/emotion-styled.esm.js\"));\nvar react = __webpack_require__(/*! @emotion/react */ \"(ssr)/./node_modules/@emotion/react/dist/emotion-react.esm.js\");\nvar Markdown = _interopDefault(__webpack_require__(/*! react-markdown */ \"(ssr)/./node_modules/react-markdown/index.js\"));\nvar TimeAgo = _interopDefault(__webpack_require__(/*! react-timeago */ \"(ssr)/./node_modules/react-timeago/lib/index.js\"));\nvar InfiniteScroll = _interopDefault(__webpack_require__(/*! react-infinite-scroll-component */ \"(ssr)/./node_modules/react-infinite-scroll-component/dist/index.js\"));\nvar reactToastify = __webpack_require__(/*! react-toastify */ \"(ssr)/./node_modules/react-toastify/dist/react-toastify.js\");\n__webpack_require__(/*! react-toastify/dist/ReactToastify.css */ \"(ssr)/./node_modules/react-toastify/dist/ReactToastify.css\");\n\nfunction _extends() {\n  _extends = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}\nfunction _taggedTemplateLiteralLoose(strings, raw) {\n  if (!raw) {\n    raw = strings.slice(0);\n  }\n  strings.raw = raw;\n  return strings;\n}\n\nvar _templateObject, _templateObject2, _templateObject3;\nvar lightColors = {\n  primary: '#2E70E8',\n  primaryText: '#1E293B',\n  secondaryText: '#475569',\n  border: '#E2E8F0',\n  main: '#FFFFFF',\n  error: '#B42318'\n};\nvar darkColors = {\n  primary: '#2E70E8',\n  primaryText: '#EFEFEF',\n  secondaryText: '#CBD5E1',\n  border: '#3A4A61',\n  main: '#1D2635',\n  error: '#F97066'\n};\nvar CText = styled.p(_templateObject || (_templateObject = _taggedTemplateLiteralLoose([\"\\n  font-size: 14px;\\n  font-weight: 400;\\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica,\\n    Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol';\\n  line-height: 20px;\\n  color: \", \";\\n  margin: 0px;\\n\"])), lightColors.primaryText);\nvar HelperText = styled(CText)(_templateObject2 || (_templateObject2 = _taggedTemplateLiteralLoose([\"\\n  font-size: 12px;\\n  color: \", \";\\n\"])), lightColors.secondaryText);\nvar HeadingText = styled(CText)(_templateObject3 || (_templateObject3 = _taggedTemplateLiteralLoose([\"\\n  font-size: 16px;\\n  font-weight: 500;\\n\"])));\nvar darkTheme = {\n  bell: {\n    color: '#fff'\n  },\n  badge: {\n    backgroundColor: darkColors.primary\n  },\n  header: {\n    container: {\n      backgroundColor: darkColors.main,\n      borderBottom: \"0.5px solid \" + darkColors.border,\n      boxShadow: '0 0 5px 0 rgba(0, 0, 0, 0.5)'\n    },\n    headerText: {\n      color: darkColors.primaryText\n    },\n    markAllReadText: {\n      color: darkColors.primary\n    }\n  },\n  tabs: {\n    color: darkColors.primaryText,\n    unselectedColor: darkColors.secondaryText + 'D9',\n    bottomColor: darkColors.primary,\n    badgeColor: 'rgba(100, 116, 139, 0.5)',\n    badgeText: darkColors.primaryText\n  },\n  notificationsContainer: {\n    container: {\n      backgroundColor: darkColors.main,\n      borderColor: darkColors.border\n    },\n    noNotificationsText: {\n      color: darkColors.primaryText\n    },\n    noNotificationsSubtext: {\n      color: darkColors.secondaryText\n    },\n    loader: {\n      color: darkColors.primary\n    }\n  },\n  notification: {\n    container: {\n      borderBottom: \"1px solid \" + darkColors.border,\n      readBackgroundColor: darkColors.main,\n      unreadBackgroundColor: '#273244',\n      hoverBackgroundColor: '#2D3A4D'\n    },\n    pinnedText: {\n      color: darkColors === null || darkColors === void 0 ? void 0 : darkColors.secondaryText\n    },\n    headerText: {\n      color: darkColors.primaryText\n    },\n    bodyText: {\n      color: darkColors.secondaryText,\n      blockquoteColor: 'rgba(100, 116, 139, 0.5)'\n    },\n    unseenDot: {\n      backgroundColor: darkColors.primary\n    },\n    createdOnText: {\n      color: darkColors.secondaryText\n    },\n    subtext: {\n      color: '#94a3b8'\n    },\n    actions: [{\n      container: {\n        backgroundColor: darkColors.primary\n      }\n    }, {\n      container: {\n        borderColor: darkColors.border,\n        backgroundColor: 'transparent',\n        hoverBackgroundColor: darkColors.main\n      },\n      text: {\n        color: darkColors.secondaryText\n      }\n    }],\n    expiresText: {\n      backgroundColor: 'rgba(100, 116, 139, 0.5)',\n      color: darkColors.secondaryText,\n      expiringBackgroundColor: 'rgba(217, 45, 32, 0.15)',\n      expiringColor: darkColors.error\n    },\n    actionsMenuIcon: {\n      color: darkColors.secondaryText,\n      hoverBackgroundColor: 'rgba(100, 116, 139, 0.5)'\n    },\n    actionsMenu: {\n      backgroundColor: darkColors.main,\n      borderColor: darkColors.border\n    },\n    actionsMenuItem: {\n      hoverBackgroundColor: 'rgba(100, 116, 139, 0.2)'\n    },\n    actionsMenuItemIcon: {\n      color: darkColors.secondaryText\n    },\n    actionsMenuItemText: {\n      color: darkColors.secondaryText\n    }\n  },\n  toast: {\n    container: {\n      backgroundColor: darkColors.main,\n      borderColor: darkColors.border\n    },\n    headerText: {\n      color: darkColors.primaryText\n    },\n    bodyText: {\n      color: darkColors.secondaryText,\n      blockquoteColor: darkColors.border\n    }\n  }\n};\n\nvar DefaultBellIcon = function DefaultBellIcon(_ref) {\n  var style = _ref.style;\n  var height = (style === null || style === void 0 ? void 0 : style.height) || 24;\n  var width = (style === null || style === void 0 ? void 0 : style.width) || 24;\n  var color = (style === null || style === void 0 ? void 0 : style.color) || lightColors.primaryText;\n  if ((style === null || style === void 0 ? void 0 : style.bellType) === 'solid') {\n    return /*#__PURE__*/React__default.createElement(\"svg\", {\n      xmlns: \"http://www.w3.org/2000/svg\",\n      width: width,\n      height: height,\n      color: color,\n      viewBox: \"0 0 20 20\",\n      fill: \"currentColor\"\n    }, /*#__PURE__*/React__default.createElement(\"path\", {\n      d: \"M10 2a6 6 0 00-6 6v3.586l-.707.707A1 1 0 004 14h12a1 1 0 00.707-1.707L16 11.586V8a6 6 0 00-6-6zM10 18a3 3 0 01-3-3h6a3 3 0 01-3 3z\"\n    }));\n  }\n  return /*#__PURE__*/React__default.createElement(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: width,\n    height: height,\n    color: color,\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    stroke: \"currentColor\",\n    strokeWidth: \"2\"\n  }, /*#__PURE__*/React__default.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    d: \"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9\"\n  }));\n};\n\nvar InboxContext = React.createContext({});\nvar InboxThemeContext = React.createContext({});\nfunction useInbox() {\n  return React.useContext(InboxContext);\n}\nfunction useTheme() {\n  return React.useContext(InboxThemeContext);\n}\n\nfunction Bell() {\n  var _useInbox = useInbox(),\n    bellComponent = _useInbox.bellComponent;\n  var _useTheme = useTheme(),\n    bell = _useTheme.bell;\n  if (bellComponent) {\n    var BellComponent = bellComponent;\n    return /*#__PURE__*/React__default.createElement(BellComponent, null);\n  }\n  return /*#__PURE__*/React__default.createElement(DefaultBellIcon, {\n    style: bell\n  });\n}\n\nvar _templateObject$1;\nfunction Badge() {\n  var _useInbox = useInbox(),\n    count = _useInbox.notificationsData.count,\n    badgeComponent = _useInbox.badgeComponent;\n  var _useTheme = useTheme(),\n    badge = _useTheme.badge;\n  if (count > 0) {\n    if (badgeComponent) {\n      var BagdeComponent = badgeComponent;\n      return /*#__PURE__*/React__default.createElement(BagdeComponent, {\n        count: count\n      });\n    }\n    return /*#__PURE__*/React__default.createElement(CountText, {\n      style: badge\n    }, count);\n  }\n  return null;\n}\nvar CountText = styled(CText)(_templateObject$1 || (_templateObject$1 = _taggedTemplateLiteralLoose([\"\\n  position: absolute;\\n  right: -3px;\\n  top: -7px;\\n  display: inline-block;\\n  font-size: 10px;\\n  line-height: 1;\\n  padding: 3px 6px;\\n  border-radius: 50%;\\n  background-color: \", \";\\n  color: \", \";\\n  text-align: center;\\n\"])), lightColors.primary, lightColors.main);\n\nvar isImgUrl = function isImgUrl(url) {\n  try {\n    if (url) {\n      var img = new window.Image();\n      img.src = url;\n      return Promise.resolve(new Promise(function (resolve) {\n        img.onerror = function () {\n          return resolve(false);\n        };\n        img.onload = function () {\n          return resolve(true);\n        };\n      }));\n    }\n    return Promise.resolve();\n  } catch (e) {\n    return Promise.reject(e);\n  }\n};\nfunction isObject(item) {\n  return item && typeof item === 'object' && !Array.isArray(item);\n}\nfunction mergeDeep(target, source) {\n  var output = Object.assign({}, target);\n  if (isObject(target) && isObject(source)) {\n    Object.keys(source).forEach(function (key) {\n      if (isObject(source[key])) {\n        var _Object$assign;\n        if (!(key in target)) Object.assign(output, (_Object$assign = {}, _Object$assign[key] = source[key], _Object$assign));else output[key] = mergeDeep(target[key], source[key]);\n      } else {\n        var _Object$assign2;\n        Object.assign(output, (_Object$assign2 = {}, _Object$assign2[key] = source[key], _Object$assign2));\n      }\n    });\n  }\n  return output;\n}\nfunction formatActionLink(link) {\n  if (!link) return;\n  if (link.startsWith('http') || link.startsWith('/')) {\n    return link;\n  } else {\n    return \"https://\" + link;\n  }\n}\nfunction getLongFormattedTime(value, unit) {\n  switch (unit) {\n    case 'second':\n      return 'a minute';\n    case 'minute':\n      return value === 1 ? value + \" minute\" : value + \" minutes\";\n    case 'hour':\n      return value === 1 ? value + \" hour\" : value + \" hours\";\n    case 'day':\n      return value === 1 ? value + \" day\" : value + \" days\";\n    case 'week':\n      return value === 1 ? value + \" week\" : value + \" weeks\";\n    case 'month':\n      return value === 1 ? value + \" month\" : value + \" months\";\n    case 'year':\n      return value === 1 ? value + \" year\" : value + \" years\";\n    default:\n      return value;\n  }\n}\nfunction getShortFormattedTime(value, unit) {\n  switch (unit) {\n    case 'second':\n      return '1m';\n    case 'minute':\n      return value + \"m\";\n    case 'hour':\n      return value + \"h\";\n    case 'day':\n      return value + \"d\";\n    case 'week':\n      return value + \"w\";\n    case 'month':\n      return value + \"mo\";\n    case 'year':\n      return value + \"y\";\n    default:\n      return value;\n  }\n}\n\nvar AvatarIcon = function AvatarIcon(_ref) {\n  var type = _ref.type;\n  if (type === 'dark') {\n    return /*#__PURE__*/React__default.createElement(\"svg\", {\n      width: \"36\",\n      height: \"36\",\n      viewBox: \"0 0 36 36\",\n      fill: \"none\",\n      xmlns: \"http://www.w3.org/2000/svg\"\n    }, /*#__PURE__*/React__default.createElement(\"circle\", {\n      cx: \"18\",\n      cy: \"18\",\n      r: \"18\",\n      fill: \"#334155\"\n    }), /*#__PURE__*/React__default.createElement(\"path\", {\n      d: \"M23.8641 14.2836C23.8641 17.3522 21.4556 19.8399 18.4844 19.8399C15.5132 19.8399 13.1047 17.3522 13.1047 14.2836C13.1047 11.215 15.5132 8.72754 18.4844 8.72754C21.4556 8.72754 23.8641 11.215 23.8641 14.2836Z\",\n      fill: \"#94A3B8\"\n    }), /*#__PURE__*/React__default.createElement(\"path\", {\n      d: \"M23.8643 20.9316H13.1051C11.1039 20.9316 9.37694 22.0734 8.4502 23.75C10.6277 27.0754 14.3128 29.2659 18.4848 29.2659C22.6568 29.2659 26.3418 27.0754 28.5195 23.75C27.5913 22.0734 25.866 20.9316 23.8645 20.9316H23.8643Z\",\n      fill: \"#94A3B8\"\n    }));\n  }\n  return /*#__PURE__*/React__default.createElement(\"svg\", {\n    width: \"36\",\n    height: \"36\",\n    viewBox: \"0 0 36 36\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\"\n  }, /*#__PURE__*/React__default.createElement(\"circle\", {\n    cx: \"18\",\n    cy: \"18\",\n    r: \"18\",\n    fill: \"#CBD5E1\"\n  }), /*#__PURE__*/React__default.createElement(\"path\", {\n    d: \"M23.8641 14.2836C23.8641 17.3522 21.4556 19.8399 18.4844 19.8399C15.5132 19.8399 13.1047 17.3522 13.1047 14.2836C13.1047 11.215 15.5132 8.72754 18.4844 8.72754C21.4556 8.72754 23.8641 11.215 23.8641 14.2836Z\",\n    fill: \"white\"\n  }), /*#__PURE__*/React__default.createElement(\"path\", {\n    d: \"M23.8643 20.9316H13.1051C11.1039 20.9316 9.37694 22.0734 8.4502 23.75C10.6277 27.0754 14.3128 29.2659 18.4848 29.2659C22.6568 29.2659 26.3418 27.0754 28.5195 23.75C27.5913 22.0734 25.866 20.9316 23.8645 20.9316H23.8643Z\",\n    fill: \"white\"\n  }));\n};\n\nvar MoreIcon = function MoreIcon(_ref) {\n  var style = _ref.style;\n  var height = (style === null || style === void 0 ? void 0 : style.height) || 20;\n  var width = (style === null || style === void 0 ? void 0 : style.width) || 20;\n  var color = (style === null || style === void 0 ? void 0 : style.color) || lightColors.secondaryText;\n  return /*#__PURE__*/React__default.createElement(\"svg\", {\n    width: width,\n    height: height,\n    viewBox: \"0 0 24 24\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\"\n  }, /*#__PURE__*/React__default.createElement(\"path\", {\n    d: \"M12 13C12.5523 13 13 12.5523 13 12C13 11.4477 12.5523 11 12 11C11.4477 11 11 11.4477 11 12C11 12.5523 11.4477 13 12 13Z\",\n    stroke: color,\n    strokeWidth: \"2\",\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  }), /*#__PURE__*/React__default.createElement(\"path\", {\n    d: \"M19 13C19.5523 13 20 12.5523 20 12C20 11.4477 19.5523 11 19 11C18.4477 11 18 11.4477 18 12C18 12.5523 18.4477 13 19 13Z\",\n    stroke: color,\n    strokeWidth: \"2\",\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  }), /*#__PURE__*/React__default.createElement(\"path\", {\n    d: \"M5 13C5.55228 13 6 12.5523 6 12C6 11.4477 5.55228 11 5 11C4.44772 11 4 11.4477 4 12C4 12.5523 4.44772 13 5 13Z\",\n    stroke: color,\n    strokeWidth: \"2\",\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  }));\n};\n\nvar PinnedNotificationIcon = function PinnedNotificationIcon(_ref) {\n  var style = _ref.style;\n  var height = (style === null || style === void 0 ? void 0 : style.height) || 13;\n  var width = (style === null || style === void 0 ? void 0 : style.width) || 13;\n  var color = (style === null || style === void 0 ? void 0 : style.color) || '#DC6803';\n  return /*#__PURE__*/React__default.createElement(\"svg\", {\n    width: width,\n    height: height,\n    viewBox: \"0 0 16 17\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\"\n  }, /*#__PURE__*/React__default.createElement(\"path\", {\n    d: \"M7.58984 2.9305C7.38193 2.44536 7.27797 2.2028 7.10998 2.09261C6.96308 1.99626 6.78408 1.96179 6.6119 1.99669C6.415 2.03661 6.22839 2.22321 5.85518 2.59643L2.42642 6.02519C2.0532 6.39841 1.86659 6.58502 1.82668 6.78191C1.79177 6.95409 1.82624 7.13309 1.9226 7.28C2.03278 7.44799 2.27535 7.55194 2.76048 7.75986L4.42339 8.47253C4.49393 8.50277 4.5292 8.51788 4.56228 8.53678C4.59166 8.55356 4.61972 8.57256 4.64622 8.59361C4.67605 8.6173 4.70318 8.64444 4.75745 8.69871L5.79805 9.7393C5.88293 9.82418 5.92537 9.86662 5.95909 9.91498C5.98903 9.9579 6.0138 10.0042 6.03291 10.0529C6.05444 10.1078 6.06621 10.1666 6.08975 10.2844L6.57835 12.7273C6.70532 13.3622 6.76881 13.6796 6.93618 13.8281C7.08198 13.9575 7.27711 14.0166 7.47019 13.9898C7.69183 13.9591 7.92074 13.7302 8.37855 13.2724L13.1024 8.54856C13.5602 8.09075 13.7891 7.86185 13.8198 7.64021C13.8466 7.44713 13.7875 7.252 13.6581 7.10619C13.5096 6.93882 13.1922 6.87534 12.5573 6.74836L10.1143 6.25977C9.99663 6.23622 9.93777 6.22445 9.88289 6.20293C9.83418 6.18382 9.78788 6.15904 9.74496 6.12911C9.69661 6.09538 9.65416 6.05294 9.56928 5.96806L8.52869 4.92747C8.47442 4.8732 8.44729 4.84606 8.42359 4.81624C8.40255 4.78974 8.38355 4.76168 8.36676 4.73229C8.34787 4.69922 8.33275 4.66395 8.30252 4.5934L7.58984 2.9305Z\",\n    fill: color\n  }), /*#__PURE__*/React__default.createElement(\"path\", {\n    d: \"M10.7405 10.9105L14.5117 14.6817M8.52869 4.92747L9.56928 5.96806C9.65416 6.05294 9.69661 6.09538 9.74496 6.12911C9.78788 6.15904 9.83418 6.18382 9.88289 6.20293C9.93777 6.22445 9.99663 6.23622 10.1143 6.25977L12.5573 6.74836C13.1922 6.87534 13.5096 6.93882 13.6581 7.10619C13.7875 7.252 13.8466 7.44713 13.8198 7.64021C13.7891 7.86185 13.5602 8.09075 13.1024 8.54856L8.37855 13.2724C7.92074 13.7302 7.69183 13.9591 7.47019 13.9898C7.27711 14.0166 7.08198 13.9575 6.93618 13.8281C6.76881 13.6796 6.70532 13.3622 6.57835 12.7273L6.08975 10.2844C6.06621 10.1666 6.05444 10.1078 6.03291 10.0529C6.0138 10.0042 5.98903 9.9579 5.95909 9.91498C5.92537 9.86662 5.88293 9.82418 5.79805 9.7393L4.75745 8.69871C4.70318 8.64444 4.67605 8.6173 4.64622 8.59361C4.61972 8.57256 4.59166 8.55356 4.56228 8.53678C4.5292 8.51788 4.49393 8.50277 4.42339 8.47253L2.76048 7.75986C2.27535 7.55194 2.03278 7.44799 1.9226 7.28C1.82624 7.13309 1.79177 6.95409 1.82668 6.78191C1.86659 6.58502 2.0532 6.39841 2.42642 6.02519L5.85517 2.59643C6.22839 2.22321 6.415 2.03661 6.6119 1.99669C6.78408 1.96179 6.96308 1.99626 7.10998 2.09261C7.27797 2.2028 7.38193 2.44536 7.58984 2.9305L8.30252 4.5934C8.33275 4.66395 8.34787 4.69922 8.36676 4.73229C8.38355 4.76168 8.40255 4.78974 8.42359 4.81624C8.44729 4.84606 8.47442 4.8732 8.52869 4.92747Z\",\n    stroke: color,\n    strokeWidth: \"1.33333\",\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  }));\n};\n\nvar UnReadIcon = function UnReadIcon(_ref) {\n  var style = _ref.style;\n  var height = (style === null || style === void 0 ? void 0 : style.height) || 16;\n  var width = (style === null || style === void 0 ? void 0 : style.width) || 16;\n  var color = (style === null || style === void 0 ? void 0 : style.color) || lightColors.primaryText;\n  return /*#__PURE__*/React__default.createElement(\"svg\", {\n    width: width,\n    height: height,\n    viewBox: \"0 0 24 24\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\"\n  }, /*#__PURE__*/React__default.createElement(\"path\", {\n    fillRule: \"evenodd\",\n    clipRule: \"evenodd\",\n    d: \"M14.416 3H4.00013C2.34327 3 1.00013 4.34315 1.00013 6V6.98313C0.999958 6.99375 0.999958 7.00437 1.00013 7.01499V18C1.00013 19.6569 2.34327 21 4.00013 21H20.0001C21.657 21 23.0001 19.6569 23.0001 18V9.21078H21.0001V18C21.0001 18.5523 20.5524 19 20.0001 19H4.00013C3.44784 19 3.00013 18.5523 3.00013 18V8.82027L10.4338 13.544L10.4392 13.5474C10.9071 13.8405 11.448 13.996 12.0001 13.996C12.5522 13.996 13.0932 13.8405 13.5611 13.5474L13.5665 13.544L19.5 9.21078H16.5L12.4992 11.8526L12.497 11.854C12.3479 11.9468 12.1758 11.996 12.0001 11.996C11.8245 11.996 11.6524 11.9468 11.5033 11.854L3.00013 6.45063V6C3.00013 5.44772 3.44784 5 4.00013 5H14.416V3Z\",\n    fill: color\n  }), /*#__PURE__*/React__default.createElement(\"circle\", {\n    cx: \"20\",\n    cy: \"4\",\n    r: \"4\",\n    fill: color\n  }));\n};\n\nvar ReadIcon = function ReadIcon(_ref) {\n  var style = _ref.style;\n  var height = (style === null || style === void 0 ? void 0 : style.height) || 16;\n  var width = (style === null || style === void 0 ? void 0 : style.width) || 16;\n  var color = (style === null || style === void 0 ? void 0 : style.color) || lightColors.primaryText;\n  return /*#__PURE__*/React__default.createElement(\"svg\", {\n    width: width,\n    height: height,\n    viewBox: \"0 0 16 17\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\"\n  }, /*#__PURE__*/React__default.createElement(\"path\", {\n    d: \"M14.1334 6.26471C14.4667 6.51805 14.6667 6.91138 14.6667 7.33138V13.998C14.6667 14.3517 14.5262 14.6908 14.2762 14.9409C14.0261 15.1909 13.687 15.3314 13.3334 15.3314H2.66671C2.31309 15.3314 1.97395 15.1909 1.7239 14.9409C1.47385 14.6908 1.33337 14.3517 1.33337 13.998V7.33138C1.33337 7.12439 1.38157 6.92024 1.47414 6.7351C1.56671 6.54995 1.70111 6.38891 1.86671 6.26471L7.20004 2.26471C7.43084 2.09162 7.71155 1.99805 8.00004 1.99805C8.28853 1.99805 8.56925 2.09162 8.80004 2.26471L14.1334 6.26471Z\",\n    stroke: color,\n    strokeWidth: \"1.33333\",\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  }), /*#__PURE__*/React__default.createElement(\"path\", {\n    d: \"M14.6667 7.33105L8.68668 11.1311C8.48086 11.26 8.24289 11.3284 8.00001 11.3284C7.75713 11.3284 7.51916 11.26 7.31334 11.1311L1.33334 7.33105\",\n    stroke: color,\n    strokeWidth: \"1.33333\",\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  }));\n};\n\nvar ArchiveIcon = function ArchiveIcon(_ref) {\n  var style = _ref.style;\n  var height = (style === null || style === void 0 ? void 0 : style.height) || 17;\n  var width = (style === null || style === void 0 ? void 0 : style.width) || 16;\n  var color = (style === null || style === void 0 ? void 0 : style.color) || lightColors.secondaryText;\n  return /*#__PURE__*/React__default.createElement(\"svg\", {\n    width: width,\n    height: height,\n    viewBox: \"0 0 16 17\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\"\n  }, /*#__PURE__*/React__default.createElement(\"path\", {\n    d: \"M14 2.33789H1.99998C1.63179 2.33789 1.33331 2.63637 1.33331 3.00456V5.00456C1.33331 5.37275 1.63179 5.67122 1.99998 5.67122H14C14.3682 5.67122 14.6666 5.37275 14.6666 5.00456V3.00456C14.6666 2.63637 14.3682 2.33789 14 2.33789Z\",\n    stroke: color,\n    strokeWidth: \"1.33333\",\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  }), /*#__PURE__*/React__default.createElement(\"path\", {\n    d: \"M2.66669 5.67188V13.0052C2.66669 13.3588 2.80716 13.698 3.05721 13.948C3.30726 14.1981 3.6464 14.3385 4.00002 14.3385H12C12.3536 14.3385 12.6928 14.1981 12.9428 13.948C13.1929 13.698 13.3334 13.3588 13.3334 13.0052V5.67188\",\n    stroke: color,\n    strokeWidth: \"1.33333\",\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  }), /*#__PURE__*/React__default.createElement(\"path\", {\n    d: \"M6.66669 8.33789H9.33335\",\n    stroke: color,\n    strokeWidth: \"1.33333\",\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\"\n  }));\n};\n\nvar _templateObject$2, _templateObject2$1, _templateObject3$1, _templateObject4, _templateObject5, _templateObject6, _templateObject7, _templateObject8, _templateObject9, _templateObject10, _templateObject11, _templateObject12, _templateObject13, _templateObject14, _templateObject15, _templateObject16, _templateObject17, _templateObject18, _templateObject19, _templateObject20, _templateObject21, _templateObject22, _templateObject23, _templateObject24, _templateObject25, _templateObject26, _templateObject27;\nfunction ExpiryTime(_ref) {\n  var dateInput = _ref.dateInput,\n    style = _ref.style;\n  var date = dateInput;\n  var _useState = React.useState(Date.now()),\n    setTime = _useState[1];\n  React.useEffect(function () {\n    var interval = setInterval(function () {\n      return setTime(Date.now());\n    }, 10000);\n    return function () {\n      clearInterval(interval);\n    };\n  }, []);\n  var isExpiring = date - Date.now() <= 3600000;\n  var expiredAlready = Date.now() >= date;\n  if (typeof dateInput === 'number') {\n    return /*#__PURE__*/React__default.createElement(\"div\", null, /*#__PURE__*/React__default.createElement(ExpiresText, {\n      style: _extends({}, style, {\n        color: isExpiring ? (style === null || style === void 0 ? void 0 : style.expiringColor) || lightColors.error : (style === null || style === void 0 ? void 0 : style.color) || lightColors.secondaryText,\n        backgroundColor: isExpiring ? (style === null || style === void 0 ? void 0 : style.expiringBackgroundColor) || 'rgba(217, 45, 32, 0.09)' : (style === null || style === void 0 ? void 0 : style.backgroundColor) || 'rgba(100, 116, 139, 0.09)'\n      })\n    }, \"Expires in\", ' ', expiredAlready ? 'a minute' : /*#__PURE__*/React__default.createElement(TimeAgo, {\n      date: date,\n      live: false,\n      formatter: getLongFormattedTime\n    })));\n  } else {\n    return null;\n  }\n}\nfunction Notification(_ref2) {\n  var _notification$bodyTex, _notification$bodyTex2, _message$actions, _message$actions2, _message$avatar2, _message$text, _message$text$replace, _message$text$replace2, _message$subtext, _message$subtext2, _notification$actions, _notification$actions2, _notification$actions3, _notification$actions4, _notification$actions5, _notification$actions6, _notification$actions7, _notification$actions8, _notification$actions9;\n  var notificationData = _ref2.notificationData,\n    handleActionClick = _ref2.handleActionClick;\n  var _useState2 = React.useState(false),\n    validAvatar = _useState2[0],\n    setValidAvatar = _useState2[1];\n  var _useState3 = React.useState(false),\n    showMore = _useState3[0],\n    setShowMore = _useState3[1];\n  var _useState4 = React.useState(false),\n    moreOpen = _useState4[0],\n    setMoreOpen = _useState4[1];\n  var message = notificationData.message,\n    seenOn = notificationData.seen_on,\n    createdOn = notificationData.created_on;\n  var _useInbox = useInbox(),\n    notificationComponent = _useInbox.notificationComponent,\n    hideAvatar = _useInbox.hideAvatar,\n    inbox = _useInbox.inbox,\n    themeType = _useInbox.themeType;\n  var _useTheme = useTheme(),\n    notification = _useTheme.notification;\n  var blockquoteColor = (notification === null || notification === void 0 ? void 0 : (_notification$bodyTex = notification.bodyText) === null || _notification$bodyTex === void 0 ? void 0 : _notification$bodyTex.blockquoteColor) || 'rgba(100, 116, 139, 0.3)';\n  var linkColor = (notification === null || notification === void 0 ? void 0 : (_notification$bodyTex2 = notification.bodyText) === null || _notification$bodyTex2 === void 0 ? void 0 : _notification$bodyTex2.linkColor) || lightColors.primary;\n  var actionOne = message === null || message === void 0 ? void 0 : (_message$actions = message.actions) === null || _message$actions === void 0 ? void 0 : _message$actions[0];\n  var actionTwo = message === null || message === void 0 ? void 0 : (_message$actions2 = message.actions) === null || _message$actions2 === void 0 ? void 0 : _message$actions2[1];\n  var hasButtons = actionOne || actionTwo;\n  React.useEffect(function () {\n    var _message$avatar;\n    var isValidAvatar = isImgUrl(message === null || message === void 0 ? void 0 : (_message$avatar = message.avatar) === null || _message$avatar === void 0 ? void 0 : _message$avatar.avatar_url);\n    isValidAvatar.then(function (res) {\n      return setValidAvatar(res);\n    });\n  }, [notificationData]);\n  if (notificationComponent) {\n    var NotificationComponent = notificationComponent;\n    return /*#__PURE__*/React__default.createElement(NotificationComponent, {\n      notificationData: notificationData\n    });\n  }\n  return /*#__PURE__*/React__default.createElement(Container, {\n    style: notification === null || notification === void 0 ? void 0 : notification.container,\n    read: !!seenOn,\n    onMouseEnter: function onMouseEnter() {\n      setShowMore(true);\n      setMoreOpen(false);\n    },\n    onMouseLeave: function onMouseLeave() {\n      setShowMore(false);\n      setMoreOpen(false);\n    },\n    onClick: function onClick(e) {\n      if (moreOpen) {\n        e.stopPropagation();\n        setMoreOpen(false);\n      }\n    }\n  }, notificationData.is_pinned && /*#__PURE__*/React__default.createElement(PinnedView, {\n    hideAvatar: hideAvatar\n  }, /*#__PURE__*/React__default.createElement(PinnedNotificationIcon, {\n    style: notification === null || notification === void 0 ? void 0 : notification.pinnedIcon\n  }), /*#__PURE__*/React__default.createElement(PinnedNotificationText, {\n    style: notification === null || notification === void 0 ? void 0 : notification.pinnedText\n  }, \"Pinned\")), /*#__PURE__*/React__default.createElement(NotificationView, null, /*#__PURE__*/React__default.createElement(LeftView, null, /*#__PURE__*/React__default.createElement(LeftAvatarView, null, /*#__PURE__*/React__default.createElement(UnseenDot, {\n    style: notification === null || notification === void 0 ? void 0 : notification.unseenDot,\n    show: !seenOn\n  }), !hideAvatar && /*#__PURE__*/React__default.createElement(AvatarView, {\n    onClick: function onClick(e) {\n      var avatarData = message === null || message === void 0 ? void 0 : message.avatar;\n      handleActionClick(e, {\n        type: 'avatar',\n        url: avatarData === null || avatarData === void 0 ? void 0 : avatarData.action_url,\n        target: avatarData === null || avatarData === void 0 ? void 0 : avatarData.open_in_new_tab\n      });\n    }\n  }, message !== null && message !== void 0 && (_message$avatar2 = message.avatar) !== null && _message$avatar2 !== void 0 && _message$avatar2.avatar_url && validAvatar ? /*#__PURE__*/React__default.createElement(AvatarImage, {\n    src: message.avatar.avatar_url,\n    alt: \"avatar\",\n    style: notification === null || notification === void 0 ? void 0 : notification.avatar\n  }) : /*#__PURE__*/React__default.createElement(AvatarIcon, {\n    type: themeType\n  }))), /*#__PURE__*/React__default.createElement(ContentView, null, message.header && /*#__PURE__*/React__default.createElement(HeaderText, {\n    style: notification === null || notification === void 0 ? void 0 : notification.headerText\n  }, message.header), /*#__PURE__*/React__default.createElement(BodyText, {\n    style: notification === null || notification === void 0 ? void 0 : notification.bodyText\n  }, /*#__PURE__*/React__default.createElement(Markdown, {\n    components: {\n      a: function a(_ref3) {\n        var children = _ref3.children,\n          href = _ref3.href;\n        return /*#__PURE__*/React__default.createElement(\"span\", {\n          onClick: function onClick(e) {\n            e.preventDefault();\n            handleActionClick(e, {\n              type: 'markdown_link',\n              url: href\n            });\n          },\n          style: {\n            color: linkColor,\n            textDecoration: 'none'\n          }\n        }, children);\n      },\n      p: function p(_ref4) {\n        var children = _ref4.children;\n        return /*#__PURE__*/React__default.createElement(\"p\", {\n          style: {\n            margin: 0,\n            overflowWrap: 'anywhere'\n          }\n        }, children);\n      },\n      blockquote: function blockquote(_ref5) {\n        var children = _ref5.children;\n        return /*#__PURE__*/React__default.createElement(\"blockquote\", {\n          style: {\n            margin: 0,\n            paddingLeft: 10,\n            borderLeft: \"3px \" + blockquoteColor + \" solid\",\n            marginBottom: 5,\n            marginTop: 5\n          }\n        }, children);\n      },\n      ul: function ul(_ref6) {\n        var children = _ref6.children;\n        return /*#__PURE__*/React__default.createElement(\"ul\", {\n          style: {\n            whiteSpace: 'normal',\n            margin: 0,\n            paddingLeft: 10\n          }\n        }, children);\n      },\n      ol: function ol(_ref7) {\n        var children = _ref7.children;\n        return /*#__PURE__*/React__default.createElement(\"ol\", {\n          style: {\n            whiteSpace: 'normal',\n            margin: 0,\n            paddingLeft: 10\n          }\n        }, children);\n      },\n      img: function img(props) {\n        return /*#__PURE__*/React__default.createElement(\"img\", _extends({\n          style: {\n            maxWidth: '100%',\n            objectFit: 'contain'\n          }\n        }, props));\n      }\n    }\n  }, message === null || message === void 0 ? void 0 : (_message$text = message.text) === null || _message$text === void 0 ? void 0 : (_message$text$replace = _message$text.replaceAll('\\\\\\n', '&nbsp;')) === null || _message$text$replace === void 0 ? void 0 : (_message$text$replace2 = _message$text$replace.replaceAll('\\n', '  \\n')) === null || _message$text$replace2 === void 0 ? void 0 : _message$text$replace2.replaceAll('&nbsp;', '&nbsp;  \\n'))), !!(message !== null && message !== void 0 && (_message$subtext = message.subtext) !== null && _message$subtext !== void 0 && _message$subtext.text) && /*#__PURE__*/React__default.createElement(SubTextView, {\n    link: message === null || message === void 0 ? void 0 : (_message$subtext2 = message.subtext) === null || _message$subtext2 === void 0 ? void 0 : _message$subtext2.action_url,\n    onClick: function onClick(e) {\n      var subTextData = message === null || message === void 0 ? void 0 : message.subtext;\n      handleActionClick(e, {\n        type: 'subtext',\n        url: subTextData === null || subTextData === void 0 ? void 0 : subTextData.action_url,\n        target: subTextData === null || subTextData === void 0 ? void 0 : subTextData.open_in_new_tab\n      });\n    }\n  }, /*#__PURE__*/React__default.createElement(SubText, {\n    style: notification === null || notification === void 0 ? void 0 : notification.subtext\n  }, message.subtext.text)), notificationData.expiry && (notificationData === null || notificationData === void 0 ? void 0 : notificationData.is_expiry_visible) && /*#__PURE__*/React__default.createElement(ExpiryTime, {\n    dateInput: notificationData.expiry,\n    style: notification === null || notification === void 0 ? void 0 : notification.expiresText\n  }), hasButtons && /*#__PURE__*/React__default.createElement(ButtonContainer, null, actionOne && /*#__PURE__*/React__default.createElement(ButtonView, {\n    style: notification === null || notification === void 0 ? void 0 : (_notification$actions = notification.actions) === null || _notification$actions === void 0 ? void 0 : (_notification$actions2 = _notification$actions[0]) === null || _notification$actions2 === void 0 ? void 0 : _notification$actions2.container,\n    key: actionOne.id,\n    onClick: function onClick(e) {\n      handleActionClick(e, {\n        type: 'action_button',\n        url: actionOne.url,\n        target: actionOne.open_in_new_tab\n      });\n    }\n  }, /*#__PURE__*/React__default.createElement(ButtonText, {\n    style: notification === null || notification === void 0 ? void 0 : (_notification$actions3 = notification.actions) === null || _notification$actions3 === void 0 ? void 0 : (_notification$actions4 = _notification$actions3[0]) === null || _notification$actions4 === void 0 ? void 0 : _notification$actions4.text\n  }, actionOne.name)), actionTwo && /*#__PURE__*/React__default.createElement(ButtonOutlineView, {\n    key: actionTwo.id,\n    style: notification === null || notification === void 0 ? void 0 : (_notification$actions5 = notification.actions) === null || _notification$actions5 === void 0 ? void 0 : (_notification$actions6 = _notification$actions5[1]) === null || _notification$actions6 === void 0 ? void 0 : _notification$actions6.container,\n    onClick: function onClick(e) {\n      handleActionClick(e, {\n        type: 'action_button',\n        url: actionTwo.url,\n        target: actionTwo.open_in_new_tab\n      });\n    }\n  }, /*#__PURE__*/React__default.createElement(ButtonOutlineText, {\n    style: notification === null || notification === void 0 ? void 0 : (_notification$actions7 = notification.actions) === null || _notification$actions7 === void 0 ? void 0 : (_notification$actions8 = _notification$actions7[1]) === null || _notification$actions8 === void 0 ? void 0 : _notification$actions8.text\n  }, actionTwo.name))))), /*#__PURE__*/React__default.createElement(RightView, null, /*#__PURE__*/React__default.createElement(CreatedText, {\n    style: notification === null || notification === void 0 ? void 0 : notification.createdOnText\n  }, /*#__PURE__*/React__default.createElement(TimeAgo, {\n    date: createdOn,\n    live: false,\n    formatter: getShortFormattedTime\n  })), /*#__PURE__*/React__default.createElement(CMenuView, {\n    showMore: showMore\n  }, /*#__PURE__*/React__default.createElement(CMenuButton, {\n    hoverBGColor: notification === null || notification === void 0 ? void 0 : (_notification$actions9 = notification.actionsMenuIcon) === null || _notification$actions9 === void 0 ? void 0 : _notification$actions9.hoverBackgroundColor,\n    onClick: function onClick(e) {\n      e.stopPropagation();\n      setMoreOpen(function (prev) {\n        return !prev;\n      });\n    }\n  }, /*#__PURE__*/React__default.createElement(MoreIcon, {\n    style: notification === null || notification === void 0 ? void 0 : notification.actionsMenuIcon\n  })), /*#__PURE__*/React__default.createElement(CMenuPopup, {\n    moreOpen: moreOpen,\n    style: notification === null || notification === void 0 ? void 0 : notification.actionsMenu\n  }, notificationData.seen_on ? /*#__PURE__*/React__default.createElement(CMenuItem, {\n    style: notification === null || notification === void 0 ? void 0 : notification.actionsMenuItem,\n    onClick: function onClick(e) {\n      e.stopPropagation();\n      inbox.feed.markUnRead(notificationData.n_id);\n      setMoreOpen(false);\n    }\n  }, /*#__PURE__*/React__default.createElement(UnReadIcon, {\n    style: notification === null || notification === void 0 ? void 0 : notification.actionsMenuItemIcon\n  }), /*#__PURE__*/React__default.createElement(CMenuText, {\n    style: notification === null || notification === void 0 ? void 0 : notification.actionsMenuItemText\n  }, \"Mark as unread\")) : /*#__PURE__*/React__default.createElement(CMenuItem, {\n    style: notification === null || notification === void 0 ? void 0 : notification.actionsMenuItem,\n    onClick: function onClick(e) {\n      e.stopPropagation();\n      inbox.feed.markRead(notificationData.n_id);\n      setMoreOpen(false);\n    }\n  }, /*#__PURE__*/React__default.createElement(ReadIcon, {\n    style: notification === null || notification === void 0 ? void 0 : notification.actionsMenuItemIcon\n  }), /*#__PURE__*/React__default.createElement(CMenuText, {\n    style: notification === null || notification === void 0 ? void 0 : notification.actionsMenuItemText\n  }, \"Mark as read\")), !(notificationData !== null && notificationData !== void 0 && notificationData.archived) && /*#__PURE__*/React__default.createElement(CMenuItem, {\n    style: notification === null || notification === void 0 ? void 0 : notification.actionsMenuItem,\n    onClick: function onClick(e) {\n      e.stopPropagation();\n      inbox.feed.markArchived(notificationData.n_id);\n    }\n  }, /*#__PURE__*/React__default.createElement(ArchiveIcon, {\n    style: notification === null || notification === void 0 ? void 0 : notification.actionsMenuItemIcon\n  }), /*#__PURE__*/React__default.createElement(CMenuText, {\n    style: notification === null || notification === void 0 ? void 0 : notification.actionsMenuItemText\n  }, \"Archive\")))))));\n}\nvar Container = styled.div(_templateObject$2 || (_templateObject$2 = _taggedTemplateLiteralLoose([\"\\n  padding: 16px;\\n  cursor: pointer;\\n  background-color: \", \";\\n  border-bottom: 0.5px solid \", \";\\n  &:hover {\\n    background-color: \", \"\\n\"])), function (props) {\n  var _props$style, _props$style2;\n  return props.read ? (props === null || props === void 0 ? void 0 : (_props$style = props.style) === null || _props$style === void 0 ? void 0 : _props$style.readBackgroundColor) || lightColors.main : (props === null || props === void 0 ? void 0 : (_props$style2 = props.style) === null || _props$style2 === void 0 ? void 0 : _props$style2.unreadBackgroundColor) || '#edf3ff';\n}, lightColors.border, function (props) {\n  var _props$style3;\n  return (props === null || props === void 0 ? void 0 : (_props$style3 = props.style) === null || _props$style3 === void 0 ? void 0 : _props$style3.hoverBackgroundColor) || '#DBE7FF';\n});\nvar PinnedView = styled.div(_templateObject2$1 || (_templateObject2$1 = _taggedTemplateLiteralLoose([\"\\n  display: flex;\\n  align-items: center;\\n  margin-left: \", \";\\n  gap: 4px;\\n\"])), function (props) {\n  return props.hideAvatar ? '0px' : '52px';\n});\nvar PinnedNotificationText = styled(HelperText)(_templateObject3$1 || (_templateObject3$1 = _taggedTemplateLiteralLoose([\"\"])));\nvar SubText = styled(HelperText)(_templateObject4 || (_templateObject4 = _taggedTemplateLiteralLoose([\"\\n  color: #64748b;\\n\"])));\nvar SubTextView = styled.div(_templateObject5 || (_templateObject5 = _taggedTemplateLiteralLoose([\"\\n  text-decoration: none;\\n  overflow-wrap: anywhere;\\n  display: inline-block;\\n  &:hover {\\n    text-decoration: \", \";\\n    text-decoration-color: \", \";\\n  }\\n\"])), function (props) {\n  return props.link ? 'underline' : 'none';\n}, lightColors.secondaryText);\nvar ExpiresText = styled(HelperText)(_templateObject6 || (_templateObject6 = _taggedTemplateLiteralLoose([\"\\n  margin-top: 8px;\\n  display: inline-block;\\n  padding: 1px 6px;\\n  border-radius: 4px;\\n\"])));\nvar NotificationView = styled.div(_templateObject7 || (_templateObject7 = _taggedTemplateLiteralLoose([\"\\n  display: flex;\\n  flex-direction: row;\\n  align-items: flex-start;\\n  justify-content: space-between;\\n\"])));\nvar HeaderText = styled(CText)(_templateObject8 || (_templateObject8 = _taggedTemplateLiteralLoose([\"\\n  margin: 8px 0px 0px 0px;\\n  overflow-wrap: anywhere;\\n  line-height: 18px;\\n  font-weight: 700;\\n\"])));\nvar BodyText = styled.div(_templateObject9 || (_templateObject9 = _taggedTemplateLiteralLoose([\"\\n  font-size: 14px;\\n  line-height: 20px;\\n  margin: 8px 0px 6px;\\n  font-weight: 400;\\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica,\\n    Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol';\\n  color: \", \";\\n\"])), lightColors.secondaryText);\nvar UnseenDot = styled.div(_templateObject10 || (_templateObject10 = _taggedTemplateLiteralLoose([\"\\n  background-color: \", \";\\n  border-radius: 50%;\\n  width: 7px;\\n  height: 7px;\\n  visibility: \", \";\\n\"])), lightColors.primary, function (props) {\n  return props.show ? 'visible' : 'hidden';\n});\nvar CreatedText = styled(HelperText)(_templateObject11 || (_templateObject11 = _taggedTemplateLiteralLoose([\"\"])));\nvar ButtonContainer = styled.div(_templateObject12 || (_templateObject12 = _taggedTemplateLiteralLoose([\"\\n  display: flex;\\n  flex-direction: row;\\n  gap: 10px;\\n  margin-bottom: 6px;\\n  margin-top: 12px;\\n  overflow-wrap: anywhere;\\n\"])));\nvar ButtonView = styled.div(_templateObject13 || (_templateObject13 = _taggedTemplateLiteralLoose([\"\\n  max-width: 50%;\\n  background: \", \";\\n  border-radius: 5px;\\n  text-decoration: none;\\n  padding: 4px 16px;\\n  &:hover {\\n    background-color: \", \" !important;\\n  }\\n\"])), lightColors.primary, function (props) {\n  var _props$style4;\n  return ((_props$style4 = props.style) === null || _props$style4 === void 0 ? void 0 : _props$style4.hoverBackgroundColor) || '#265cbf';\n});\nvar ButtonText = styled(CText)(_templateObject14 || (_templateObject14 = _taggedTemplateLiteralLoose([\"\\n  color: \", \";\\n  text-align: center;\\n  word-break: break-all;\\n  font-weight: 600;\\n  font-size: 13px;\\n\"])), lightColors.main);\nvar ButtonOutlineView = styled(ButtonView)(_templateObject15 || (_templateObject15 = _taggedTemplateLiteralLoose([\"\\n  background: \", \";\\n  border-color: \", \";\\n  border-style: solid;\\n  border-width: 1.2px;\\n  &:hover {\\n    background-color: \", \" !important;\\n  }\\n\"])), lightColors.main, lightColors.border, function (props) {\n  var _props$style5;\n  return ((_props$style5 = props.style) === null || _props$style5 === void 0 ? void 0 : _props$style5.hoverBackgroundColor) || '#f7f7f9';\n});\nvar ButtonOutlineText = styled(ButtonText)(_templateObject16 || (_templateObject16 = _taggedTemplateLiteralLoose([\"\\n  color: \", \";\\n\"])), lightColors.secondaryText);\nvar LeftView = styled.div(_templateObject17 || (_templateObject17 = _taggedTemplateLiteralLoose([\"\\n  display: flex;\\n  overflow-wrap: anywhere;\\n  flex-grow: 1;\\n\"])));\nvar LeftAvatarView = styled.div(_templateObject18 || (_templateObject18 = _taggedTemplateLiteralLoose([\"\\n  display: flex;\\n  margin-top: 8px;\\n  margin-right: 12px;\\n\"])));\nvar AvatarView = styled.div(_templateObject19 || (_templateObject19 = _taggedTemplateLiteralLoose([\"\"])));\nvar ContentView = styled.div(_templateObject20 || (_templateObject20 = _taggedTemplateLiteralLoose([\"\\n  flex: 1;\\n\"])));\nvar RightView = styled.div(_templateObject21 || (_templateObject21 = _taggedTemplateLiteralLoose([\"\\n  display: flex;\\n  flex-direction: column;\\n  align-items: center;\\n  margin-top: 5px;\\n  max-width: 40px;\\n  gap: 5px;\\n\"])));\nvar AvatarImage = styled.img(_templateObject22 || (_templateObject22 = _taggedTemplateLiteralLoose([\"\\n  height: 36px;\\n  width: 36px;\\n  border-radius: 100px;\\n\"])));\nvar CMenuPopup = styled.div(_templateObject23 || (_templateObject23 = _taggedTemplateLiteralLoose([\"\\n  position: absolute;\\n  right: 0px;\\n  display: \", \";\\n  min-width: 150px;\\n  padding: 2px;\\n  background-color: \", \";\\n  border: 1px solid;\\n  border-color: \", \";\\n  border-radius: 4px;\\n  box-shadow: 1px 1px 20px 1px rgba(0, 0, 0, 0.1);\\n  z-index: 100;\\n\"])), function (props) {\n  return props.moreOpen ? 'block' : 'none';\n}, lightColors.main, lightColors.border);\nvar CMenuItem = styled.div(_templateObject24 || (_templateObject24 = _taggedTemplateLiteralLoose([\"\\n  padding: 7px;\\n  border-radius: 4px;\\n  display: flex;\\n  align-items: center;\\n  gap: 8px;\\n  &:hover {\\n    background-color: \", \";\\n  }\\n\"])), function (props) {\n  var _props$style6;\n  return (props === null || props === void 0 ? void 0 : (_props$style6 = props.style) === null || _props$style6 === void 0 ? void 0 : _props$style6.hoverBackgroundColor) || 'rgba(100, 116, 139, 0.09)';\n});\nvar CMenuText = styled(CText)(_templateObject25 || (_templateObject25 = _taggedTemplateLiteralLoose([\"\"])));\nvar CMenuView = styled.div(_templateObject26 || (_templateObject26 = _taggedTemplateLiteralLoose([\"\\n  position: relative;\\n  visibility: \", \";\\n\"])), function (props) {\n  return props !== null && props !== void 0 && props.showMore ? 'visible' : 'hidden';\n});\nvar CMenuButton = styled.div(_templateObject27 || (_templateObject27 = _taggedTemplateLiteralLoose([\"\\n  height: 20px;\\n  width: 20px;\\n  &:hover {\\n    border-radius: 50%;\\n    background-color: \", \";\\n  }\\n\"])), function (props) {\n  return (props === null || props === void 0 ? void 0 : props.hoverBGColor) || 'rgba(100, 116, 139, 0.09)';\n});\n\nfunction getURLTarget(target) {\n  return target ? '_blank' : '_self';\n}\nfunction ClickableNotification(_ref) {\n  var notificationData = _ref.notificationData;\n  var _useInbox = useInbox(),\n    notificationClickHandler = _useInbox.notificationClickHandler,\n    inbox = _useInbox.inbox;\n  var cardClickNavigation = function cardClickNavigation() {\n    if (typeof notificationClickHandler === 'function') {\n      notificationClickHandler(notificationData);\n    } else {\n      var message = notificationData === null || notificationData === void 0 ? void 0 : notificationData.message;\n      if (message !== null && message !== void 0 && message.url) {\n        var actionUrlTarget = getURLTarget(message === null || message === void 0 ? void 0 : message.open_in_new_tab);\n        window.open(formatActionLink(message.url), actionUrlTarget);\n      }\n    }\n  };\n  var markNotificationClicked = function markNotificationClicked() {\n    inbox.feed.markClicked(notificationData.n_id);\n  };\n  var handleCardClick = function handleCardClick(e) {\n    var _notificationData$mes;\n    e.stopPropagation();\n    var clicked = notificationData.interacted_on;\n    var actionUrlTarget = getURLTarget(notificationData === null || notificationData === void 0 ? void 0 : (_notificationData$mes = notificationData.message) === null || _notificationData$mes === void 0 ? void 0 : _notificationData$mes.open_in_new_tab);\n    markNotificationClicked();\n    if (!clicked && actionUrlTarget === '_self') {\n      setTimeout(function () {\n        cardClickNavigation();\n      }, 1000);\n    } else {\n      cardClickNavigation();\n    }\n  };\n  var handleActionClick = function handleActionClick(e, clickData) {\n    e.stopPropagation();\n    var clicked = notificationData.interacted_on;\n    var actionUrlTarget = getURLTarget(clickData === null || clickData === void 0 ? void 0 : clickData.target);\n    markNotificationClicked();\n    if (!clicked && actionUrlTarget === '_self') {\n      setTimeout(function () {\n        if (clickData !== null && clickData !== void 0 && clickData.url) {\n          window.open(formatActionLink(clickData.url), actionUrlTarget);\n        } else {\n          cardClickNavigation();\n        }\n      }, 1000);\n    } else {\n      if (clickData !== null && clickData !== void 0 && clickData.url) {\n        window.open(formatActionLink(clickData.url), actionUrlTarget);\n      } else {\n        cardClickNavigation();\n      }\n    }\n  };\n  return /*#__PURE__*/React__default.createElement(\"div\", {\n    onClick: handleCardClick\n  }, /*#__PURE__*/React__default.createElement(Notification, {\n    notificationData: notificationData,\n    handleActionClick: handleActionClick\n  }));\n}\n\nvar EmptyNotificationIcon = function EmptyNotificationIcon(props) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 185,\n    height: 114,\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\"\n  }, props), /*#__PURE__*/React.createElement(\"ellipse\", {\n    cx: 92.32,\n    cy: 56.616,\n    rx: 60.32,\n    ry: 56.616,\n    fill: \"#9F9F9F\",\n    fillOpacity: 0.11\n  }), /*#__PURE__*/React.createElement(\"rect\", {\n    x: 69.174,\n    y: 17.469,\n    width: 115.826,\n    height: 40.217,\n    rx: 12.87,\n    fill: \"#9F9F9F\"\n  }), /*#__PURE__*/React.createElement(\"rect\", {\n    x: 123.065,\n    y: 29.533,\n    width: 33.783,\n    height: 5.63,\n    rx: 2.815,\n    fill: \"#D9D9D9\"\n  }), /*#__PURE__*/React.createElement(\"rect\", {\n    x: 95.717,\n    y: 39.185,\n    width: 59.522,\n    height: 5.63,\n    rx: 2.815,\n    fill: \"#D9D9D9\"\n  }), /*#__PURE__*/React.createElement(\"ellipse\", {\n    cx: 170.924,\n    cy: 37.577,\n    rx: 8.446,\n    ry: 8.043,\n    fill: \"#D9D9D9\"\n  }), /*#__PURE__*/React.createElement(\"rect\", {\n    y: 51.25,\n    width: 120.652,\n    height: 40.217,\n    rx: 12.87,\n    fill: \"#D9E9FF\"\n  }), /*#__PURE__*/React.createElement(\"rect\", {\n    x: 30.565,\n    y: 63.315,\n    width: 33.783,\n    height: 5.63,\n    rx: 2.815,\n    fill: \"#93AFD6\"\n  }), /*#__PURE__*/React.createElement(\"rect\", {\n    x: 30.565,\n    y: 72.967,\n    width: 59.522,\n    height: 5.63,\n    rx: 2.815,\n    fill: \"#93AFD6\"\n  }), /*#__PURE__*/React.createElement(\"ellipse\", {\n    cx: 17.294,\n    cy: 71.358,\n    rx: 8.446,\n    ry: 8.043,\n    fill: \"#93AFD6\"\n  }));\n};\n\nvar _templateObject$3, _templateObject2$2, _templateObject3$2, _templateObject4$1, _templateObject5$1, _templateObject6$1, _templateObject7$1, _templateObject8$1;\nfunction Loader(_ref) {\n  var style = _ref.style,\n    size = _ref.size;\n  var color = style === null || style === void 0 ? void 0 : style.color;\n  return /*#__PURE__*/React__default.createElement(SpinnerContainer, null, /*#__PURE__*/React__default.createElement(Spinner, {\n    style: style,\n    color: color,\n    size: size\n  }));\n}\nfunction NotificationsList() {\n  var _storeData$activeStor;\n  var _useInbox = useInbox(),\n    _useInbox$notificatio = _useInbox.notificationsData,\n    storeData = _useInbox$notificatio.storeData,\n    hasNext = _useInbox$notificatio.hasNext,\n    initialLoading = _useInbox$notificatio.initialLoading,\n    activeStoreId = _useInbox$notificatio.activeStoreId,\n    noNotificationsComponent = _useInbox.noNotificationsComponent,\n    loaderComponent = _useInbox.loaderComponent,\n    pagination = _useInbox.pagination,\n    changingActiveStore = _useInbox.changingActiveStore,\n    inbox = _useInbox.inbox;\n  var _useTheme = useTheme(),\n    notificationsContainer = _useTheme.notificationsContainer;\n  var notifications = (storeData === null || storeData === void 0 ? void 0 : (_storeData$activeStor = storeData[activeStoreId]) === null || _storeData$activeStor === void 0 ? void 0 : _storeData$activeStor.notifications) || [];\n  if (initialLoading) {\n    return /*#__PURE__*/React__default.createElement(InitialLoader, null, /*#__PURE__*/React__default.createElement(Loader, {\n      style: notificationsContainer === null || notificationsContainer === void 0 ? void 0 : notificationsContainer.loader,\n      size: \"large\"\n    }));\n  }\n  if (notifications.length <= 0) {\n    if (noNotificationsComponent) {\n      var NoNotificationsComponent = noNotificationsComponent;\n      return /*#__PURE__*/React__default.createElement(NoNotificationsComponent, null);\n    }\n    return /*#__PURE__*/React__default.createElement(EmptyNotificationsContainer, null, /*#__PURE__*/React__default.createElement(EmptyNotificationIcon, null), /*#__PURE__*/React__default.createElement(EmptyText, {\n      style: notificationsContainer === null || notificationsContainer === void 0 ? void 0 : notificationsContainer.noNotificationsText\n    }, \"No notifications yet\"), /*#__PURE__*/React__default.createElement(EmptySubText, {\n      style: notificationsContainer === null || notificationsContainer === void 0 ? void 0 : notificationsContainer.noNotificationsSubtext\n    }, \"We'll let you know when we've got something new for you.\"));\n  }\n  if (changingActiveStore) {\n    return null;\n  }\n  return /*#__PURE__*/React__default.createElement(ScrollDiv, null, /*#__PURE__*/React__default.createElement(InfiniteScroll, {\n    scrollableTarget: \"ss-notification-container\",\n    dataLength: notifications.length,\n    next: function next() {\n      inbox.feed.fetchNotifications();\n    },\n    hasMore: pagination && hasNext,\n    loader: (loaderComponent === null || loaderComponent === void 0 ? void 0 : loaderComponent()) || /*#__PURE__*/React__default.createElement(Loader, {\n      style: notificationsContainer === null || notificationsContainer === void 0 ? void 0 : notificationsContainer.loader\n    })\n  }, notifications.map(function (notification) {\n    return /*#__PURE__*/React__default.createElement(ClickableNotification, {\n      notificationData: notification,\n      key: notification.n_id\n    });\n  })));\n}\nvar ScrollDiv = styled.div(_templateObject$3 || (_templateObject$3 = _taggedTemplateLiteralLoose([\"\"])));\nvar EmptyNotificationsContainer = styled.div(_templateObject2$2 || (_templateObject2$2 = _taggedTemplateLiteralLoose([\"\\n  display: flex;\\n  justify-content: center;\\n  align-items: center;\\n  flex-direction: column;\\n  margin: 32px;\\n  margin-top: 40px;\\n\"])));\nvar EmptyText = styled(HeadingText)(_templateObject3$2 || (_templateObject3$2 = _taggedTemplateLiteralLoose([\"\\n  font-weight: 600;\\n  text-align: center;\\n  background-color: transparent;\\n  margin: 20px 0px;\\n  margin-bottom: 16px;\\n  color: \", \";\\n\"])), lightColors.primaryText);\nvar EmptySubText = styled(CText)(_templateObject4$1 || (_templateObject4$1 = _taggedTemplateLiteralLoose([\"\\n  color: \", \";\\n  text-align: center;\\n\"])), lightColors.secondaryText);\nvar spin = react.keyframes(_templateObject5$1 || (_templateObject5$1 = _taggedTemplateLiteralLoose([\"\\n0% {\\n  transform: rotate(0deg);\\n}\\n100% {\\n  transform: rotate(360deg);\\n}\\n\"])));\nvar Spinner = styled.div(_templateObject6$1 || (_templateObject6$1 = _taggedTemplateLiteralLoose([\"\\n  border: \", \";\\n  border-top: \", \";\\n  border-top-color: \", \";\\n  border-radius: 50%;\\n  width: \", \";\\n  height: \", \";\\n  animation: \", \" 1s linear infinite;\\n  margin: 5px;\\n\"])), function (props) {\n  return props.size === 'large' ? \"5px solid \" + lightColors.border : \"3px solid \" + lightColors.border;\n}, function (props) {\n  return props.size === 'large' ? '5px solid' : '3px solid';\n}, function (props) {\n  return props.color ? props.color : lightColors.primary;\n}, function (props) {\n  return props.size === 'large' ? '20px' : '10px';\n}, function (props) {\n  return props.size === 'large' ? '20px' : '10px';\n}, spin);\nvar SpinnerContainer = styled.div(_templateObject7$1 || (_templateObject7$1 = _taggedTemplateLiteralLoose([\"\\n  display: flex;\\n  justify-content: center;\\n  align-items: center;\\n\"])));\nvar InitialLoader = styled.div(_templateObject8$1 || (_templateObject8$1 = _taggedTemplateLiteralLoose([\"\\n  margin-top: 32px;\\n\"])));\n\nvar _templateObject$4, _templateObject2$3, _templateObject3$3, _templateObject4$2, _templateObject5$2, _templateObject6$2, _templateObject7$2, _templateObject8$2, _templateObject9$1;\nfunction hasNotifications(storeData) {\n  var hasData = false;\n  for (var storeId in storeData) {\n    var _store$notifications;\n    var store = storeData[storeId];\n    if ((store === null || store === void 0 ? void 0 : (_store$notifications = store.notifications) === null || _store$notifications === void 0 ? void 0 : _store$notifications.length) > 0) {\n      hasData = true;\n    }\n  }\n  return hasData;\n}\nfunction Header() {\n  var _useTheme = useTheme(),\n    header = _useTheme.header,\n    tabs = _useTheme.tabs;\n  var _useInbox = useInbox(),\n    inbox = _useInbox.inbox,\n    notificationsData = _useInbox.notificationsData,\n    activeStore = _useInbox.activeStore,\n    setActiveStore = _useInbox.setActiveStore,\n    setChangingActiveStore = _useInbox.setChangingActiveStore,\n    showUnreadCountOnTabs = _useInbox.showUnreadCountOnTabs,\n    tabBadgeComponent = _useInbox.tabBadgeComponent;\n  var isEmpty = !hasNotifications(notificationsData === null || notificationsData === void 0 ? void 0 : notificationsData.storeData);\n  var stores = inbox.feed.stores;\n  var hasStores = (stores === null || stores === void 0 ? void 0 : stores.length) > 0;\n  var TabBadgeComponent = tabBadgeComponent;\n  return /*#__PURE__*/React__default.createElement(Container$1, {\n    style: header === null || header === void 0 ? void 0 : header.container\n  }, /*#__PURE__*/React__default.createElement(TopContainer, {\n    hasStores: hasStores\n  }, /*#__PURE__*/React__default.createElement(HeaderText$1, {\n    style: header === null || header === void 0 ? void 0 : header.headerText\n  }, \"Notifications\"), !isEmpty && /*#__PURE__*/React__default.createElement(AllReadButton, {\n    style: header === null || header === void 0 ? void 0 : header.markAllReadText,\n    onClick: function onClick(e) {\n      e.stopPropagation();\n      inbox.feed.markAllRead();\n    }\n  }, \"Mark all as read\")), stores && stores.length > 0 && /*#__PURE__*/React__default.createElement(TabsContainer, null, stores.map(function (store, index) {\n    var _notificationsData$st, _notificationsData$st2;\n    var isActiveTab = activeStore === store.storeId;\n    var tabUnseenCount = (notificationsData === null || notificationsData === void 0 ? void 0 : (_notificationsData$st = notificationsData.storeData) === null || _notificationsData$st === void 0 ? void 0 : (_notificationsData$st2 = _notificationsData$st[store.storeId]) === null || _notificationsData$st2 === void 0 ? void 0 : _notificationsData$st2.unseenCount) || 0;\n    var showBadge = showUnreadCountOnTabs && tabUnseenCount > 0;\n    var selectedTabBottomColor = isActiveTab ? tabs === null || tabs === void 0 ? void 0 : tabs.bottomColor : 'none';\n    var textColor = isActiveTab ? tabs === null || tabs === void 0 ? void 0 : tabs.color : (tabs === null || tabs === void 0 ? void 0 : tabs.unselectedColor) || (tabs === null || tabs === void 0 ? void 0 : tabs.color);\n    return /*#__PURE__*/React__default.createElement(TabContainer, {\n      style: {\n        borderBottomColor: selectedTabBottomColor\n      },\n      key: index,\n      selected: isActiveTab,\n      onClick: function onClick() {\n        setChangingActiveStore(true);\n        setActiveStore(store.storeId);\n        inbox.changeActiveStore(store.storeId);\n        setTimeout(function () {\n          setChangingActiveStore(false);\n        }, 0);\n      }\n    }, /*#__PURE__*/React__default.createElement(TabText, {\n      selected: isActiveTab,\n      style: _extends({}, tabs, {\n        color: textColor\n      })\n    }, store.label), showBadge && (TabBadgeComponent ? /*#__PURE__*/React__default.createElement(TabBadgeComponent, {\n      count: tabUnseenCount\n    }) : /*#__PURE__*/React__default.createElement(TabBadge, {\n      style: {\n        backgroundColor: tabs === null || tabs === void 0 ? void 0 : tabs.badgeColor,\n        color: tabs === null || tabs === void 0 ? void 0 : tabs.badgeText\n      }\n    }, /*#__PURE__*/React__default.createElement(TabBadgeText, {\n      count: tabUnseenCount\n    }, tabUnseenCount))));\n  })));\n}\nvar Container$1 = styled.div(_templateObject$4 || (_templateObject$4 = _taggedTemplateLiteralLoose([\"\\n  position: sticky;\\n  top: 0;\\n  padding: 16px;\\n  padding-bottom: 0px;\\n  z-index: 1000;\\n  background-color: \", \";\\n  box-shadow: 0 0 3px 0 rgba(0, 0, 0, 0.1);\\n\"])), lightColors.main);\nvar TopContainer = styled.div(_templateObject2$3 || (_templateObject2$3 = _taggedTemplateLiteralLoose([\"\\n  display: flex;\\n  justify-content: space-between;\\n  align-items: center;\\n  margin-bottom: \", \";\\n  padding-bottom: \", \";\\n\"])), function (props) {\n  return props.hasStores ? '16px' : '0px';\n}, function (props) {\n  return props.hasStores ? '0px' : '16px';\n});\nvar TabsContainer = styled.div(_templateObject3$3 || (_templateObject3$3 = _taggedTemplateLiteralLoose([\"\\n  display: flex;\\n  overflow-x: scroll;\\n  -ms-overflow-style: none;\\n  scrollbar-width: none;\\n  &::-webkit-scrollbar {\\n    display: none;\\n  }\\n\"])));\nvar TabContainer = styled.div(_templateObject4$2 || (_templateObject4$2 = _taggedTemplateLiteralLoose([\"\\n  padding: 5px 15px 3px 15px;\\n  border-bottom: \", \";\\n  cursor: pointer;\\n  display: flex;\\n  align-items: center;\\n  gap: 5px;\\n\"])), function (props) {\n  return props.selected ? \"2px solid \" + lightColors.primary : 'none';\n});\nvar TabText = styled(CText)(_templateObject5$2 || (_templateObject5$2 = _taggedTemplateLiteralLoose([\"\\n  font-size: 14px;\\n  font-weight: 600;\\n  color: \", \";\\n\"])), function (props) {\n  return props.selected ? lightColors.primaryText : lightColors.secondaryText + 'D9';\n});\nvar HeaderText$1 = styled(HeadingText)(_templateObject6$2 || (_templateObject6$2 = _taggedTemplateLiteralLoose([\"\\n  font-weight: 600;\\n  font-size: 16px;\\n\"])));\nvar AllReadButton = styled(HeadingText)(_templateObject7$2 || (_templateObject7$2 = _taggedTemplateLiteralLoose([\"\\n  color: \", \";\\n  font-size: 12px;\\n  cursor: pointer;\\n\"])), lightColors.primary);\nvar TabBadge = styled.div(_templateObject8$2 || (_templateObject8$2 = _taggedTemplateLiteralLoose([\"\\n  height: 18px;\\n  width: 20px;\\n  border-radius: 50%;\\n  background-color: rgba(100, 116, 139, 0.09);\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  color: \", \";\\n\"])), lightColors.primaryText);\nvar TabBadgeText = styled.p(_templateObject9$1 || (_templateObject9$1 = _taggedTemplateLiteralLoose([\"\\n  margin: 0px;\\n  padding: 0px;\\n  font-size: \", \";\\n  font-weight: 600;\\n  line-height: 1;\\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica,\\n    Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol';\\n\"])), function (props) {\n  return (props === null || props === void 0 ? void 0 : props.count) > 99 ? '8px' : '10px';\n});\n\nvar _templateObject$5;\nfunction NotificationsContainer() {\n  var _useTheme = useTheme(),\n    notificationsContainer = _useTheme.notificationsContainer;\n  return /*#__PURE__*/React__default.createElement(Container$2, {\n    style: notificationsContainer === null || notificationsContainer === void 0 ? void 0 : notificationsContainer.container,\n    id: \"ss-notification-container\"\n  }, /*#__PURE__*/React__default.createElement(Header, null), /*#__PURE__*/React__default.createElement(NotificationsList, null));\n}\nvar Container$2 = styled.div(_templateObject$5 || (_templateObject$5 = _taggedTemplateLiteralLoose([\"\\n  height: 500px;\\n  width: 450px;\\n  margin: 0px 15px;\\n  border-radius: 5px;\\n  background-color: \", \";\\n  border: 1px solid \", \";\\n  display: inline-block;\\n  overflow: scroll;\\n  box-shadow: 0 0px 7px 0 rgba(0, 0, 0, 0.1);\\n  @media (max-width: 425px) {\\n    width: 99.5vw;\\n    margin: 0px;\\n    border-radius: 0px;\\n  }\\n\"])), lightColors.main, lightColors.border);\n\nvar useClickOutside = function useClickOutside(ref, handler) {\n  React.useEffect(function () {\n    var startedInside = false;\n    var startedWhenMounted = false;\n    var listener = function listener(event) {\n      if (startedInside || !startedWhenMounted) return;\n      if (!ref.current || ref.current.contains(event.target)) return;\n      handler(event);\n    };\n    var validateEventStart = function validateEventStart(event) {\n      startedWhenMounted = ref.current;\n      startedInside = ref.current && ref.current.contains(event.target);\n    };\n    document.addEventListener('mousedown', validateEventStart);\n    document.addEventListener('touchstart', validateEventStart);\n    document.addEventListener('click', listener);\n    return function () {\n      document.removeEventListener('mousedown', validateEventStart);\n      document.removeEventListener('touchstart', validateEventStart);\n      document.removeEventListener('click', listener);\n    };\n  }, [ref, handler]);\n};\n\nvar _templateObject$6, _templateObject2$4;\nfunction Inbox(_ref) {\n  var openInbox = _ref.openInbox,\n    toggleInbox = _ref.toggleInbox,\n    popperPosition = _ref.popperPosition;\n  var _useState = React.useState(null),\n    referenceElement = _useState[0],\n    setReferenceElement = _useState[1];\n  var _useState2 = React.useState(null),\n    popperElement = _useState2[0],\n    setPopperElement = _useState2[1];\n  var _useInbox = useInbox(),\n    setNotificationsData = _useInbox.setNotificationsData;\n  useClickOutside({\n    current: popperElement\n  }, function () {\n    toggleInbox(function (prev) {\n      return !prev;\n    });\n  });\n  var _usePopper = reactPopper.usePopper(referenceElement, popperElement, {\n      placement: popperPosition,\n      modifiers: [{\n        name: 'offset',\n        options: {\n          offset: [0, 5]\n        }\n      }]\n    }),\n    styles = _usePopper.styles,\n    attributes = _usePopper.attributes;\n  var handleBellClick = function handleBellClick() {\n    setNotificationsData(function (prev) {\n      return _extends({}, prev, {\n        count: 0\n      });\n    });\n    toggleInbox(function (prev) {\n      return !prev;\n    });\n  };\n  return /*#__PURE__*/React__default.createElement(Container$3, null, /*#__PURE__*/React__default.createElement(BellContainer, {\n    onClick: handleBellClick,\n    ref: setReferenceElement\n  }, /*#__PURE__*/React__default.createElement(Badge, null), /*#__PURE__*/React__default.createElement(Bell, null)), openInbox && /*#__PURE__*/React__default.createElement(\"div\", _extends({\n    ref: setPopperElement,\n    style: _extends({}, styles.popper, {\n      zIndex: 999\n    })\n  }, attributes.popper), /*#__PURE__*/React__default.createElement(NotificationsContainer, null)));\n}\nvar Container$3 = styled.div(_templateObject$6 || (_templateObject$6 = _taggedTemplateLiteralLoose([\"\\n  position: relative;\\n  display: inline-block;\\n  background-color: transparent;\\n  line-height: 1;\\n\"])));\nvar BellContainer = styled.div(_templateObject2$4 || (_templateObject2$4 = _taggedTemplateLiteralLoose([\"\\n  position: relative;\\n  margin-top: 12px;\\n  margin-right: 12px;\\n  cursor: pointer;\\n\"])));\n\nvar _templateObject$7, _templateObject2$5, _templateObject3$4, _templateObject4$3, _templateObject5$3;\nfunction ToastNotification(_ref) {\n  var _toast$bodyText, _toast$bodyText2, _message$avatar2, _message$text, _message$text$replace, _message$text$replace2;\n  var notificationData = _ref.notificationData,\n    closeToast = _ref.closeToast;\n  var _useTheme = useTheme(),\n    toast = _useTheme.toast;\n  var _useInbox = useInbox(),\n    toggleInbox = _useInbox.toggleInbox,\n    themeType = _useInbox.themeType;\n  var message = notificationData.message;\n  var _useState = React.useState(false),\n    validAvatar = _useState[0],\n    setValidAvatar = _useState[1];\n  React.useEffect(function () {\n    var _message$avatar;\n    var isValidAvatar = isImgUrl(message === null || message === void 0 ? void 0 : (_message$avatar = message.avatar) === null || _message$avatar === void 0 ? void 0 : _message$avatar.avatar_url);\n    isValidAvatar.then(function (res) {\n      return setValidAvatar(res);\n    });\n  }, [notificationData]);\n  var blockquoteColor = (toast === null || toast === void 0 ? void 0 : (_toast$bodyText = toast.bodyText) === null || _toast$bodyText === void 0 ? void 0 : _toast$bodyText.blockquoteColor) || lightColors.border;\n  var linkColor = (toast === null || toast === void 0 ? void 0 : (_toast$bodyText2 = toast.bodyText) === null || _toast$bodyText2 === void 0 ? void 0 : _toast$bodyText2.linkColor) || lightColors.primary;\n  return /*#__PURE__*/React__default.createElement(Container$4, {\n    style: toast === null || toast === void 0 ? void 0 : toast.container,\n    onClick: function onClick(e) {\n      toggleInbox(true);\n      closeToast();\n    }\n  }, /*#__PURE__*/React__default.createElement(AvatarView$1, null, message !== null && message !== void 0 && (_message$avatar2 = message.avatar) !== null && _message$avatar2 !== void 0 && _message$avatar2.avatar_url && validAvatar ? /*#__PURE__*/React__default.createElement(AvatarImage$1, {\n    src: message.avatar.avatar_url,\n    alt: \"avatar\"\n  }) : /*#__PURE__*/React__default.createElement(AvatarIcon, {\n    type: themeType\n  })), /*#__PURE__*/React__default.createElement(\"div\", null, /*#__PURE__*/React__default.createElement(HeaderText$2, {\n    style: toast === null || toast === void 0 ? void 0 : toast.headerText\n  }, message.header), /*#__PURE__*/React__default.createElement(BodyText$1, {\n    style: toast === null || toast === void 0 ? void 0 : toast.bodyText\n  }, /*#__PURE__*/React__default.createElement(Markdown, {\n    components: {\n      a: function a(_ref2) {\n        var children = _ref2.children,\n          href = _ref2.href;\n        return /*#__PURE__*/React__default.createElement(\"a\", {\n          href: href,\n          style: {\n            color: linkColor,\n            textDecoration: 'none'\n          }\n        }, children);\n      },\n      p: function p(_ref3) {\n        var children = _ref3.children;\n        return /*#__PURE__*/React__default.createElement(\"p\", {\n          style: {\n            margin: 0,\n            overflowWrap: 'anywhere'\n          }\n        }, children);\n      },\n      blockquote: function blockquote(_ref4) {\n        var children = _ref4.children;\n        return /*#__PURE__*/React__default.createElement(\"blockquote\", {\n          style: {\n            margin: 0,\n            paddingLeft: 10,\n            borderLeft: \"3px \" + blockquoteColor + \" solid\",\n            marginBottom: 5,\n            marginTop: 5\n          }\n        }, children);\n      },\n      ul: function ul(_ref5) {\n        var children = _ref5.children;\n        return /*#__PURE__*/React__default.createElement(\"ul\", {\n          style: {\n            whiteSpace: 'normal',\n            margin: 0,\n            paddingLeft: 10\n          }\n        }, children);\n      },\n      ol: function ol(_ref6) {\n        var children = _ref6.children;\n        return /*#__PURE__*/React__default.createElement(\"ol\", {\n          style: {\n            whiteSpace: 'normal',\n            margin: 0,\n            paddingLeft: 10\n          }\n        }, children);\n      },\n      img: function img(props) {\n        return /*#__PURE__*/React__default.createElement(\"img\", _extends({\n          style: {\n            maxWidth: '100%',\n            objectFit: 'contain'\n          }\n        }, props));\n      }\n    }\n  }, message === null || message === void 0 ? void 0 : (_message$text = message.text) === null || _message$text === void 0 ? void 0 : (_message$text$replace = _message$text.replaceAll('\\\\\\n', '&nbsp;')) === null || _message$text$replace === void 0 ? void 0 : (_message$text$replace2 = _message$text$replace.replaceAll('\\n', '  \\n')) === null || _message$text$replace2 === void 0 ? void 0 : _message$text$replace2.replaceAll('&nbsp;', '&nbsp;  \\n')))));\n}\nvar Container$4 = styled.div(_templateObject$7 || (_templateObject$7 = _taggedTemplateLiteralLoose([\"\\n  background-color: \", \";\\n  cursor: pointer;\\n  padding: 14px;\\n  display: flex;\\n  overflow-wrap: anywhere;\\n\"])), lightColors.main);\nvar HeaderText$2 = styled(CText)(_templateObject2$5 || (_templateObject2$5 = _taggedTemplateLiteralLoose([\"\\n  font-size: 13px;\\n  line-height: 16px;\\n  font-weight: 700;\\n  margin: 10px 0px;\\n\"])));\nvar BodyText$1 = styled.div(_templateObject3$4 || (_templateObject3$4 = _taggedTemplateLiteralLoose([\"\\n  font-size: 12px;\\n  line-height: 18px;\\n  font-weight: 400;\\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica,\\n    Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol';\\n  color: \", \";\\n  margin: 10px 0px;\\n  color: \", \";\\n\"])), lightColors.primaryText, lightColors.primaryText);\nvar AvatarImage$1 = styled.img(_templateObject4$3 || (_templateObject4$3 = _taggedTemplateLiteralLoose([\"\\n  height: 36px;\\n  width: 36px;\\n  border-radius: 100px;\\n\"])));\nvar AvatarView$1 = styled.div(_templateObject5$3 || (_templateObject5$3 = _taggedTemplateLiteralLoose([\"\\n  margin-top: 8px;\\n  margin-right: 12px;\\n\"])));\n\nvar _templateObject$8;\nfunction Toast(_ref) {\n  var position = _ref.position,\n    duration = _ref.duration,\n    limit = _ref.limit;\n  var toastDuration = duration || 3000;\n  var toastsLimit = limit || 3;\n  var toastPosition = !position ? window.innerWidth > 425 ? 'bottom-right' : 'bottom-center' : position;\n  return /*#__PURE__*/React__default.createElement(StyledContainer, {\n    autoClose: toastDuration,\n    position: toastPosition,\n    limit: toastsLimit,\n    hideProgressBar: true,\n    pauseOnHover: false,\n    closeButton: false,\n    pauseOnFocusLoss: false\n  });\n}\nfunction notify(_ref2) {\n  var notificationsData = _ref2.notificationsData,\n    toastProps = _ref2.toastProps;\n  var ToastNotificationComponent = (toastProps === null || toastProps === void 0 ? void 0 : toastProps.toastComponent) || ToastNotification;\n  if (document.hidden) return;\n  var toastId = reactToastify.toast( /*#__PURE__*/React__default.createElement(ToastNotificationComponent, {\n    notificationData: notificationsData,\n    closeToast: function closeToast() {\n      reactToastify.toast.dismiss({\n        id: toastId\n      });\n    }\n  }));\n}\nvar StyledContainer = styled(reactToastify.ToastContainer)(_templateObject$8 || (_templateObject$8 = _taggedTemplateLiteralLoose([\"\\n  &.Toastify__toast-container {\\n    max-width: 450px;\\n    min-width: 300px;\\n    padding: 0px;\\n    width: unset;\\n  }\\n\\n  .Toastify__toast-theme--light,\\n  .Toastify__toast-theme--default,\\n  .Toastify__toast-theme--dark {\\n    padding: 0px;\\n    border-radius: 5px;\\n    background-color: transparent;\\n  }\\n\\n  .Toastify__toast-body {\\n    padding: 0px;\\n  }\\n\"])));\n\nvar initialNotificationData = {\n  storeData: {},\n  unseenCount: 0,\n  hasNext: false,\n  initialLoading: false,\n  fetchMoreLoading: false\n};\nvar InboxContext$1 = React.createContext({\n  notificationsData: initialNotificationData\n});\nfunction SuprSendProvider(_ref) {\n  var children = _ref.children,\n    workspaceKey = _ref.workspaceKey,\n    distinctId = _ref.distinctId,\n    subscriberId = _ref.subscriberId,\n    inboxId = _ref.inboxId,\n    tenantId = _ref.tenantId,\n    stores = _ref.stores,\n    pageSize = _ref.pageSize;\n  if (inboxId) {\n    subscriberId = inboxId;\n  }\n  var _useState = React.useState(),\n    inbox = _useState[0],\n    setInbox = _useState[1];\n  var _useState2 = React.useState(_extends({}, initialNotificationData)),\n    notificationsData = _useState2[0],\n    setNotificationsData = _useState2[1];\n  React.useEffect(function () {\n    var inboxInst = new SuprsendJSInbox(workspaceKey, {\n      pageSize: pageSize,\n      tenantID: tenantId,\n      stores: stores\n    });\n    setInbox(inboxInst);\n    inboxInst.emitter.on('sync_notif_store', function () {\n      var inboxData = inboxInst.feed.data;\n      setNotificationsData({\n        storeData: (inboxData === null || inboxData === void 0 ? void 0 : inboxData.stores) || {},\n        count: (inboxData === null || inboxData === void 0 ? void 0 : inboxData.unseenCount) || 0,\n        hasNext: inboxData === null || inboxData === void 0 ? void 0 : inboxData.hasNext,\n        initialLoading: inboxData === null || inboxData === void 0 ? void 0 : inboxData.initialLoading,\n        fetchMoreLoading: inboxData === null || inboxData === void 0 ? void 0 : inboxData.fetchMoreLoading,\n        activeStoreId: inboxData === null || inboxData === void 0 ? void 0 : inboxData.activeStoreId\n      });\n    });\n    return function () {\n      inboxInst.emitter.all.clear();\n    };\n  }, []);\n  React.useEffect(function () {\n    if (!subscriberId || !inbox) return;\n    inbox.identifyUser(distinctId, subscriberId);\n    inbox.feed.fetchNotifications();\n    return function () {\n      inbox.resetUser();\n    };\n  }, [subscriberId, inbox]);\n  return /*#__PURE__*/React__default.createElement(InboxContext$1.Provider, {\n    value: {\n      inbox: inbox,\n      notificationsData: notificationsData,\n      subscriberId: subscriberId\n    }\n  }, children);\n}\n\nfunction useNotifications(storeId) {\n  var _inboxData$inbox, _notificationsFeed$st, _notificationsFeed$st2, _inboxData$notificati, _inboxData$notificati2;\n  var inboxData = React.useContext(InboxContext$1);\n  var notificationsFeed = (_inboxData$inbox = inboxData.inbox) === null || _inboxData$inbox === void 0 ? void 0 : _inboxData$inbox.feed;\n  React.useEffect(function () {\n    if (inboxData !== null && inboxData !== void 0 && inboxData.inbox && storeId) {\n      inboxData.inbox.changeActiveStore(storeId);\n    }\n  }, [storeId, inboxData === null || inboxData === void 0 ? void 0 : inboxData.inbox, inboxData === null || inboxData === void 0 ? void 0 : inboxData.subscriberId]);\n  var firstStore = (notificationsFeed === null || notificationsFeed === void 0 ? void 0 : (_notificationsFeed$st = notificationsFeed.stores) === null || _notificationsFeed$st === void 0 ? void 0 : (_notificationsFeed$st2 = _notificationsFeed$st[0]) === null || _notificationsFeed$st2 === void 0 ? void 0 : _notificationsFeed$st2.storeId) || 'default_store';\n  var activeStoreId = storeId || firstStore;\n  var activeStoreData = inboxData === null || inboxData === void 0 ? void 0 : (_inboxData$notificati = inboxData.notificationsData) === null || _inboxData$notificati === void 0 ? void 0 : (_inboxData$notificati2 = _inboxData$notificati.storeData) === null || _inboxData$notificati2 === void 0 ? void 0 : _inboxData$notificati2[activeStoreId];\n  return {\n    notifications: (activeStoreData === null || activeStoreData === void 0 ? void 0 : activeStoreData.notifications) || [],\n    initialLoading: inboxData.notificationsData.initialLoading,\n    hasNext: inboxData.notificationsData.hasNext,\n    fetchMoreLoading: inboxData.notificationsData.fetchMoreLoading,\n    markClicked: notificationsFeed === null || notificationsFeed === void 0 ? void 0 : notificationsFeed.markClicked.bind(notificationsFeed),\n    markRead: notificationsFeed === null || notificationsFeed === void 0 ? void 0 : notificationsFeed.markRead.bind(notificationsFeed),\n    markUnRead: notificationsFeed === null || notificationsFeed === void 0 ? void 0 : notificationsFeed.markUnRead.bind(notificationsFeed),\n    markArchived: notificationsFeed === null || notificationsFeed === void 0 ? void 0 : notificationsFeed.markArchived.bind(notificationsFeed),\n    markAllSeen: notificationsFeed === null || notificationsFeed === void 0 ? void 0 : notificationsFeed.markAllSeen.bind(notificationsFeed),\n    markAllRead: notificationsFeed === null || notificationsFeed === void 0 ? void 0 : notificationsFeed.markAllRead.bind(notificationsFeed),\n    fetchPrevious: notificationsFeed === null || notificationsFeed === void 0 ? void 0 : notificationsFeed.fetchNotifications.bind(notificationsFeed)\n  };\n}\n\nfunction useBell() {\n  var _inboxData$inbox, _inboxData$inbox$feed, _inboxData$inbox2;\n  var inboxData = React.useContext(InboxContext$1);\n  return {\n    unSeenCount: inboxData.notificationsData.count,\n    markAllSeen: (_inboxData$inbox = inboxData.inbox) === null || _inboxData$inbox === void 0 ? void 0 : (_inboxData$inbox$feed = _inboxData$inbox.feed.markAllSeen) === null || _inboxData$inbox$feed === void 0 ? void 0 : _inboxData$inbox$feed.bind((_inboxData$inbox2 = inboxData.inbox) === null || _inboxData$inbox2 === void 0 ? void 0 : _inboxData$inbox2.feed)\n  };\n}\nfunction useUnseenCount() {\n  var _inboxData$inbox3, _inboxData$inbox3$fee, _inboxData$inbox4;\n  var inboxData = React.useContext(InboxContext$1);\n  return {\n    unSeenCount: inboxData.notificationsData.count,\n    markAllSeen: (_inboxData$inbox3 = inboxData.inbox) === null || _inboxData$inbox3 === void 0 ? void 0 : (_inboxData$inbox3$fee = _inboxData$inbox3.feed.markAllSeen) === null || _inboxData$inbox3$fee === void 0 ? void 0 : _inboxData$inbox3$fee.bind((_inboxData$inbox4 = inboxData.inbox) === null || _inboxData$inbox4 === void 0 ? void 0 : _inboxData$inbox4.feed)\n  };\n}\n\nfunction useEvent(eventName, callback) {\n  var inboxData = React.useContext(InboxContext$1);\n  React.useEffect(function () {\n    var _inboxData$inbox;\n    var emitter = inboxData === null || inboxData === void 0 ? void 0 : (_inboxData$inbox = inboxData.inbox) === null || _inboxData$inbox === void 0 ? void 0 : _inboxData$inbox.emitter;\n    if (emitter) {\n      emitter.on(eventName, callback);\n    }\n    return function () {\n      return emitter === null || emitter === void 0 ? void 0 : emitter.off(eventName);\n    };\n  }, [inboxData === null || inboxData === void 0 ? void 0 : inboxData.inbox]);\n}\n\nfunction useStoreUnseenCount(storeId) {\n  var _inboxData$notificati, _inboxData$notificati2;\n  var inboxData = React.useContext(InboxContext$1);\n  return {\n    unSeenCount: (_inboxData$notificati = inboxData.notificationsData.storeData) === null || _inboxData$notificati === void 0 ? void 0 : (_inboxData$notificati2 = _inboxData$notificati[storeId]) === null || _inboxData$notificati2 === void 0 ? void 0 : _inboxData$notificati2.unseenCount\n  };\n}\nfunction useStoresUnseenCount() {\n  var inboxData = React.useContext(InboxContext$1);\n  var storeData = inboxData.notificationsData.storeData;\n  var storeCount = {};\n  for (var storeId in storeData) {\n    var store = storeData[storeId];\n    storeCount[storeId] = store.unseenCount;\n  }\n  return storeCount;\n}\n\nfunction SuprsendInbox(_ref) {\n  var _ref$workspaceKey = _ref.workspaceKey,\n    workspaceKey = _ref$workspaceKey === void 0 ? '' : _ref$workspaceKey,\n    _ref$tenantId = _ref.tenantId,\n    tenantId = _ref$tenantId === void 0 ? '' : _ref$tenantId,\n    _ref$distinctId = _ref.distinctId,\n    distinctId = _ref$distinctId === void 0 ? '' : _ref$distinctId,\n    _ref$subscriberId = _ref.subscriberId,\n    subscriberId = _ref$subscriberId === void 0 ? '' : _ref$subscriberId,\n    _ref$inboxId = _ref.inboxId,\n    inboxId = _ref$inboxId === void 0 ? '' : _ref$inboxId,\n    stores = _ref.stores,\n    toastProps = _ref.toastProps,\n    notificationClickHandler = _ref.notificationClickHandler,\n    bellComponent = _ref.bellComponent,\n    badgeComponent = _ref.badgeComponent,\n    notificationComponent = _ref.notificationComponent,\n    noNotificationsComponent = _ref.noNotificationsComponent,\n    loaderComponent = _ref.loaderComponent,\n    tabBadgeComponent = _ref.tabBadgeComponent,\n    _ref$hideAvatar = _ref.hideAvatar,\n    hideAvatar = _ref$hideAvatar === void 0 ? false : _ref$hideAvatar,\n    hideInbox = _ref.hideInbox,\n    hideToast = _ref.hideToast,\n    theme = _ref.theme,\n    _ref$themeType = _ref.themeType,\n    themeType = _ref$themeType === void 0 ? 'light' : _ref$themeType,\n    _ref$pagination = _ref.pagination,\n    pagination = _ref$pagination === void 0 ? true : _ref$pagination,\n    pageSize = _ref.pageSize,\n    _ref$popperPosition = _ref.popperPosition,\n    popperPosition = _ref$popperPosition === void 0 ? 'bottom' : _ref$popperPosition,\n    _ref$showUnreadCountO = _ref.showUnreadCountOnTabs,\n    showUnreadCountOnTabs = _ref$showUnreadCountO === void 0 ? true : _ref$showUnreadCountO;\n  if (inboxId) {\n    subscriberId = inboxId;\n  }\n  var _useState = React.useState(false),\n    openInbox = _useState[0],\n    toggleInbox = _useState[1];\n  var _useState2 = React.useState(),\n    inbox = _useState2[0],\n    setInbox = _useState2[1];\n  var _useState3 = React.useState({\n      storeData: {},\n      count: 0\n    }),\n    notificationsData = _useState3[0],\n    setNotificationsData = _useState3[1];\n  var _useState4 = React.useState(''),\n    activeStore = _useState4[0],\n    setActiveStore = _useState4[1];\n  var _useState5 = React.useState(false),\n    changingActiveStore = _useState5[0],\n    setChangingActiveStore = _useState5[1];\n  React.useEffect(function () {\n    var inboxInst = new SuprsendJSInbox(workspaceKey, {\n      pageSize: pageSize,\n      tenantID: tenantId,\n      stores: stores\n    });\n    setInbox(inboxInst);\n    inboxInst.emitter.on('sync_notif_store', function () {\n      var inboxData = inboxInst.feed.data;\n      setNotificationsData({\n        storeData: (inboxData === null || inboxData === void 0 ? void 0 : inboxData.stores) || {},\n        count: (inboxData === null || inboxData === void 0 ? void 0 : inboxData.unseenCount) || 0,\n        hasNext: inboxData === null || inboxData === void 0 ? void 0 : inboxData.hasNext,\n        initialLoading: inboxData === null || inboxData === void 0 ? void 0 : inboxData.initialLoading,\n        activeStoreId: inboxData === null || inboxData === void 0 ? void 0 : inboxData.activeStoreId\n      });\n      setActiveStore(inboxData === null || inboxData === void 0 ? void 0 : inboxData.activeStoreId);\n    });\n    inboxInst.emitter.on('new_notification', function (notification) {\n      notify({\n        notificationsData: notification,\n        toastProps: toastProps\n      });\n    });\n    return function () {\n      inboxInst.emitter.all.clear();\n    };\n  }, []);\n  React.useEffect(function () {\n    if (openInbox && subscriberId && inbox) {\n      inbox.feed.markAllSeen();\n    }\n  }, [openInbox, subscriberId, inbox]);\n  React.useEffect(function () {\n    if (!subscriberId || !inbox) return;\n    setNotificationsData({\n      storeData: {},\n      count: 0\n    });\n    inbox.identifyUser(distinctId, subscriberId);\n    inbox.feed.fetchNotifications();\n    return function () {\n      inbox.resetUser();\n    };\n  }, [subscriberId, inbox]);\n  var themeValue = themeType === 'dark' ? mergeDeep(darkTheme, theme) : theme || {};\n  return /*#__PURE__*/React__default.createElement(InboxThemeContext.Provider, {\n    value: themeValue\n  }, /*#__PURE__*/React__default.createElement(InboxContext.Provider, {\n    value: {\n      workspaceKey: workspaceKey,\n      notificationsData: notificationsData,\n      setNotificationsData: setNotificationsData,\n      notificationClickHandler: notificationClickHandler,\n      bellComponent: bellComponent,\n      badgeComponent: badgeComponent,\n      notificationComponent: notificationComponent,\n      noNotificationsComponent: noNotificationsComponent,\n      tabBadgeComponent: tabBadgeComponent,\n      toggleInbox: toggleInbox,\n      inbox: inbox,\n      loaderComponent: loaderComponent,\n      pagination: pagination,\n      hideAvatar: hideAvatar,\n      activeStore: activeStore,\n      setActiveStore: setActiveStore,\n      changingActiveStore: changingActiveStore,\n      setChangingActiveStore: setChangingActiveStore,\n      showUnreadCountOnTabs: showUnreadCountOnTabs,\n      themeType: themeType\n    }\n  }, !hideInbox && /*#__PURE__*/React__default.createElement(Inbox, {\n    openInbox: openInbox,\n    toggleInbox: toggleInbox,\n    popperPosition: popperPosition\n  }), !hideToast && /*#__PURE__*/React__default.createElement(Toast, toastProps)));\n}\n\nexports.SuprSendProvider = SuprSendProvider;\nexports[\"default\"] = SuprsendInbox;\nexports.useBell = useBell;\nexports.useEvent = useEvent;\nexports.useNotifications = useNotifications;\nexports.useStoreUnseenCount = useStoreUnseenCount;\nexports.useStoresUnseenCount = useStoresUnseenCount;\nexports.useUnseenCount = useUnseenCount;\n//# sourceMappingURL=index.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHN1cHJzZW5kL3JlYWN0LWluYm94L2Rpc3QvaW5kZXguanMiLCJtYXBwaW5ncyI6IkFBQUEsZ0NBQWdDOztBQUVoQyxZQUFZLG1CQUFPLENBQUMsd0dBQU87QUFDM0I7QUFDQSxzQ0FBc0MsbUJBQU8sQ0FBQyxrRkFBb0I7QUFDbEUsa0JBQWtCLG1CQUFPLENBQUMsd0VBQWM7QUFDeEMsNkJBQTZCLG1CQUFPLENBQUMsd0ZBQWlCO0FBQ3RELFlBQVksbUJBQU8sQ0FBQyxxRkFBZ0I7QUFDcEMsK0JBQStCLG1CQUFPLENBQUMsb0VBQWdCO0FBQ3ZELDhCQUE4QixtQkFBTyxDQUFDLHNFQUFlO0FBQ3JELHFDQUFxQyxtQkFBTyxDQUFDLDJHQUFpQztBQUM5RSxvQkFBb0IsbUJBQU8sQ0FBQyxrRkFBZ0I7QUFDNUMsbUJBQU8sQ0FBQyx5R0FBdUM7O0FBRS9DO0FBQ0E7QUFDQSxvQkFBb0Isc0JBQXNCO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkdBQTZHLHFCQUFxQixvS0FBb0ssc0JBQXNCLGdCQUFnQixnQkFBZ0I7QUFDNVYseUhBQXlILGdCQUFnQjtBQUN6SSwwSEFBMEgscUJBQXFCO0FBQy9JO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQSx5Q0FBeUM7QUFDekMsOENBQThDO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsNkhBQTZILGdCQUFnQixjQUFjLDBCQUEwQixvQkFBb0IsbUJBQW1CLHFCQUFxQix1QkFBdUIsMkJBQTJCLGdCQUFnQix1QkFBdUI7O0FBRTFVO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0VBQXdFLHNEQUFzRDtBQUM5SCxRQUFRO0FBQ1I7QUFDQSxtREFBbUQ7QUFDbkQ7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCO0FBQ3hCO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsR0FBRztBQUNIO0FBQ0EsR0FBRztBQUNIO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLEdBQUc7QUFDSDtBQUNBLEdBQUc7QUFDSDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxHQUFHLG9NQUFvTSx3T0FBd08sWUFBWTtBQUMzYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEdBQUc7QUFDSDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsR0FBRztBQUNIO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsR0FBRztBQUNIO0FBQ0EsR0FBRztBQUNIO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsR0FBRztBQUNIO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsR0FBRztBQUNIO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLEdBQUc7QUFDSDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsR0FBRztBQUNIO0FBQ0EsR0FBRztBQUNIO0FBQ0EscUhBQXFILG9CQUFvQiwyQkFBMkIsb0NBQW9DLGFBQWE7QUFDck47QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0EsQ0FBQztBQUNELHdIQUF3SCx3QkFBd0Isc0JBQXNCLGFBQWE7QUFDbkw7QUFDQSxDQUFDO0FBQ0Q7QUFDQSwwSEFBMEg7QUFDMUgsNkhBQTZILDRCQUE0QiwwQkFBMEIsYUFBYSw0QkFBNEIsa0NBQWtDLEtBQUs7QUFDblE7QUFDQSxDQUFDO0FBQ0QsK0hBQStILDBCQUEwQixxQkFBcUIsdUJBQXVCO0FBQ3JNLDBIQUEwSCx3QkFBd0IsNEJBQTRCLG1DQUFtQztBQUNqTixpSUFBaUksNEJBQTRCLHNCQUFzQixxQkFBcUI7QUFDeE0sb0hBQW9ILHNCQUFzQix3QkFBd0IscUJBQXFCLG9LQUFvSyxnQkFBZ0I7QUFDM1csOEhBQThILHVCQUF1QixlQUFlLGdCQUFnQixxQkFBcUI7QUFDek07QUFDQSxDQUFDO0FBQ0Q7QUFDQSwySEFBMkgsd0JBQXdCLGNBQWMsdUJBQXVCLHFCQUFxQiw0QkFBNEI7QUFDek8sdUhBQXVILHFCQUFxQix1QkFBdUIsMEJBQTBCLHNCQUFzQixhQUFhLHdDQUF3QyxLQUFLO0FBQzdRO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsdUhBQXVILHVCQUF1QiwwQkFBMEIscUJBQXFCLG9CQUFvQjtBQUNqTix3SUFBd0ksdUJBQXVCLHdCQUF3Qix3QkFBd0IsYUFBYSx3Q0FBd0MsS0FBSztBQUN6UTtBQUNBO0FBQ0EsQ0FBQztBQUNELG1JQUFtSTtBQUNuSSxvSEFBb0gsNEJBQTRCLGlCQUFpQjtBQUNqSywwSEFBMEgsb0JBQW9CLHVCQUF1QjtBQUNySztBQUNBLGlIQUFpSDtBQUNqSCxxSEFBcUgsMkJBQTJCLHdCQUF3QixvQkFBb0Isb0JBQW9CLGFBQWE7QUFDN04sc0hBQXNILGdCQUFnQix5QkFBeUI7QUFDL0osMkhBQTJILGVBQWUsa0JBQWtCLHFCQUFxQixpQkFBaUIsMkJBQTJCLHNCQUFzQix1QkFBdUIsdUJBQXVCLG9EQUFvRCxpQkFBaUI7QUFDdFc7QUFDQSxDQUFDO0FBQ0Qsb0hBQW9ILHVCQUF1QixrQkFBa0Isd0JBQXdCLGFBQWEsYUFBYSw2QkFBNkIsS0FBSztBQUNqUDtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0EsMEhBQTBILHFCQUFxQjtBQUMvSTtBQUNBLENBQUM7QUFDRCxzSEFBc0gsZ0JBQWdCLGFBQWEseUJBQXlCLDZCQUE2QixLQUFLO0FBQzlNO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBLE9BQU87QUFDUCxNQUFNO0FBQ047QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBLHlJQUF5SSw0QkFBNEIsd0JBQXdCLDJCQUEyQixpQkFBaUIscUJBQXFCO0FBQzlQLG1JQUFtSSx1QkFBdUIsa0NBQWtDLHFCQUFxQix3QkFBd0IsZ0JBQWdCO0FBQ3pQLDJIQUEySCx1QkFBdUI7QUFDbEosMkdBQTJHLDRCQUE0QixHQUFHLFFBQVEsOEJBQThCLEdBQUc7QUFDbkwsb0hBQW9ILHFCQUFxQiwyQkFBMkIsdUJBQXVCLGdCQUFnQixpQkFBaUIsdUNBQXVDLGdCQUFnQjtBQUNuUjtBQUNBLENBQUM7QUFDRDtBQUNBLENBQUM7QUFDRDtBQUNBLENBQUM7QUFDRDtBQUNBLENBQUM7QUFDRDtBQUNBLENBQUM7QUFDRCw4SEFBOEgsNEJBQTRCLHdCQUF3QjtBQUNsTCw4SEFBOEg7O0FBRTlIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLEdBQUc7QUFDSDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsS0FBSztBQUNMO0FBQ0Esd0JBQXdCO0FBQ3hCO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQSwwSEFBMEgsV0FBVyxrQkFBa0Isd0JBQXdCLGtCQUFrQiwyQkFBMkIsNkNBQTZDO0FBQ3pRLDBIQUEwSCxtQ0FBbUMsd0JBQXdCLHdCQUF3Qix5QkFBeUI7QUFDdE87QUFDQSxDQUFDO0FBQ0Q7QUFDQSxDQUFDO0FBQ0QsMkhBQTJILHVCQUF1Qiw2QkFBNkIsMEJBQTBCLDBCQUEwQixvQkFBb0IsS0FBSztBQUM1UCx1SUFBdUksd0JBQXdCLG9CQUFvQixrQkFBa0Isd0JBQXdCLGFBQWE7QUFDMU87QUFDQSxDQUFDO0FBQ0QsMEhBQTBILHFCQUFxQixnQkFBZ0I7QUFDL0o7QUFDQSxDQUFDO0FBQ0Qsc0lBQXNJLG9CQUFvQjtBQUMxSixrSUFBa0ksb0JBQW9CLG9CQUFvQjtBQUMxSyxxSEFBcUgsZ0JBQWdCLHVCQUF1QixnREFBZ0Qsa0JBQWtCLHdCQUF3Qiw0QkFBNEIsZ0JBQWdCO0FBQ2xTLHNIQUFzSCxpQkFBaUIsb0JBQW9CLHFCQUFxQixtQkFBbUIsb0tBQW9LO0FBQ3ZXO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLHVIQUF1SCxpQkFBaUIscUJBQXFCLHVCQUF1QiwyQkFBMkIsMkJBQTJCLDBCQUEwQixxQkFBcUIsK0NBQStDLCtCQUErQixvQkFBb0Isa0JBQWtCLHlCQUF5QixLQUFLOztBQUUzYTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QjtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLHNCQUFzQjtBQUN0QjtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQSw0SEFBNEgsMEJBQTBCLGtDQUFrQyxtQkFBbUI7QUFDM00sZ0lBQWdJLHFCQUFxQix1QkFBdUIsb0JBQW9COztBQUVoTTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsR0FBRztBQUNIO0FBQ0EsR0FBRztBQUNIO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsR0FBRyxvTUFBb00sd09BQXdPLFlBQVk7QUFDM2I7QUFDQSxnSUFBZ0ksb0JBQW9CLGtCQUFrQixrQkFBa0IsNEJBQTRCO0FBQ3BOLCtIQUErSCxzQkFBc0IscUJBQXFCLHFCQUFxQjtBQUMvTCwwSEFBMEgsc0JBQXNCLHFCQUFxQixvS0FBb0ssZ0JBQWdCLHFCQUFxQixnQkFBZ0I7QUFDOVgsMEhBQTBILGdCQUFnQix5QkFBeUI7QUFDbkssNEhBQTRILHVCQUF1Qjs7QUFFbko7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEdBQUc7QUFDSDtBQUNBLG9LQUFvSyx1QkFBdUIsdUJBQXVCLG1CQUFtQixtQkFBbUIsS0FBSywwR0FBMEcsbUJBQW1CLHlCQUF5QixvQ0FBb0MsS0FBSyw2QkFBNkIsbUJBQW1CLEtBQUs7O0FBRWpmO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZDQUE2QztBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlHQUFpRztBQUNqRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlHQUFpRztBQUNqRztBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUEsd0JBQXdCO0FBQ3hCLGtCQUFlO0FBQ2YsZUFBZTtBQUNmLGdCQUFnQjtBQUNoQix3QkFBd0I7QUFDeEIsMkJBQTJCO0FBQzNCLDRCQUE0QjtBQUM1QixzQkFBc0I7QUFDdEIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9teXRhc2tzLy4vbm9kZV9tb2R1bGVzL0BzdXByc2VuZC9yZWFjdC1pbmJveC9kaXN0L2luZGV4LmpzP2FmMzAiXSwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gX2ludGVyb3BEZWZhdWx0IChleCkgeyByZXR1cm4gKGV4ICYmICh0eXBlb2YgZXggPT09ICdvYmplY3QnKSAmJiAnZGVmYXVsdCcgaW4gZXgpID8gZXhbJ2RlZmF1bHQnXSA6IGV4OyB9XG5cbnZhciBSZWFjdCA9IHJlcXVpcmUoJ3JlYWN0Jyk7XG52YXIgUmVhY3RfX2RlZmF1bHQgPSBfaW50ZXJvcERlZmF1bHQoUmVhY3QpO1xudmFyIFN1cHJzZW5kSlNJbmJveCA9IF9pbnRlcm9wRGVmYXVsdChyZXF1aXJlKCdAc3VwcnNlbmQvanMtaW5ib3gnKSk7XG52YXIgcmVhY3RQb3BwZXIgPSByZXF1aXJlKCdyZWFjdC1wb3BwZXInKTtcbnZhciBzdHlsZWQgPSBfaW50ZXJvcERlZmF1bHQocmVxdWlyZSgnQGVtb3Rpb24vc3R5bGVkJykpO1xudmFyIHJlYWN0ID0gcmVxdWlyZSgnQGVtb3Rpb24vcmVhY3QnKTtcbnZhciBNYXJrZG93biA9IF9pbnRlcm9wRGVmYXVsdChyZXF1aXJlKCdyZWFjdC1tYXJrZG93bicpKTtcbnZhciBUaW1lQWdvID0gX2ludGVyb3BEZWZhdWx0KHJlcXVpcmUoJ3JlYWN0LXRpbWVhZ28nKSk7XG52YXIgSW5maW5pdGVTY3JvbGwgPSBfaW50ZXJvcERlZmF1bHQocmVxdWlyZSgncmVhY3QtaW5maW5pdGUtc2Nyb2xsLWNvbXBvbmVudCcpKTtcbnZhciByZWFjdFRvYXN0aWZ5ID0gcmVxdWlyZSgncmVhY3QtdG9hc3RpZnknKTtcbnJlcXVpcmUoJ3JlYWN0LXRvYXN0aWZ5L2Rpc3QvUmVhY3RUb2FzdGlmeS5jc3MnKTtcblxuZnVuY3Rpb24gX2V4dGVuZHMoKSB7XG4gIF9leHRlbmRzID0gT2JqZWN0LmFzc2lnbiA/IE9iamVjdC5hc3NpZ24uYmluZCgpIDogZnVuY3Rpb24gKHRhcmdldCkge1xuICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldO1xuICAgICAgZm9yICh2YXIga2V5IGluIHNvdXJjZSkge1xuICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHNvdXJjZSwga2V5KSkge1xuICAgICAgICAgIHRhcmdldFtrZXldID0gc291cmNlW2tleV07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRhcmdldDtcbiAgfTtcbiAgcmV0dXJuIF9leHRlbmRzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5mdW5jdGlvbiBfdGFnZ2VkVGVtcGxhdGVMaXRlcmFsTG9vc2Uoc3RyaW5ncywgcmF3KSB7XG4gIGlmICghcmF3KSB7XG4gICAgcmF3ID0gc3RyaW5ncy5zbGljZSgwKTtcbiAgfVxuICBzdHJpbmdzLnJhdyA9IHJhdztcbiAgcmV0dXJuIHN0cmluZ3M7XG59XG5cbnZhciBfdGVtcGxhdGVPYmplY3QsIF90ZW1wbGF0ZU9iamVjdDIsIF90ZW1wbGF0ZU9iamVjdDM7XG52YXIgbGlnaHRDb2xvcnMgPSB7XG4gIHByaW1hcnk6ICcjMkU3MEU4JyxcbiAgcHJpbWFyeVRleHQ6ICcjMUUyOTNCJyxcbiAgc2Vjb25kYXJ5VGV4dDogJyM0NzU1NjknLFxuICBib3JkZXI6ICcjRTJFOEYwJyxcbiAgbWFpbjogJyNGRkZGRkYnLFxuICBlcnJvcjogJyNCNDIzMTgnXG59O1xudmFyIGRhcmtDb2xvcnMgPSB7XG4gIHByaW1hcnk6ICcjMkU3MEU4JyxcbiAgcHJpbWFyeVRleHQ6ICcjRUZFRkVGJyxcbiAgc2Vjb25kYXJ5VGV4dDogJyNDQkQ1RTEnLFxuICBib3JkZXI6ICcjM0E0QTYxJyxcbiAgbWFpbjogJyMxRDI2MzUnLFxuICBlcnJvcjogJyNGOTcwNjYnXG59O1xudmFyIENUZXh0ID0gc3R5bGVkLnAoX3RlbXBsYXRlT2JqZWN0IHx8IChfdGVtcGxhdGVPYmplY3QgPSBfdGFnZ2VkVGVtcGxhdGVMaXRlcmFsTG9vc2UoW1wiXFxuICBmb250LXNpemU6IDE0cHg7XFxuICBmb250LXdlaWdodDogNDAwO1xcbiAgZm9udC1mYW1pbHk6IC1hcHBsZS1zeXN0ZW0sIEJsaW5rTWFjU3lzdGVtRm9udCwgJ1NlZ29lIFVJJywgUm9ib3RvLCBIZWx2ZXRpY2EsXFxuICAgIEFyaWFsLCBzYW5zLXNlcmlmLCAnQXBwbGUgQ29sb3IgRW1vamknLCAnU2Vnb2UgVUkgRW1vamknLCAnU2Vnb2UgVUkgU3ltYm9sJztcXG4gIGxpbmUtaGVpZ2h0OiAyMHB4O1xcbiAgY29sb3I6IFwiLCBcIjtcXG4gIG1hcmdpbjogMHB4O1xcblwiXSkpLCBsaWdodENvbG9ycy5wcmltYXJ5VGV4dCk7XG52YXIgSGVscGVyVGV4dCA9IHN0eWxlZChDVGV4dCkoX3RlbXBsYXRlT2JqZWN0MiB8fCAoX3RlbXBsYXRlT2JqZWN0MiA9IF90YWdnZWRUZW1wbGF0ZUxpdGVyYWxMb29zZShbXCJcXG4gIGZvbnQtc2l6ZTogMTJweDtcXG4gIGNvbG9yOiBcIiwgXCI7XFxuXCJdKSksIGxpZ2h0Q29sb3JzLnNlY29uZGFyeVRleHQpO1xudmFyIEhlYWRpbmdUZXh0ID0gc3R5bGVkKENUZXh0KShfdGVtcGxhdGVPYmplY3QzIHx8IChfdGVtcGxhdGVPYmplY3QzID0gX3RhZ2dlZFRlbXBsYXRlTGl0ZXJhbExvb3NlKFtcIlxcbiAgZm9udC1zaXplOiAxNnB4O1xcbiAgZm9udC13ZWlnaHQ6IDUwMDtcXG5cIl0pKSk7XG52YXIgZGFya1RoZW1lID0ge1xuICBiZWxsOiB7XG4gICAgY29sb3I6ICcjZmZmJ1xuICB9LFxuICBiYWRnZToge1xuICAgIGJhY2tncm91bmRDb2xvcjogZGFya0NvbG9ycy5wcmltYXJ5XG4gIH0sXG4gIGhlYWRlcjoge1xuICAgIGNvbnRhaW5lcjoge1xuICAgICAgYmFja2dyb3VuZENvbG9yOiBkYXJrQ29sb3JzLm1haW4sXG4gICAgICBib3JkZXJCb3R0b206IFwiMC41cHggc29saWQgXCIgKyBkYXJrQ29sb3JzLmJvcmRlcixcbiAgICAgIGJveFNoYWRvdzogJzAgMCA1cHggMCByZ2JhKDAsIDAsIDAsIDAuNSknXG4gICAgfSxcbiAgICBoZWFkZXJUZXh0OiB7XG4gICAgICBjb2xvcjogZGFya0NvbG9ycy5wcmltYXJ5VGV4dFxuICAgIH0sXG4gICAgbWFya0FsbFJlYWRUZXh0OiB7XG4gICAgICBjb2xvcjogZGFya0NvbG9ycy5wcmltYXJ5XG4gICAgfVxuICB9LFxuICB0YWJzOiB7XG4gICAgY29sb3I6IGRhcmtDb2xvcnMucHJpbWFyeVRleHQsXG4gICAgdW5zZWxlY3RlZENvbG9yOiBkYXJrQ29sb3JzLnNlY29uZGFyeVRleHQgKyAnRDknLFxuICAgIGJvdHRvbUNvbG9yOiBkYXJrQ29sb3JzLnByaW1hcnksXG4gICAgYmFkZ2VDb2xvcjogJ3JnYmEoMTAwLCAxMTYsIDEzOSwgMC41KScsXG4gICAgYmFkZ2VUZXh0OiBkYXJrQ29sb3JzLnByaW1hcnlUZXh0XG4gIH0sXG4gIG5vdGlmaWNhdGlvbnNDb250YWluZXI6IHtcbiAgICBjb250YWluZXI6IHtcbiAgICAgIGJhY2tncm91bmRDb2xvcjogZGFya0NvbG9ycy5tYWluLFxuICAgICAgYm9yZGVyQ29sb3I6IGRhcmtDb2xvcnMuYm9yZGVyXG4gICAgfSxcbiAgICBub05vdGlmaWNhdGlvbnNUZXh0OiB7XG4gICAgICBjb2xvcjogZGFya0NvbG9ycy5wcmltYXJ5VGV4dFxuICAgIH0sXG4gICAgbm9Ob3RpZmljYXRpb25zU3VidGV4dDoge1xuICAgICAgY29sb3I6IGRhcmtDb2xvcnMuc2Vjb25kYXJ5VGV4dFxuICAgIH0sXG4gICAgbG9hZGVyOiB7XG4gICAgICBjb2xvcjogZGFya0NvbG9ycy5wcmltYXJ5XG4gICAgfVxuICB9LFxuICBub3RpZmljYXRpb246IHtcbiAgICBjb250YWluZXI6IHtcbiAgICAgIGJvcmRlckJvdHRvbTogXCIxcHggc29saWQgXCIgKyBkYXJrQ29sb3JzLmJvcmRlcixcbiAgICAgIHJlYWRCYWNrZ3JvdW5kQ29sb3I6IGRhcmtDb2xvcnMubWFpbixcbiAgICAgIHVucmVhZEJhY2tncm91bmRDb2xvcjogJyMyNzMyNDQnLFxuICAgICAgaG92ZXJCYWNrZ3JvdW5kQ29sb3I6ICcjMkQzQTREJ1xuICAgIH0sXG4gICAgcGlubmVkVGV4dDoge1xuICAgICAgY29sb3I6IGRhcmtDb2xvcnMgPT09IG51bGwgfHwgZGFya0NvbG9ycyA9PT0gdm9pZCAwID8gdm9pZCAwIDogZGFya0NvbG9ycy5zZWNvbmRhcnlUZXh0XG4gICAgfSxcbiAgICBoZWFkZXJUZXh0OiB7XG4gICAgICBjb2xvcjogZGFya0NvbG9ycy5wcmltYXJ5VGV4dFxuICAgIH0sXG4gICAgYm9keVRleHQ6IHtcbiAgICAgIGNvbG9yOiBkYXJrQ29sb3JzLnNlY29uZGFyeVRleHQsXG4gICAgICBibG9ja3F1b3RlQ29sb3I6ICdyZ2JhKDEwMCwgMTE2LCAxMzksIDAuNSknXG4gICAgfSxcbiAgICB1bnNlZW5Eb3Q6IHtcbiAgICAgIGJhY2tncm91bmRDb2xvcjogZGFya0NvbG9ycy5wcmltYXJ5XG4gICAgfSxcbiAgICBjcmVhdGVkT25UZXh0OiB7XG4gICAgICBjb2xvcjogZGFya0NvbG9ycy5zZWNvbmRhcnlUZXh0XG4gICAgfSxcbiAgICBzdWJ0ZXh0OiB7XG4gICAgICBjb2xvcjogJyM5NGEzYjgnXG4gICAgfSxcbiAgICBhY3Rpb25zOiBbe1xuICAgICAgY29udGFpbmVyOiB7XG4gICAgICAgIGJhY2tncm91bmRDb2xvcjogZGFya0NvbG9ycy5wcmltYXJ5XG4gICAgICB9XG4gICAgfSwge1xuICAgICAgY29udGFpbmVyOiB7XG4gICAgICAgIGJvcmRlckNvbG9yOiBkYXJrQ29sb3JzLmJvcmRlcixcbiAgICAgICAgYmFja2dyb3VuZENvbG9yOiAndHJhbnNwYXJlbnQnLFxuICAgICAgICBob3ZlckJhY2tncm91bmRDb2xvcjogZGFya0NvbG9ycy5tYWluXG4gICAgICB9LFxuICAgICAgdGV4dDoge1xuICAgICAgICBjb2xvcjogZGFya0NvbG9ycy5zZWNvbmRhcnlUZXh0XG4gICAgICB9XG4gICAgfV0sXG4gICAgZXhwaXJlc1RleHQ6IHtcbiAgICAgIGJhY2tncm91bmRDb2xvcjogJ3JnYmEoMTAwLCAxMTYsIDEzOSwgMC41KScsXG4gICAgICBjb2xvcjogZGFya0NvbG9ycy5zZWNvbmRhcnlUZXh0LFxuICAgICAgZXhwaXJpbmdCYWNrZ3JvdW5kQ29sb3I6ICdyZ2JhKDIxNywgNDUsIDMyLCAwLjE1KScsXG4gICAgICBleHBpcmluZ0NvbG9yOiBkYXJrQ29sb3JzLmVycm9yXG4gICAgfSxcbiAgICBhY3Rpb25zTWVudUljb246IHtcbiAgICAgIGNvbG9yOiBkYXJrQ29sb3JzLnNlY29uZGFyeVRleHQsXG4gICAgICBob3ZlckJhY2tncm91bmRDb2xvcjogJ3JnYmEoMTAwLCAxMTYsIDEzOSwgMC41KSdcbiAgICB9LFxuICAgIGFjdGlvbnNNZW51OiB7XG4gICAgICBiYWNrZ3JvdW5kQ29sb3I6IGRhcmtDb2xvcnMubWFpbixcbiAgICAgIGJvcmRlckNvbG9yOiBkYXJrQ29sb3JzLmJvcmRlclxuICAgIH0sXG4gICAgYWN0aW9uc01lbnVJdGVtOiB7XG4gICAgICBob3ZlckJhY2tncm91bmRDb2xvcjogJ3JnYmEoMTAwLCAxMTYsIDEzOSwgMC4yKSdcbiAgICB9LFxuICAgIGFjdGlvbnNNZW51SXRlbUljb246IHtcbiAgICAgIGNvbG9yOiBkYXJrQ29sb3JzLnNlY29uZGFyeVRleHRcbiAgICB9LFxuICAgIGFjdGlvbnNNZW51SXRlbVRleHQ6IHtcbiAgICAgIGNvbG9yOiBkYXJrQ29sb3JzLnNlY29uZGFyeVRleHRcbiAgICB9XG4gIH0sXG4gIHRvYXN0OiB7XG4gICAgY29udGFpbmVyOiB7XG4gICAgICBiYWNrZ3JvdW5kQ29sb3I6IGRhcmtDb2xvcnMubWFpbixcbiAgICAgIGJvcmRlckNvbG9yOiBkYXJrQ29sb3JzLmJvcmRlclxuICAgIH0sXG4gICAgaGVhZGVyVGV4dDoge1xuICAgICAgY29sb3I6IGRhcmtDb2xvcnMucHJpbWFyeVRleHRcbiAgICB9LFxuICAgIGJvZHlUZXh0OiB7XG4gICAgICBjb2xvcjogZGFya0NvbG9ycy5zZWNvbmRhcnlUZXh0LFxuICAgICAgYmxvY2txdW90ZUNvbG9yOiBkYXJrQ29sb3JzLmJvcmRlclxuICAgIH1cbiAgfVxufTtcblxudmFyIERlZmF1bHRCZWxsSWNvbiA9IGZ1bmN0aW9uIERlZmF1bHRCZWxsSWNvbihfcmVmKSB7XG4gIHZhciBzdHlsZSA9IF9yZWYuc3R5bGU7XG4gIHZhciBoZWlnaHQgPSAoc3R5bGUgPT09IG51bGwgfHwgc3R5bGUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHN0eWxlLmhlaWdodCkgfHwgMjQ7XG4gIHZhciB3aWR0aCA9IChzdHlsZSA9PT0gbnVsbCB8fCBzdHlsZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogc3R5bGUud2lkdGgpIHx8IDI0O1xuICB2YXIgY29sb3IgPSAoc3R5bGUgPT09IG51bGwgfHwgc3R5bGUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHN0eWxlLmNvbG9yKSB8fCBsaWdodENvbG9ycy5wcmltYXJ5VGV4dDtcbiAgaWYgKChzdHlsZSA9PT0gbnVsbCB8fCBzdHlsZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogc3R5bGUuYmVsbFR5cGUpID09PSAnc29saWQnKSB7XG4gICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KFwic3ZnXCIsIHtcbiAgICAgIHhtbG5zOiBcImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIsXG4gICAgICB3aWR0aDogd2lkdGgsXG4gICAgICBoZWlnaHQ6IGhlaWdodCxcbiAgICAgIGNvbG9yOiBjb2xvcixcbiAgICAgIHZpZXdCb3g6IFwiMCAwIDIwIDIwXCIsXG4gICAgICBmaWxsOiBcImN1cnJlbnRDb2xvclwiXG4gICAgfSwgLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXCJwYXRoXCIsIHtcbiAgICAgIGQ6IFwiTTEwIDJhNiA2IDAgMDAtNiA2djMuNTg2bC0uNzA3LjcwN0ExIDEgMCAwMDQgMTRoMTJhMSAxIDAgMDAuNzA3LTEuNzA3TDE2IDExLjU4NlY4YTYgNiAwIDAwLTYtNnpNMTAgMThhMyAzIDAgMDEtMy0zaDZhMyAzIDAgMDEtMyAzelwiXG4gICAgfSkpO1xuICB9XG4gIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChcInN2Z1wiLCB7XG4gICAgeG1sbnM6IFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIixcbiAgICB3aWR0aDogd2lkdGgsXG4gICAgaGVpZ2h0OiBoZWlnaHQsXG4gICAgY29sb3I6IGNvbG9yLFxuICAgIGZpbGw6IFwibm9uZVwiLFxuICAgIHZpZXdCb3g6IFwiMCAwIDI0IDI0XCIsXG4gICAgc3Ryb2tlOiBcImN1cnJlbnRDb2xvclwiLFxuICAgIHN0cm9rZVdpZHRoOiBcIjJcIlxuICB9LCAvKiNfX1BVUkVfXyovUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChcInBhdGhcIiwge1xuICAgIHN0cm9rZUxpbmVjYXA6IFwicm91bmRcIixcbiAgICBzdHJva2VMaW5lam9pbjogXCJyb3VuZFwiLFxuICAgIGQ6IFwiTTE1IDE3aDVsLTEuNDA1LTEuNDA1QTIuMDMyIDIuMDMyIDAgMDExOCAxNC4xNThWMTFhNi4wMDIgNi4wMDIgMCAwMC00LTUuNjU5VjVhMiAyIDAgMTAtNCAwdi4zNDFDNy42NyA2LjE2NSA2IDguMzg4IDYgMTF2My4xNTljMCAuNTM4LS4yMTQgMS4wNTUtLjU5NSAxLjQzNkw0IDE3aDVtNiAwdjFhMyAzIDAgMTEtNiAwdi0xbTYgMEg5XCJcbiAgfSkpO1xufTtcblxudmFyIEluYm94Q29udGV4dCA9IFJlYWN0LmNyZWF0ZUNvbnRleHQoe30pO1xudmFyIEluYm94VGhlbWVDb250ZXh0ID0gUmVhY3QuY3JlYXRlQ29udGV4dCh7fSk7XG5mdW5jdGlvbiB1c2VJbmJveCgpIHtcbiAgcmV0dXJuIFJlYWN0LnVzZUNvbnRleHQoSW5ib3hDb250ZXh0KTtcbn1cbmZ1bmN0aW9uIHVzZVRoZW1lKCkge1xuICByZXR1cm4gUmVhY3QudXNlQ29udGV4dChJbmJveFRoZW1lQ29udGV4dCk7XG59XG5cbmZ1bmN0aW9uIEJlbGwoKSB7XG4gIHZhciBfdXNlSW5ib3ggPSB1c2VJbmJveCgpLFxuICAgIGJlbGxDb21wb25lbnQgPSBfdXNlSW5ib3guYmVsbENvbXBvbmVudDtcbiAgdmFyIF91c2VUaGVtZSA9IHVzZVRoZW1lKCksXG4gICAgYmVsbCA9IF91c2VUaGVtZS5iZWxsO1xuICBpZiAoYmVsbENvbXBvbmVudCkge1xuICAgIHZhciBCZWxsQ29tcG9uZW50ID0gYmVsbENvbXBvbmVudDtcbiAgICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoQmVsbENvbXBvbmVudCwgbnVsbCk7XG4gIH1cbiAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KERlZmF1bHRCZWxsSWNvbiwge1xuICAgIHN0eWxlOiBiZWxsXG4gIH0pO1xufVxuXG52YXIgX3RlbXBsYXRlT2JqZWN0JDE7XG5mdW5jdGlvbiBCYWRnZSgpIHtcbiAgdmFyIF91c2VJbmJveCA9IHVzZUluYm94KCksXG4gICAgY291bnQgPSBfdXNlSW5ib3gubm90aWZpY2F0aW9uc0RhdGEuY291bnQsXG4gICAgYmFkZ2VDb21wb25lbnQgPSBfdXNlSW5ib3guYmFkZ2VDb21wb25lbnQ7XG4gIHZhciBfdXNlVGhlbWUgPSB1c2VUaGVtZSgpLFxuICAgIGJhZGdlID0gX3VzZVRoZW1lLmJhZGdlO1xuICBpZiAoY291bnQgPiAwKSB7XG4gICAgaWYgKGJhZGdlQ29tcG9uZW50KSB7XG4gICAgICB2YXIgQmFnZGVDb21wb25lbnQgPSBiYWRnZUNvbXBvbmVudDtcbiAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChCYWdkZUNvbXBvbmVudCwge1xuICAgICAgICBjb3VudDogY291bnRcbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoQ291bnRUZXh0LCB7XG4gICAgICBzdHlsZTogYmFkZ2VcbiAgICB9LCBjb3VudCk7XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59XG52YXIgQ291bnRUZXh0ID0gc3R5bGVkKENUZXh0KShfdGVtcGxhdGVPYmplY3QkMSB8fCAoX3RlbXBsYXRlT2JqZWN0JDEgPSBfdGFnZ2VkVGVtcGxhdGVMaXRlcmFsTG9vc2UoW1wiXFxuICBwb3NpdGlvbjogYWJzb2x1dGU7XFxuICByaWdodDogLTNweDtcXG4gIHRvcDogLTdweDtcXG4gIGRpc3BsYXk6IGlubGluZS1ibG9jaztcXG4gIGZvbnQtc2l6ZTogMTBweDtcXG4gIGxpbmUtaGVpZ2h0OiAxO1xcbiAgcGFkZGluZzogM3B4IDZweDtcXG4gIGJvcmRlci1yYWRpdXM6IDUwJTtcXG4gIGJhY2tncm91bmQtY29sb3I6IFwiLCBcIjtcXG4gIGNvbG9yOiBcIiwgXCI7XFxuICB0ZXh0LWFsaWduOiBjZW50ZXI7XFxuXCJdKSksIGxpZ2h0Q29sb3JzLnByaW1hcnksIGxpZ2h0Q29sb3JzLm1haW4pO1xuXG52YXIgaXNJbWdVcmwgPSBmdW5jdGlvbiBpc0ltZ1VybCh1cmwpIHtcbiAgdHJ5IHtcbiAgICBpZiAodXJsKSB7XG4gICAgICB2YXIgaW1nID0gbmV3IHdpbmRvdy5JbWFnZSgpO1xuICAgICAgaW1nLnNyYyA9IHVybDtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcbiAgICAgICAgaW1nLm9uZXJyb3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgcmV0dXJuIHJlc29sdmUoZmFsc2UpO1xuICAgICAgICB9O1xuICAgICAgICBpbWcub25sb2FkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJldHVybiByZXNvbHZlKHRydWUpO1xuICAgICAgICB9O1xuICAgICAgfSkpO1xuICAgIH1cbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZSk7XG4gIH1cbn07XG5mdW5jdGlvbiBpc09iamVjdChpdGVtKSB7XG4gIHJldHVybiBpdGVtICYmIHR5cGVvZiBpdGVtID09PSAnb2JqZWN0JyAmJiAhQXJyYXkuaXNBcnJheShpdGVtKTtcbn1cbmZ1bmN0aW9uIG1lcmdlRGVlcCh0YXJnZXQsIHNvdXJjZSkge1xuICB2YXIgb3V0cHV0ID0gT2JqZWN0LmFzc2lnbih7fSwgdGFyZ2V0KTtcbiAgaWYgKGlzT2JqZWN0KHRhcmdldCkgJiYgaXNPYmplY3Qoc291cmNlKSkge1xuICAgIE9iamVjdC5rZXlzKHNvdXJjZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICBpZiAoaXNPYmplY3Qoc291cmNlW2tleV0pKSB7XG4gICAgICAgIHZhciBfT2JqZWN0JGFzc2lnbjtcbiAgICAgICAgaWYgKCEoa2V5IGluIHRhcmdldCkpIE9iamVjdC5hc3NpZ24ob3V0cHV0LCAoX09iamVjdCRhc3NpZ24gPSB7fSwgX09iamVjdCRhc3NpZ25ba2V5XSA9IHNvdXJjZVtrZXldLCBfT2JqZWN0JGFzc2lnbikpO2Vsc2Ugb3V0cHV0W2tleV0gPSBtZXJnZURlZXAodGFyZ2V0W2tleV0sIHNvdXJjZVtrZXldKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBfT2JqZWN0JGFzc2lnbjI7XG4gICAgICAgIE9iamVjdC5hc3NpZ24ob3V0cHV0LCAoX09iamVjdCRhc3NpZ24yID0ge30sIF9PYmplY3QkYXNzaWduMltrZXldID0gc291cmNlW2tleV0sIF9PYmplY3QkYXNzaWduMikpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG4gIHJldHVybiBvdXRwdXQ7XG59XG5mdW5jdGlvbiBmb3JtYXRBY3Rpb25MaW5rKGxpbmspIHtcbiAgaWYgKCFsaW5rKSByZXR1cm47XG4gIGlmIChsaW5rLnN0YXJ0c1dpdGgoJ2h0dHAnKSB8fCBsaW5rLnN0YXJ0c1dpdGgoJy8nKSkge1xuICAgIHJldHVybiBsaW5rO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBcImh0dHBzOi8vXCIgKyBsaW5rO1xuICB9XG59XG5mdW5jdGlvbiBnZXRMb25nRm9ybWF0dGVkVGltZSh2YWx1ZSwgdW5pdCkge1xuICBzd2l0Y2ggKHVuaXQpIHtcbiAgICBjYXNlICdzZWNvbmQnOlxuICAgICAgcmV0dXJuICdhIG1pbnV0ZSc7XG4gICAgY2FzZSAnbWludXRlJzpcbiAgICAgIHJldHVybiB2YWx1ZSA9PT0gMSA/IHZhbHVlICsgXCIgbWludXRlXCIgOiB2YWx1ZSArIFwiIG1pbnV0ZXNcIjtcbiAgICBjYXNlICdob3VyJzpcbiAgICAgIHJldHVybiB2YWx1ZSA9PT0gMSA/IHZhbHVlICsgXCIgaG91clwiIDogdmFsdWUgKyBcIiBob3Vyc1wiO1xuICAgIGNhc2UgJ2RheSc6XG4gICAgICByZXR1cm4gdmFsdWUgPT09IDEgPyB2YWx1ZSArIFwiIGRheVwiIDogdmFsdWUgKyBcIiBkYXlzXCI7XG4gICAgY2FzZSAnd2Vlayc6XG4gICAgICByZXR1cm4gdmFsdWUgPT09IDEgPyB2YWx1ZSArIFwiIHdlZWtcIiA6IHZhbHVlICsgXCIgd2Vla3NcIjtcbiAgICBjYXNlICdtb250aCc6XG4gICAgICByZXR1cm4gdmFsdWUgPT09IDEgPyB2YWx1ZSArIFwiIG1vbnRoXCIgOiB2YWx1ZSArIFwiIG1vbnRoc1wiO1xuICAgIGNhc2UgJ3llYXInOlxuICAgICAgcmV0dXJuIHZhbHVlID09PSAxID8gdmFsdWUgKyBcIiB5ZWFyXCIgOiB2YWx1ZSArIFwiIHllYXJzXCI7XG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgfVxufVxuZnVuY3Rpb24gZ2V0U2hvcnRGb3JtYXR0ZWRUaW1lKHZhbHVlLCB1bml0KSB7XG4gIHN3aXRjaCAodW5pdCkge1xuICAgIGNhc2UgJ3NlY29uZCc6XG4gICAgICByZXR1cm4gJzFtJztcbiAgICBjYXNlICdtaW51dGUnOlxuICAgICAgcmV0dXJuIHZhbHVlICsgXCJtXCI7XG4gICAgY2FzZSAnaG91cic6XG4gICAgICByZXR1cm4gdmFsdWUgKyBcImhcIjtcbiAgICBjYXNlICdkYXknOlxuICAgICAgcmV0dXJuIHZhbHVlICsgXCJkXCI7XG4gICAgY2FzZSAnd2Vlayc6XG4gICAgICByZXR1cm4gdmFsdWUgKyBcIndcIjtcbiAgICBjYXNlICdtb250aCc6XG4gICAgICByZXR1cm4gdmFsdWUgKyBcIm1vXCI7XG4gICAgY2FzZSAneWVhcic6XG4gICAgICByZXR1cm4gdmFsdWUgKyBcInlcIjtcbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuIHZhbHVlO1xuICB9XG59XG5cbnZhciBBdmF0YXJJY29uID0gZnVuY3Rpb24gQXZhdGFySWNvbihfcmVmKSB7XG4gIHZhciB0eXBlID0gX3JlZi50eXBlO1xuICBpZiAodHlwZSA9PT0gJ2RhcmsnKSB7XG4gICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KFwic3ZnXCIsIHtcbiAgICAgIHdpZHRoOiBcIjM2XCIsXG4gICAgICBoZWlnaHQ6IFwiMzZcIixcbiAgICAgIHZpZXdCb3g6IFwiMCAwIDM2IDM2XCIsXG4gICAgICBmaWxsOiBcIm5vbmVcIixcbiAgICAgIHhtbG5zOiBcImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCJcbiAgICB9LCAvKiNfX1BVUkVfXyovUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChcImNpcmNsZVwiLCB7XG4gICAgICBjeDogXCIxOFwiLFxuICAgICAgY3k6IFwiMThcIixcbiAgICAgIHI6IFwiMThcIixcbiAgICAgIGZpbGw6IFwiIzMzNDE1NVwiXG4gICAgfSksIC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KFwicGF0aFwiLCB7XG4gICAgICBkOiBcIk0yMy44NjQxIDE0LjI4MzZDMjMuODY0MSAxNy4zNTIyIDIxLjQ1NTYgMTkuODM5OSAxOC40ODQ0IDE5LjgzOTlDMTUuNTEzMiAxOS44Mzk5IDEzLjEwNDcgMTcuMzUyMiAxMy4xMDQ3IDE0LjI4MzZDMTMuMTA0NyAxMS4yMTUgMTUuNTEzMiA4LjcyNzU0IDE4LjQ4NDQgOC43Mjc1NEMyMS40NTU2IDguNzI3NTQgMjMuODY0MSAxMS4yMTUgMjMuODY0MSAxNC4yODM2WlwiLFxuICAgICAgZmlsbDogXCIjOTRBM0I4XCJcbiAgICB9KSwgLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXCJwYXRoXCIsIHtcbiAgICAgIGQ6IFwiTTIzLjg2NDMgMjAuOTMxNkgxMy4xMDUxQzExLjEwMzkgMjAuOTMxNiA5LjM3Njk0IDIyLjA3MzQgOC40NTAyIDIzLjc1QzEwLjYyNzcgMjcuMDc1NCAxNC4zMTI4IDI5LjI2NTkgMTguNDg0OCAyOS4yNjU5QzIyLjY1NjggMjkuMjY1OSAyNi4zNDE4IDI3LjA3NTQgMjguNTE5NSAyMy43NUMyNy41OTEzIDIyLjA3MzQgMjUuODY2IDIwLjkzMTYgMjMuODY0NSAyMC45MzE2SDIzLjg2NDNaXCIsXG4gICAgICBmaWxsOiBcIiM5NEEzQjhcIlxuICAgIH0pKTtcbiAgfVxuICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXCJzdmdcIiwge1xuICAgIHdpZHRoOiBcIjM2XCIsXG4gICAgaGVpZ2h0OiBcIjM2XCIsXG4gICAgdmlld0JveDogXCIwIDAgMzYgMzZcIixcbiAgICBmaWxsOiBcIm5vbmVcIixcbiAgICB4bWxuczogXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiXG4gIH0sIC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KFwiY2lyY2xlXCIsIHtcbiAgICBjeDogXCIxOFwiLFxuICAgIGN5OiBcIjE4XCIsXG4gICAgcjogXCIxOFwiLFxuICAgIGZpbGw6IFwiI0NCRDVFMVwiXG4gIH0pLCAvKiNfX1BVUkVfXyovUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChcInBhdGhcIiwge1xuICAgIGQ6IFwiTTIzLjg2NDEgMTQuMjgzNkMyMy44NjQxIDE3LjM1MjIgMjEuNDU1NiAxOS44Mzk5IDE4LjQ4NDQgMTkuODM5OUMxNS41MTMyIDE5LjgzOTkgMTMuMTA0NyAxNy4zNTIyIDEzLjEwNDcgMTQuMjgzNkMxMy4xMDQ3IDExLjIxNSAxNS41MTMyIDguNzI3NTQgMTguNDg0NCA4LjcyNzU0QzIxLjQ1NTYgOC43Mjc1NCAyMy44NjQxIDExLjIxNSAyMy44NjQxIDE0LjI4MzZaXCIsXG4gICAgZmlsbDogXCJ3aGl0ZVwiXG4gIH0pLCAvKiNfX1BVUkVfXyovUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChcInBhdGhcIiwge1xuICAgIGQ6IFwiTTIzLjg2NDMgMjAuOTMxNkgxMy4xMDUxQzExLjEwMzkgMjAuOTMxNiA5LjM3Njk0IDIyLjA3MzQgOC40NTAyIDIzLjc1QzEwLjYyNzcgMjcuMDc1NCAxNC4zMTI4IDI5LjI2NTkgMTguNDg0OCAyOS4yNjU5QzIyLjY1NjggMjkuMjY1OSAyNi4zNDE4IDI3LjA3NTQgMjguNTE5NSAyMy43NUMyNy41OTEzIDIyLjA3MzQgMjUuODY2IDIwLjkzMTYgMjMuODY0NSAyMC45MzE2SDIzLjg2NDNaXCIsXG4gICAgZmlsbDogXCJ3aGl0ZVwiXG4gIH0pKTtcbn07XG5cbnZhciBNb3JlSWNvbiA9IGZ1bmN0aW9uIE1vcmVJY29uKF9yZWYpIHtcbiAgdmFyIHN0eWxlID0gX3JlZi5zdHlsZTtcbiAgdmFyIGhlaWdodCA9IChzdHlsZSA9PT0gbnVsbCB8fCBzdHlsZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogc3R5bGUuaGVpZ2h0KSB8fCAyMDtcbiAgdmFyIHdpZHRoID0gKHN0eWxlID09PSBudWxsIHx8IHN0eWxlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBzdHlsZS53aWR0aCkgfHwgMjA7XG4gIHZhciBjb2xvciA9IChzdHlsZSA9PT0gbnVsbCB8fCBzdHlsZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogc3R5bGUuY29sb3IpIHx8IGxpZ2h0Q29sb3JzLnNlY29uZGFyeVRleHQ7XG4gIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChcInN2Z1wiLCB7XG4gICAgd2lkdGg6IHdpZHRoLFxuICAgIGhlaWdodDogaGVpZ2h0LFxuICAgIHZpZXdCb3g6IFwiMCAwIDI0IDI0XCIsXG4gICAgZmlsbDogXCJub25lXCIsXG4gICAgeG1sbnM6IFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIlxuICB9LCAvKiNfX1BVUkVfXyovUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChcInBhdGhcIiwge1xuICAgIGQ6IFwiTTEyIDEzQzEyLjU1MjMgMTMgMTMgMTIuNTUyMyAxMyAxMkMxMyAxMS40NDc3IDEyLjU1MjMgMTEgMTIgMTFDMTEuNDQ3NyAxMSAxMSAxMS40NDc3IDExIDEyQzExIDEyLjU1MjMgMTEuNDQ3NyAxMyAxMiAxM1pcIixcbiAgICBzdHJva2U6IGNvbG9yLFxuICAgIHN0cm9rZVdpZHRoOiBcIjJcIixcbiAgICBzdHJva2VMaW5lY2FwOiBcInJvdW5kXCIsXG4gICAgc3Ryb2tlTGluZWpvaW46IFwicm91bmRcIlxuICB9KSwgLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXCJwYXRoXCIsIHtcbiAgICBkOiBcIk0xOSAxM0MxOS41NTIzIDEzIDIwIDEyLjU1MjMgMjAgMTJDMjAgMTEuNDQ3NyAxOS41NTIzIDExIDE5IDExQzE4LjQ0NzcgMTEgMTggMTEuNDQ3NyAxOCAxMkMxOCAxMi41NTIzIDE4LjQ0NzcgMTMgMTkgMTNaXCIsXG4gICAgc3Ryb2tlOiBjb2xvcixcbiAgICBzdHJva2VXaWR0aDogXCIyXCIsXG4gICAgc3Ryb2tlTGluZWNhcDogXCJyb3VuZFwiLFxuICAgIHN0cm9rZUxpbmVqb2luOiBcInJvdW5kXCJcbiAgfSksIC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KFwicGF0aFwiLCB7XG4gICAgZDogXCJNNSAxM0M1LjU1MjI4IDEzIDYgMTIuNTUyMyA2IDEyQzYgMTEuNDQ3NyA1LjU1MjI4IDExIDUgMTFDNC40NDc3MiAxMSA0IDExLjQ0NzcgNCAxMkM0IDEyLjU1MjMgNC40NDc3MiAxMyA1IDEzWlwiLFxuICAgIHN0cm9rZTogY29sb3IsXG4gICAgc3Ryb2tlV2lkdGg6IFwiMlwiLFxuICAgIHN0cm9rZUxpbmVjYXA6IFwicm91bmRcIixcbiAgICBzdHJva2VMaW5lam9pbjogXCJyb3VuZFwiXG4gIH0pKTtcbn07XG5cbnZhciBQaW5uZWROb3RpZmljYXRpb25JY29uID0gZnVuY3Rpb24gUGlubmVkTm90aWZpY2F0aW9uSWNvbihfcmVmKSB7XG4gIHZhciBzdHlsZSA9IF9yZWYuc3R5bGU7XG4gIHZhciBoZWlnaHQgPSAoc3R5bGUgPT09IG51bGwgfHwgc3R5bGUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHN0eWxlLmhlaWdodCkgfHwgMTM7XG4gIHZhciB3aWR0aCA9IChzdHlsZSA9PT0gbnVsbCB8fCBzdHlsZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogc3R5bGUud2lkdGgpIHx8IDEzO1xuICB2YXIgY29sb3IgPSAoc3R5bGUgPT09IG51bGwgfHwgc3R5bGUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHN0eWxlLmNvbG9yKSB8fCAnI0RDNjgwMyc7XG4gIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChcInN2Z1wiLCB7XG4gICAgd2lkdGg6IHdpZHRoLFxuICAgIGhlaWdodDogaGVpZ2h0LFxuICAgIHZpZXdCb3g6IFwiMCAwIDE2IDE3XCIsXG4gICAgZmlsbDogXCJub25lXCIsXG4gICAgeG1sbnM6IFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIlxuICB9LCAvKiNfX1BVUkVfXyovUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChcInBhdGhcIiwge1xuICAgIGQ6IFwiTTcuNTg5ODQgMi45MzA1QzcuMzgxOTMgMi40NDUzNiA3LjI3Nzk3IDIuMjAyOCA3LjEwOTk4IDIuMDkyNjFDNi45NjMwOCAxLjk5NjI2IDYuNzg0MDggMS45NjE3OSA2LjYxMTkgMS45OTY2OUM2LjQxNSAyLjAzNjYxIDYuMjI4MzkgMi4yMjMyMSA1Ljg1NTE4IDIuNTk2NDNMMi40MjY0MiA2LjAyNTE5QzIuMDUzMiA2LjM5ODQxIDEuODY2NTkgNi41ODUwMiAxLjgyNjY4IDYuNzgxOTFDMS43OTE3NyA2Ljk1NDA5IDEuODI2MjQgNy4xMzMwOSAxLjkyMjYgNy4yOEMyLjAzMjc4IDcuNDQ3OTkgMi4yNzUzNSA3LjU1MTk0IDIuNzYwNDggNy43NTk4Nkw0LjQyMzM5IDguNDcyNTNDNC40OTM5MyA4LjUwMjc3IDQuNTI5MiA4LjUxNzg4IDQuNTYyMjggOC41MzY3OEM0LjU5MTY2IDguNTUzNTYgNC42MTk3MiA4LjU3MjU2IDQuNjQ2MjIgOC41OTM2MUM0LjY3NjA1IDguNjE3MyA0LjcwMzE4IDguNjQ0NDQgNC43NTc0NSA4LjY5ODcxTDUuNzk4MDUgOS43MzkzQzUuODgyOTMgOS44MjQxOCA1LjkyNTM3IDkuODY2NjIgNS45NTkwOSA5LjkxNDk4QzUuOTg5MDMgOS45NTc5IDYuMDEzOCAxMC4wMDQyIDYuMDMyOTEgMTAuMDUyOUM2LjA1NDQ0IDEwLjEwNzggNi4wNjYyMSAxMC4xNjY2IDYuMDg5NzUgMTAuMjg0NEw2LjU3ODM1IDEyLjcyNzNDNi43MDUzMiAxMy4zNjIyIDYuNzY4ODEgMTMuNjc5NiA2LjkzNjE4IDEzLjgyODFDNy4wODE5OCAxMy45NTc1IDcuMjc3MTEgMTQuMDE2NiA3LjQ3MDE5IDEzLjk4OThDNy42OTE4MyAxMy45NTkxIDcuOTIwNzQgMTMuNzMwMiA4LjM3ODU1IDEzLjI3MjRMMTMuMTAyNCA4LjU0ODU2QzEzLjU2MDIgOC4wOTA3NSAxMy43ODkxIDcuODYxODUgMTMuODE5OCA3LjY0MDIxQzEzLjg0NjYgNy40NDcxMyAxMy43ODc1IDcuMjUyIDEzLjY1ODEgNy4xMDYxOUMxMy41MDk2IDYuOTM4ODIgMTMuMTkyMiA2Ljg3NTM0IDEyLjU1NzMgNi43NDgzNkwxMC4xMTQzIDYuMjU5NzdDOS45OTY2MyA2LjIzNjIyIDkuOTM3NzcgNi4yMjQ0NSA5Ljg4Mjg5IDYuMjAyOTNDOS44MzQxOCA2LjE4MzgyIDkuNzg3ODggNi4xNTkwNCA5Ljc0NDk2IDYuMTI5MTFDOS42OTY2MSA2LjA5NTM4IDkuNjU0MTYgNi4wNTI5NCA5LjU2OTI4IDUuOTY4MDZMOC41Mjg2OSA0LjkyNzQ3QzguNDc0NDIgNC44NzMyIDguNDQ3MjkgNC44NDYwNiA4LjQyMzU5IDQuODE2MjRDOC40MDI1NSA0Ljc4OTc0IDguMzgzNTUgNC43NjE2OCA4LjM2Njc2IDQuNzMyMjlDOC4zNDc4NyA0LjY5OTIyIDguMzMyNzUgNC42NjM5NSA4LjMwMjUyIDQuNTkzNEw3LjU4OTg0IDIuOTMwNVpcIixcbiAgICBmaWxsOiBjb2xvclxuICB9KSwgLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXCJwYXRoXCIsIHtcbiAgICBkOiBcIk0xMC43NDA1IDEwLjkxMDVMMTQuNTExNyAxNC42ODE3TTguNTI4NjkgNC45Mjc0N0w5LjU2OTI4IDUuOTY4MDZDOS42NTQxNiA2LjA1Mjk0IDkuNjk2NjEgNi4wOTUzOCA5Ljc0NDk2IDYuMTI5MTFDOS43ODc4OCA2LjE1OTA0IDkuODM0MTggNi4xODM4MiA5Ljg4Mjg5IDYuMjAyOTNDOS45Mzc3NyA2LjIyNDQ1IDkuOTk2NjMgNi4yMzYyMiAxMC4xMTQzIDYuMjU5NzdMMTIuNTU3MyA2Ljc0ODM2QzEzLjE5MjIgNi44NzUzNCAxMy41MDk2IDYuOTM4ODIgMTMuNjU4MSA3LjEwNjE5QzEzLjc4NzUgNy4yNTIgMTMuODQ2NiA3LjQ0NzEzIDEzLjgxOTggNy42NDAyMUMxMy43ODkxIDcuODYxODUgMTMuNTYwMiA4LjA5MDc1IDEzLjEwMjQgOC41NDg1Nkw4LjM3ODU1IDEzLjI3MjRDNy45MjA3NCAxMy43MzAyIDcuNjkxODMgMTMuOTU5MSA3LjQ3MDE5IDEzLjk4OThDNy4yNzcxMSAxNC4wMTY2IDcuMDgxOTggMTMuOTU3NSA2LjkzNjE4IDEzLjgyODFDNi43Njg4MSAxMy42Nzk2IDYuNzA1MzIgMTMuMzYyMiA2LjU3ODM1IDEyLjcyNzNMNi4wODk3NSAxMC4yODQ0QzYuMDY2MjEgMTAuMTY2NiA2LjA1NDQ0IDEwLjEwNzggNi4wMzI5MSAxMC4wNTI5QzYuMDEzOCAxMC4wMDQyIDUuOTg5MDMgOS45NTc5IDUuOTU5MDkgOS45MTQ5OEM1LjkyNTM3IDkuODY2NjIgNS44ODI5MyA5LjgyNDE4IDUuNzk4MDUgOS43MzkzTDQuNzU3NDUgOC42OTg3MUM0LjcwMzE4IDguNjQ0NDQgNC42NzYwNSA4LjYxNzMgNC42NDYyMiA4LjU5MzYxQzQuNjE5NzIgOC41NzI1NiA0LjU5MTY2IDguNTUzNTYgNC41NjIyOCA4LjUzNjc4QzQuNTI5MiA4LjUxNzg4IDQuNDkzOTMgOC41MDI3NyA0LjQyMzM5IDguNDcyNTNMMi43NjA0OCA3Ljc1OTg2QzIuMjc1MzUgNy41NTE5NCAyLjAzMjc4IDcuNDQ3OTkgMS45MjI2IDcuMjhDMS44MjYyNCA3LjEzMzA5IDEuNzkxNzcgNi45NTQwOSAxLjgyNjY4IDYuNzgxOTFDMS44NjY1OSA2LjU4NTAyIDIuMDUzMiA2LjM5ODQxIDIuNDI2NDIgNi4wMjUxOUw1Ljg1NTE3IDIuNTk2NDNDNi4yMjgzOSAyLjIyMzIxIDYuNDE1IDIuMDM2NjEgNi42MTE5IDEuOTk2NjlDNi43ODQwOCAxLjk2MTc5IDYuOTYzMDggMS45OTYyNiA3LjEwOTk4IDIuMDkyNjFDNy4yNzc5NyAyLjIwMjggNy4zODE5MyAyLjQ0NTM2IDcuNTg5ODQgMi45MzA1TDguMzAyNTIgNC41OTM0QzguMzMyNzUgNC42NjM5NSA4LjM0Nzg3IDQuNjk5MjIgOC4zNjY3NiA0LjczMjI5QzguMzgzNTUgNC43NjE2OCA4LjQwMjU1IDQuNzg5NzQgOC40MjM1OSA0LjgxNjI0QzguNDQ3MjkgNC44NDYwNiA4LjQ3NDQyIDQuODczMiA4LjUyODY5IDQuOTI3NDdaXCIsXG4gICAgc3Ryb2tlOiBjb2xvcixcbiAgICBzdHJva2VXaWR0aDogXCIxLjMzMzMzXCIsXG4gICAgc3Ryb2tlTGluZWNhcDogXCJyb3VuZFwiLFxuICAgIHN0cm9rZUxpbmVqb2luOiBcInJvdW5kXCJcbiAgfSkpO1xufTtcblxudmFyIFVuUmVhZEljb24gPSBmdW5jdGlvbiBVblJlYWRJY29uKF9yZWYpIHtcbiAgdmFyIHN0eWxlID0gX3JlZi5zdHlsZTtcbiAgdmFyIGhlaWdodCA9IChzdHlsZSA9PT0gbnVsbCB8fCBzdHlsZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogc3R5bGUuaGVpZ2h0KSB8fCAxNjtcbiAgdmFyIHdpZHRoID0gKHN0eWxlID09PSBudWxsIHx8IHN0eWxlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBzdHlsZS53aWR0aCkgfHwgMTY7XG4gIHZhciBjb2xvciA9IChzdHlsZSA9PT0gbnVsbCB8fCBzdHlsZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogc3R5bGUuY29sb3IpIHx8IGxpZ2h0Q29sb3JzLnByaW1hcnlUZXh0O1xuICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXCJzdmdcIiwge1xuICAgIHdpZHRoOiB3aWR0aCxcbiAgICBoZWlnaHQ6IGhlaWdodCxcbiAgICB2aWV3Qm94OiBcIjAgMCAyNCAyNFwiLFxuICAgIGZpbGw6IFwibm9uZVwiLFxuICAgIHhtbG5zOiBcImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCJcbiAgfSwgLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXCJwYXRoXCIsIHtcbiAgICBmaWxsUnVsZTogXCJldmVub2RkXCIsXG4gICAgY2xpcFJ1bGU6IFwiZXZlbm9kZFwiLFxuICAgIGQ6IFwiTTE0LjQxNiAzSDQuMDAwMTNDMi4zNDMyNyAzIDEuMDAwMTMgNC4zNDMxNSAxLjAwMDEzIDZWNi45ODMxM0MwLjk5OTk1OCA2Ljk5Mzc1IDAuOTk5OTU4IDcuMDA0MzcgMS4wMDAxMyA3LjAxNDk5VjE4QzEuMDAwMTMgMTkuNjU2OSAyLjM0MzI3IDIxIDQuMDAwMTMgMjFIMjAuMDAwMUMyMS42NTcgMjEgMjMuMDAwMSAxOS42NTY5IDIzLjAwMDEgMThWOS4yMTA3OEgyMS4wMDAxVjE4QzIxLjAwMDEgMTguNTUyMyAyMC41NTI0IDE5IDIwLjAwMDEgMTlINC4wMDAxM0MzLjQ0Nzg0IDE5IDMuMDAwMTMgMTguNTUyMyAzLjAwMDEzIDE4VjguODIwMjdMMTAuNDMzOCAxMy41NDRMMTAuNDM5MiAxMy41NDc0QzEwLjkwNzEgMTMuODQwNSAxMS40NDggMTMuOTk2IDEyLjAwMDEgMTMuOTk2QzEyLjU1MjIgMTMuOTk2IDEzLjA5MzIgMTMuODQwNSAxMy41NjExIDEzLjU0NzRMMTMuNTY2NSAxMy41NDRMMTkuNSA5LjIxMDc4SDE2LjVMMTIuNDk5MiAxMS44NTI2TDEyLjQ5NyAxMS44NTRDMTIuMzQ3OSAxMS45NDY4IDEyLjE3NTggMTEuOTk2IDEyLjAwMDEgMTEuOTk2QzExLjgyNDUgMTEuOTk2IDExLjY1MjQgMTEuOTQ2OCAxMS41MDMzIDExLjg1NEwzLjAwMDEzIDYuNDUwNjNWNkMzLjAwMDEzIDUuNDQ3NzIgMy40NDc4NCA1IDQuMDAwMTMgNUgxNC40MTZWM1pcIixcbiAgICBmaWxsOiBjb2xvclxuICB9KSwgLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXCJjaXJjbGVcIiwge1xuICAgIGN4OiBcIjIwXCIsXG4gICAgY3k6IFwiNFwiLFxuICAgIHI6IFwiNFwiLFxuICAgIGZpbGw6IGNvbG9yXG4gIH0pKTtcbn07XG5cbnZhciBSZWFkSWNvbiA9IGZ1bmN0aW9uIFJlYWRJY29uKF9yZWYpIHtcbiAgdmFyIHN0eWxlID0gX3JlZi5zdHlsZTtcbiAgdmFyIGhlaWdodCA9IChzdHlsZSA9PT0gbnVsbCB8fCBzdHlsZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogc3R5bGUuaGVpZ2h0KSB8fCAxNjtcbiAgdmFyIHdpZHRoID0gKHN0eWxlID09PSBudWxsIHx8IHN0eWxlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBzdHlsZS53aWR0aCkgfHwgMTY7XG4gIHZhciBjb2xvciA9IChzdHlsZSA9PT0gbnVsbCB8fCBzdHlsZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogc3R5bGUuY29sb3IpIHx8IGxpZ2h0Q29sb3JzLnByaW1hcnlUZXh0O1xuICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXCJzdmdcIiwge1xuICAgIHdpZHRoOiB3aWR0aCxcbiAgICBoZWlnaHQ6IGhlaWdodCxcbiAgICB2aWV3Qm94OiBcIjAgMCAxNiAxN1wiLFxuICAgIGZpbGw6IFwibm9uZVwiLFxuICAgIHhtbG5zOiBcImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCJcbiAgfSwgLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXCJwYXRoXCIsIHtcbiAgICBkOiBcIk0xNC4xMzM0IDYuMjY0NzFDMTQuNDY2NyA2LjUxODA1IDE0LjY2NjcgNi45MTEzOCAxNC42NjY3IDcuMzMxMzhWMTMuOTk4QzE0LjY2NjcgMTQuMzUxNyAxNC41MjYyIDE0LjY5MDggMTQuMjc2MiAxNC45NDA5QzE0LjAyNjEgMTUuMTkwOSAxMy42ODcgMTUuMzMxNCAxMy4zMzM0IDE1LjMzMTRIMi42NjY3MUMyLjMxMzA5IDE1LjMzMTQgMS45NzM5NSAxNS4xOTA5IDEuNzIzOSAxNC45NDA5QzEuNDczODUgMTQuNjkwOCAxLjMzMzM3IDE0LjM1MTcgMS4zMzMzNyAxMy45OThWNy4zMzEzOEMxLjMzMzM3IDcuMTI0MzkgMS4zODE1NyA2LjkyMDI0IDEuNDc0MTQgNi43MzUxQzEuNTY2NzEgNi41NDk5NSAxLjcwMTExIDYuMzg4OTEgMS44NjY3MSA2LjI2NDcxTDcuMjAwMDQgMi4yNjQ3MUM3LjQzMDg0IDIuMDkxNjIgNy43MTE1NSAxLjk5ODA1IDguMDAwMDQgMS45OTgwNUM4LjI4ODUzIDEuOTk4MDUgOC41NjkyNSAyLjA5MTYyIDguODAwMDQgMi4yNjQ3MUwxNC4xMzM0IDYuMjY0NzFaXCIsXG4gICAgc3Ryb2tlOiBjb2xvcixcbiAgICBzdHJva2VXaWR0aDogXCIxLjMzMzMzXCIsXG4gICAgc3Ryb2tlTGluZWNhcDogXCJyb3VuZFwiLFxuICAgIHN0cm9rZUxpbmVqb2luOiBcInJvdW5kXCJcbiAgfSksIC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KFwicGF0aFwiLCB7XG4gICAgZDogXCJNMTQuNjY2NyA3LjMzMTA1TDguNjg2NjggMTEuMTMxMUM4LjQ4MDg2IDExLjI2IDguMjQyODkgMTEuMzI4NCA4LjAwMDAxIDExLjMyODRDNy43NTcxMyAxMS4zMjg0IDcuNTE5MTYgMTEuMjYgNy4zMTMzNCAxMS4xMzExTDEuMzMzMzQgNy4zMzEwNVwiLFxuICAgIHN0cm9rZTogY29sb3IsXG4gICAgc3Ryb2tlV2lkdGg6IFwiMS4zMzMzM1wiLFxuICAgIHN0cm9rZUxpbmVjYXA6IFwicm91bmRcIixcbiAgICBzdHJva2VMaW5lam9pbjogXCJyb3VuZFwiXG4gIH0pKTtcbn07XG5cbnZhciBBcmNoaXZlSWNvbiA9IGZ1bmN0aW9uIEFyY2hpdmVJY29uKF9yZWYpIHtcbiAgdmFyIHN0eWxlID0gX3JlZi5zdHlsZTtcbiAgdmFyIGhlaWdodCA9IChzdHlsZSA9PT0gbnVsbCB8fCBzdHlsZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogc3R5bGUuaGVpZ2h0KSB8fCAxNztcbiAgdmFyIHdpZHRoID0gKHN0eWxlID09PSBudWxsIHx8IHN0eWxlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBzdHlsZS53aWR0aCkgfHwgMTY7XG4gIHZhciBjb2xvciA9IChzdHlsZSA9PT0gbnVsbCB8fCBzdHlsZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogc3R5bGUuY29sb3IpIHx8IGxpZ2h0Q29sb3JzLnNlY29uZGFyeVRleHQ7XG4gIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChcInN2Z1wiLCB7XG4gICAgd2lkdGg6IHdpZHRoLFxuICAgIGhlaWdodDogaGVpZ2h0LFxuICAgIHZpZXdCb3g6IFwiMCAwIDE2IDE3XCIsXG4gICAgZmlsbDogXCJub25lXCIsXG4gICAgeG1sbnM6IFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIlxuICB9LCAvKiNfX1BVUkVfXyovUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChcInBhdGhcIiwge1xuICAgIGQ6IFwiTTE0IDIuMzM3ODlIMS45OTk5OEMxLjYzMTc5IDIuMzM3ODkgMS4zMzMzMSAyLjYzNjM3IDEuMzMzMzEgMy4wMDQ1NlY1LjAwNDU2QzEuMzMzMzEgNS4zNzI3NSAxLjYzMTc5IDUuNjcxMjIgMS45OTk5OCA1LjY3MTIySDE0QzE0LjM2ODIgNS42NzEyMiAxNC42NjY2IDUuMzcyNzUgMTQuNjY2NiA1LjAwNDU2VjMuMDA0NTZDMTQuNjY2NiAyLjYzNjM3IDE0LjM2ODIgMi4zMzc4OSAxNCAyLjMzNzg5WlwiLFxuICAgIHN0cm9rZTogY29sb3IsXG4gICAgc3Ryb2tlV2lkdGg6IFwiMS4zMzMzM1wiLFxuICAgIHN0cm9rZUxpbmVjYXA6IFwicm91bmRcIixcbiAgICBzdHJva2VMaW5lam9pbjogXCJyb3VuZFwiXG4gIH0pLCAvKiNfX1BVUkVfXyovUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChcInBhdGhcIiwge1xuICAgIGQ6IFwiTTIuNjY2NjkgNS42NzE4OFYxMy4wMDUyQzIuNjY2NjkgMTMuMzU4OCAyLjgwNzE2IDEzLjY5OCAzLjA1NzIxIDEzLjk0OEMzLjMwNzI2IDE0LjE5ODEgMy42NDY0IDE0LjMzODUgNC4wMDAwMiAxNC4zMzg1SDEyQzEyLjM1MzYgMTQuMzM4NSAxMi42OTI4IDE0LjE5ODEgMTIuOTQyOCAxMy45NDhDMTMuMTkyOSAxMy42OTggMTMuMzMzNCAxMy4zNTg4IDEzLjMzMzQgMTMuMDA1MlY1LjY3MTg4XCIsXG4gICAgc3Ryb2tlOiBjb2xvcixcbiAgICBzdHJva2VXaWR0aDogXCIxLjMzMzMzXCIsXG4gICAgc3Ryb2tlTGluZWNhcDogXCJyb3VuZFwiLFxuICAgIHN0cm9rZUxpbmVqb2luOiBcInJvdW5kXCJcbiAgfSksIC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KFwicGF0aFwiLCB7XG4gICAgZDogXCJNNi42NjY2OSA4LjMzNzg5SDkuMzMzMzVcIixcbiAgICBzdHJva2U6IGNvbG9yLFxuICAgIHN0cm9rZVdpZHRoOiBcIjEuMzMzMzNcIixcbiAgICBzdHJva2VMaW5lY2FwOiBcInJvdW5kXCIsXG4gICAgc3Ryb2tlTGluZWpvaW46IFwicm91bmRcIlxuICB9KSk7XG59O1xuXG52YXIgX3RlbXBsYXRlT2JqZWN0JDIsIF90ZW1wbGF0ZU9iamVjdDIkMSwgX3RlbXBsYXRlT2JqZWN0MyQxLCBfdGVtcGxhdGVPYmplY3Q0LCBfdGVtcGxhdGVPYmplY3Q1LCBfdGVtcGxhdGVPYmplY3Q2LCBfdGVtcGxhdGVPYmplY3Q3LCBfdGVtcGxhdGVPYmplY3Q4LCBfdGVtcGxhdGVPYmplY3Q5LCBfdGVtcGxhdGVPYmplY3QxMCwgX3RlbXBsYXRlT2JqZWN0MTEsIF90ZW1wbGF0ZU9iamVjdDEyLCBfdGVtcGxhdGVPYmplY3QxMywgX3RlbXBsYXRlT2JqZWN0MTQsIF90ZW1wbGF0ZU9iamVjdDE1LCBfdGVtcGxhdGVPYmplY3QxNiwgX3RlbXBsYXRlT2JqZWN0MTcsIF90ZW1wbGF0ZU9iamVjdDE4LCBfdGVtcGxhdGVPYmplY3QxOSwgX3RlbXBsYXRlT2JqZWN0MjAsIF90ZW1wbGF0ZU9iamVjdDIxLCBfdGVtcGxhdGVPYmplY3QyMiwgX3RlbXBsYXRlT2JqZWN0MjMsIF90ZW1wbGF0ZU9iamVjdDI0LCBfdGVtcGxhdGVPYmplY3QyNSwgX3RlbXBsYXRlT2JqZWN0MjYsIF90ZW1wbGF0ZU9iamVjdDI3O1xuZnVuY3Rpb24gRXhwaXJ5VGltZShfcmVmKSB7XG4gIHZhciBkYXRlSW5wdXQgPSBfcmVmLmRhdGVJbnB1dCxcbiAgICBzdHlsZSA9IF9yZWYuc3R5bGU7XG4gIHZhciBkYXRlID0gZGF0ZUlucHV0O1xuICB2YXIgX3VzZVN0YXRlID0gUmVhY3QudXNlU3RhdGUoRGF0ZS5ub3coKSksXG4gICAgc2V0VGltZSA9IF91c2VTdGF0ZVsxXTtcbiAgUmVhY3QudXNlRWZmZWN0KGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gc2V0VGltZShEYXRlLm5vdygpKTtcbiAgICB9LCAxMDAwMCk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgIGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWwpO1xuICAgIH07XG4gIH0sIFtdKTtcbiAgdmFyIGlzRXhwaXJpbmcgPSBkYXRlIC0gRGF0ZS5ub3coKSA8PSAzNjAwMDAwO1xuICB2YXIgZXhwaXJlZEFscmVhZHkgPSBEYXRlLm5vdygpID49IGRhdGU7XG4gIGlmICh0eXBlb2YgZGF0ZUlucHV0ID09PSAnbnVtYmVyJykge1xuICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChcImRpdlwiLCBudWxsLCAvKiNfX1BVUkVfXyovUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChFeHBpcmVzVGV4dCwge1xuICAgICAgc3R5bGU6IF9leHRlbmRzKHt9LCBzdHlsZSwge1xuICAgICAgICBjb2xvcjogaXNFeHBpcmluZyA/IChzdHlsZSA9PT0gbnVsbCB8fCBzdHlsZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogc3R5bGUuZXhwaXJpbmdDb2xvcikgfHwgbGlnaHRDb2xvcnMuZXJyb3IgOiAoc3R5bGUgPT09IG51bGwgfHwgc3R5bGUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHN0eWxlLmNvbG9yKSB8fCBsaWdodENvbG9ycy5zZWNvbmRhcnlUZXh0LFxuICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IGlzRXhwaXJpbmcgPyAoc3R5bGUgPT09IG51bGwgfHwgc3R5bGUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHN0eWxlLmV4cGlyaW5nQmFja2dyb3VuZENvbG9yKSB8fCAncmdiYSgyMTcsIDQ1LCAzMiwgMC4wOSknIDogKHN0eWxlID09PSBudWxsIHx8IHN0eWxlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBzdHlsZS5iYWNrZ3JvdW5kQ29sb3IpIHx8ICdyZ2JhKDEwMCwgMTE2LCAxMzksIDAuMDkpJ1xuICAgICAgfSlcbiAgICB9LCBcIkV4cGlyZXMgaW5cIiwgJyAnLCBleHBpcmVkQWxyZWFkeSA/ICdhIG1pbnV0ZScgOiAvKiNfX1BVUkVfXyovUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChUaW1lQWdvLCB7XG4gICAgICBkYXRlOiBkYXRlLFxuICAgICAgbGl2ZTogZmFsc2UsXG4gICAgICBmb3JtYXR0ZXI6IGdldExvbmdGb3JtYXR0ZWRUaW1lXG4gICAgfSkpKTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuZnVuY3Rpb24gTm90aWZpY2F0aW9uKF9yZWYyKSB7XG4gIHZhciBfbm90aWZpY2F0aW9uJGJvZHlUZXgsIF9ub3RpZmljYXRpb24kYm9keVRleDIsIF9tZXNzYWdlJGFjdGlvbnMsIF9tZXNzYWdlJGFjdGlvbnMyLCBfbWVzc2FnZSRhdmF0YXIyLCBfbWVzc2FnZSR0ZXh0LCBfbWVzc2FnZSR0ZXh0JHJlcGxhY2UsIF9tZXNzYWdlJHRleHQkcmVwbGFjZTIsIF9tZXNzYWdlJHN1YnRleHQsIF9tZXNzYWdlJHN1YnRleHQyLCBfbm90aWZpY2F0aW9uJGFjdGlvbnMsIF9ub3RpZmljYXRpb24kYWN0aW9uczIsIF9ub3RpZmljYXRpb24kYWN0aW9uczMsIF9ub3RpZmljYXRpb24kYWN0aW9uczQsIF9ub3RpZmljYXRpb24kYWN0aW9uczUsIF9ub3RpZmljYXRpb24kYWN0aW9uczYsIF9ub3RpZmljYXRpb24kYWN0aW9uczcsIF9ub3RpZmljYXRpb24kYWN0aW9uczgsIF9ub3RpZmljYXRpb24kYWN0aW9uczk7XG4gIHZhciBub3RpZmljYXRpb25EYXRhID0gX3JlZjIubm90aWZpY2F0aW9uRGF0YSxcbiAgICBoYW5kbGVBY3Rpb25DbGljayA9IF9yZWYyLmhhbmRsZUFjdGlvbkNsaWNrO1xuICB2YXIgX3VzZVN0YXRlMiA9IFJlYWN0LnVzZVN0YXRlKGZhbHNlKSxcbiAgICB2YWxpZEF2YXRhciA9IF91c2VTdGF0ZTJbMF0sXG4gICAgc2V0VmFsaWRBdmF0YXIgPSBfdXNlU3RhdGUyWzFdO1xuICB2YXIgX3VzZVN0YXRlMyA9IFJlYWN0LnVzZVN0YXRlKGZhbHNlKSxcbiAgICBzaG93TW9yZSA9IF91c2VTdGF0ZTNbMF0sXG4gICAgc2V0U2hvd01vcmUgPSBfdXNlU3RhdGUzWzFdO1xuICB2YXIgX3VzZVN0YXRlNCA9IFJlYWN0LnVzZVN0YXRlKGZhbHNlKSxcbiAgICBtb3JlT3BlbiA9IF91c2VTdGF0ZTRbMF0sXG4gICAgc2V0TW9yZU9wZW4gPSBfdXNlU3RhdGU0WzFdO1xuICB2YXIgbWVzc2FnZSA9IG5vdGlmaWNhdGlvbkRhdGEubWVzc2FnZSxcbiAgICBzZWVuT24gPSBub3RpZmljYXRpb25EYXRhLnNlZW5fb24sXG4gICAgY3JlYXRlZE9uID0gbm90aWZpY2F0aW9uRGF0YS5jcmVhdGVkX29uO1xuICB2YXIgX3VzZUluYm94ID0gdXNlSW5ib3goKSxcbiAgICBub3RpZmljYXRpb25Db21wb25lbnQgPSBfdXNlSW5ib3gubm90aWZpY2F0aW9uQ29tcG9uZW50LFxuICAgIGhpZGVBdmF0YXIgPSBfdXNlSW5ib3guaGlkZUF2YXRhcixcbiAgICBpbmJveCA9IF91c2VJbmJveC5pbmJveCxcbiAgICB0aGVtZVR5cGUgPSBfdXNlSW5ib3gudGhlbWVUeXBlO1xuICB2YXIgX3VzZVRoZW1lID0gdXNlVGhlbWUoKSxcbiAgICBub3RpZmljYXRpb24gPSBfdXNlVGhlbWUubm90aWZpY2F0aW9uO1xuICB2YXIgYmxvY2txdW90ZUNvbG9yID0gKG5vdGlmaWNhdGlvbiA9PT0gbnVsbCB8fCBub3RpZmljYXRpb24gPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfbm90aWZpY2F0aW9uJGJvZHlUZXggPSBub3RpZmljYXRpb24uYm9keVRleHQpID09PSBudWxsIHx8IF9ub3RpZmljYXRpb24kYm9keVRleCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX25vdGlmaWNhdGlvbiRib2R5VGV4LmJsb2NrcXVvdGVDb2xvcikgfHwgJ3JnYmEoMTAwLCAxMTYsIDEzOSwgMC4zKSc7XG4gIHZhciBsaW5rQ29sb3IgPSAobm90aWZpY2F0aW9uID09PSBudWxsIHx8IG5vdGlmaWNhdGlvbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9ub3RpZmljYXRpb24kYm9keVRleDIgPSBub3RpZmljYXRpb24uYm9keVRleHQpID09PSBudWxsIHx8IF9ub3RpZmljYXRpb24kYm9keVRleDIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9ub3RpZmljYXRpb24kYm9keVRleDIubGlua0NvbG9yKSB8fCBsaWdodENvbG9ycy5wcmltYXJ5O1xuICB2YXIgYWN0aW9uT25lID0gbWVzc2FnZSA9PT0gbnVsbCB8fCBtZXNzYWdlID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX21lc3NhZ2UkYWN0aW9ucyA9IG1lc3NhZ2UuYWN0aW9ucykgPT09IG51bGwgfHwgX21lc3NhZ2UkYWN0aW9ucyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX21lc3NhZ2UkYWN0aW9uc1swXTtcbiAgdmFyIGFjdGlvblR3byA9IG1lc3NhZ2UgPT09IG51bGwgfHwgbWVzc2FnZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9tZXNzYWdlJGFjdGlvbnMyID0gbWVzc2FnZS5hY3Rpb25zKSA9PT0gbnVsbCB8fCBfbWVzc2FnZSRhY3Rpb25zMiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX21lc3NhZ2UkYWN0aW9uczJbMV07XG4gIHZhciBoYXNCdXR0b25zID0gYWN0aW9uT25lIHx8IGFjdGlvblR3bztcbiAgUmVhY3QudXNlRWZmZWN0KGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgX21lc3NhZ2UkYXZhdGFyO1xuICAgIHZhciBpc1ZhbGlkQXZhdGFyID0gaXNJbWdVcmwobWVzc2FnZSA9PT0gbnVsbCB8fCBtZXNzYWdlID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX21lc3NhZ2UkYXZhdGFyID0gbWVzc2FnZS5hdmF0YXIpID09PSBudWxsIHx8IF9tZXNzYWdlJGF2YXRhciA9PT0gdm9pZCAwID8gdm9pZCAwIDogX21lc3NhZ2UkYXZhdGFyLmF2YXRhcl91cmwpO1xuICAgIGlzVmFsaWRBdmF0YXIudGhlbihmdW5jdGlvbiAocmVzKSB7XG4gICAgICByZXR1cm4gc2V0VmFsaWRBdmF0YXIocmVzKTtcbiAgICB9KTtcbiAgfSwgW25vdGlmaWNhdGlvbkRhdGFdKTtcbiAgaWYgKG5vdGlmaWNhdGlvbkNvbXBvbmVudCkge1xuICAgIHZhciBOb3RpZmljYXRpb25Db21wb25lbnQgPSBub3RpZmljYXRpb25Db21wb25lbnQ7XG4gICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KE5vdGlmaWNhdGlvbkNvbXBvbmVudCwge1xuICAgICAgbm90aWZpY2F0aW9uRGF0YTogbm90aWZpY2F0aW9uRGF0YVxuICAgIH0pO1xuICB9XG4gIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChDb250YWluZXIsIHtcbiAgICBzdHlsZTogbm90aWZpY2F0aW9uID09PSBudWxsIHx8IG5vdGlmaWNhdGlvbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogbm90aWZpY2F0aW9uLmNvbnRhaW5lcixcbiAgICByZWFkOiAhIXNlZW5PbixcbiAgICBvbk1vdXNlRW50ZXI6IGZ1bmN0aW9uIG9uTW91c2VFbnRlcigpIHtcbiAgICAgIHNldFNob3dNb3JlKHRydWUpO1xuICAgICAgc2V0TW9yZU9wZW4oZmFsc2UpO1xuICAgIH0sXG4gICAgb25Nb3VzZUxlYXZlOiBmdW5jdGlvbiBvbk1vdXNlTGVhdmUoKSB7XG4gICAgICBzZXRTaG93TW9yZShmYWxzZSk7XG4gICAgICBzZXRNb3JlT3BlbihmYWxzZSk7XG4gICAgfSxcbiAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKGUpIHtcbiAgICAgIGlmIChtb3JlT3Blbikge1xuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICBzZXRNb3JlT3BlbihmYWxzZSk7XG4gICAgICB9XG4gICAgfVxuICB9LCBub3RpZmljYXRpb25EYXRhLmlzX3Bpbm5lZCAmJiAvKiNfX1BVUkVfXyovUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChQaW5uZWRWaWV3LCB7XG4gICAgaGlkZUF2YXRhcjogaGlkZUF2YXRhclxuICB9LCAvKiNfX1BVUkVfXyovUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChQaW5uZWROb3RpZmljYXRpb25JY29uLCB7XG4gICAgc3R5bGU6IG5vdGlmaWNhdGlvbiA9PT0gbnVsbCB8fCBub3RpZmljYXRpb24gPT09IHZvaWQgMCA/IHZvaWQgMCA6IG5vdGlmaWNhdGlvbi5waW5uZWRJY29uXG4gIH0pLCAvKiNfX1BVUkVfXyovUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChQaW5uZWROb3RpZmljYXRpb25UZXh0LCB7XG4gICAgc3R5bGU6IG5vdGlmaWNhdGlvbiA9PT0gbnVsbCB8fCBub3RpZmljYXRpb24gPT09IHZvaWQgMCA/IHZvaWQgMCA6IG5vdGlmaWNhdGlvbi5waW5uZWRUZXh0XG4gIH0sIFwiUGlubmVkXCIpKSwgLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoTm90aWZpY2F0aW9uVmlldywgbnVsbCwgLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoTGVmdFZpZXcsIG51bGwsIC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KExlZnRBdmF0YXJWaWV3LCBudWxsLCAvKiNfX1BVUkVfXyovUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChVbnNlZW5Eb3QsIHtcbiAgICBzdHlsZTogbm90aWZpY2F0aW9uID09PSBudWxsIHx8IG5vdGlmaWNhdGlvbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogbm90aWZpY2F0aW9uLnVuc2VlbkRvdCxcbiAgICBzaG93OiAhc2Vlbk9uXG4gIH0pLCAhaGlkZUF2YXRhciAmJiAvKiNfX1BVUkVfXyovUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChBdmF0YXJWaWV3LCB7XG4gICAgb25DbGljazogZnVuY3Rpb24gb25DbGljayhlKSB7XG4gICAgICB2YXIgYXZhdGFyRGF0YSA9IG1lc3NhZ2UgPT09IG51bGwgfHwgbWVzc2FnZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogbWVzc2FnZS5hdmF0YXI7XG4gICAgICBoYW5kbGVBY3Rpb25DbGljayhlLCB7XG4gICAgICAgIHR5cGU6ICdhdmF0YXInLFxuICAgICAgICB1cmw6IGF2YXRhckRhdGEgPT09IG51bGwgfHwgYXZhdGFyRGF0YSA9PT0gdm9pZCAwID8gdm9pZCAwIDogYXZhdGFyRGF0YS5hY3Rpb25fdXJsLFxuICAgICAgICB0YXJnZXQ6IGF2YXRhckRhdGEgPT09IG51bGwgfHwgYXZhdGFyRGF0YSA9PT0gdm9pZCAwID8gdm9pZCAwIDogYXZhdGFyRGF0YS5vcGVuX2luX25ld190YWJcbiAgICAgIH0pO1xuICAgIH1cbiAgfSwgbWVzc2FnZSAhPT0gbnVsbCAmJiBtZXNzYWdlICE9PSB2b2lkIDAgJiYgKF9tZXNzYWdlJGF2YXRhcjIgPSBtZXNzYWdlLmF2YXRhcikgIT09IG51bGwgJiYgX21lc3NhZ2UkYXZhdGFyMiAhPT0gdm9pZCAwICYmIF9tZXNzYWdlJGF2YXRhcjIuYXZhdGFyX3VybCAmJiB2YWxpZEF2YXRhciA/IC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KEF2YXRhckltYWdlLCB7XG4gICAgc3JjOiBtZXNzYWdlLmF2YXRhci5hdmF0YXJfdXJsLFxuICAgIGFsdDogXCJhdmF0YXJcIixcbiAgICBzdHlsZTogbm90aWZpY2F0aW9uID09PSBudWxsIHx8IG5vdGlmaWNhdGlvbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogbm90aWZpY2F0aW9uLmF2YXRhclxuICB9KSA6IC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KEF2YXRhckljb24sIHtcbiAgICB0eXBlOiB0aGVtZVR5cGVcbiAgfSkpKSwgLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoQ29udGVudFZpZXcsIG51bGwsIG1lc3NhZ2UuaGVhZGVyICYmIC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KEhlYWRlclRleHQsIHtcbiAgICBzdHlsZTogbm90aWZpY2F0aW9uID09PSBudWxsIHx8IG5vdGlmaWNhdGlvbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogbm90aWZpY2F0aW9uLmhlYWRlclRleHRcbiAgfSwgbWVzc2FnZS5oZWFkZXIpLCAvKiNfX1BVUkVfXyovUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChCb2R5VGV4dCwge1xuICAgIHN0eWxlOiBub3RpZmljYXRpb24gPT09IG51bGwgfHwgbm90aWZpY2F0aW9uID09PSB2b2lkIDAgPyB2b2lkIDAgOiBub3RpZmljYXRpb24uYm9keVRleHRcbiAgfSwgLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoTWFya2Rvd24sIHtcbiAgICBjb21wb25lbnRzOiB7XG4gICAgICBhOiBmdW5jdGlvbiBhKF9yZWYzKSB7XG4gICAgICAgIHZhciBjaGlsZHJlbiA9IF9yZWYzLmNoaWxkcmVuLFxuICAgICAgICAgIGhyZWYgPSBfcmVmMy5ocmVmO1xuICAgICAgICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIHtcbiAgICAgICAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKGUpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGhhbmRsZUFjdGlvbkNsaWNrKGUsIHtcbiAgICAgICAgICAgICAgdHlwZTogJ21hcmtkb3duX2xpbmsnLFxuICAgICAgICAgICAgICB1cmw6IGhyZWZcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgc3R5bGU6IHtcbiAgICAgICAgICAgIGNvbG9yOiBsaW5rQ29sb3IsXG4gICAgICAgICAgICB0ZXh0RGVjb3JhdGlvbjogJ25vbmUnXG4gICAgICAgICAgfVxuICAgICAgICB9LCBjaGlsZHJlbik7XG4gICAgICB9LFxuICAgICAgcDogZnVuY3Rpb24gcChfcmVmNCkge1xuICAgICAgICB2YXIgY2hpbGRyZW4gPSBfcmVmNC5jaGlsZHJlbjtcbiAgICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KFwicFwiLCB7XG4gICAgICAgICAgc3R5bGU6IHtcbiAgICAgICAgICAgIG1hcmdpbjogMCxcbiAgICAgICAgICAgIG92ZXJmbG93V3JhcDogJ2FueXdoZXJlJ1xuICAgICAgICAgIH1cbiAgICAgICAgfSwgY2hpbGRyZW4pO1xuICAgICAgfSxcbiAgICAgIGJsb2NrcXVvdGU6IGZ1bmN0aW9uIGJsb2NrcXVvdGUoX3JlZjUpIHtcbiAgICAgICAgdmFyIGNoaWxkcmVuID0gX3JlZjUuY2hpbGRyZW47XG4gICAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChcImJsb2NrcXVvdGVcIiwge1xuICAgICAgICAgIHN0eWxlOiB7XG4gICAgICAgICAgICBtYXJnaW46IDAsXG4gICAgICAgICAgICBwYWRkaW5nTGVmdDogMTAsXG4gICAgICAgICAgICBib3JkZXJMZWZ0OiBcIjNweCBcIiArIGJsb2NrcXVvdGVDb2xvciArIFwiIHNvbGlkXCIsXG4gICAgICAgICAgICBtYXJnaW5Cb3R0b206IDUsXG4gICAgICAgICAgICBtYXJnaW5Ub3A6IDVcbiAgICAgICAgICB9XG4gICAgICAgIH0sIGNoaWxkcmVuKTtcbiAgICAgIH0sXG4gICAgICB1bDogZnVuY3Rpb24gdWwoX3JlZjYpIHtcbiAgICAgICAgdmFyIGNoaWxkcmVuID0gX3JlZjYuY2hpbGRyZW47XG4gICAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChcInVsXCIsIHtcbiAgICAgICAgICBzdHlsZToge1xuICAgICAgICAgICAgd2hpdGVTcGFjZTogJ25vcm1hbCcsXG4gICAgICAgICAgICBtYXJnaW46IDAsXG4gICAgICAgICAgICBwYWRkaW5nTGVmdDogMTBcbiAgICAgICAgICB9XG4gICAgICAgIH0sIGNoaWxkcmVuKTtcbiAgICAgIH0sXG4gICAgICBvbDogZnVuY3Rpb24gb2woX3JlZjcpIHtcbiAgICAgICAgdmFyIGNoaWxkcmVuID0gX3JlZjcuY2hpbGRyZW47XG4gICAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChcIm9sXCIsIHtcbiAgICAgICAgICBzdHlsZToge1xuICAgICAgICAgICAgd2hpdGVTcGFjZTogJ25vcm1hbCcsXG4gICAgICAgICAgICBtYXJnaW46IDAsXG4gICAgICAgICAgICBwYWRkaW5nTGVmdDogMTBcbiAgICAgICAgICB9XG4gICAgICAgIH0sIGNoaWxkcmVuKTtcbiAgICAgIH0sXG4gICAgICBpbWc6IGZ1bmN0aW9uIGltZyhwcm9wcykge1xuICAgICAgICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXCJpbWdcIiwgX2V4dGVuZHMoe1xuICAgICAgICAgIHN0eWxlOiB7XG4gICAgICAgICAgICBtYXhXaWR0aDogJzEwMCUnLFxuICAgICAgICAgICAgb2JqZWN0Rml0OiAnY29udGFpbidcbiAgICAgICAgICB9XG4gICAgICAgIH0sIHByb3BzKSk7XG4gICAgICB9XG4gICAgfVxuICB9LCBtZXNzYWdlID09PSBudWxsIHx8IG1lc3NhZ2UgPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfbWVzc2FnZSR0ZXh0ID0gbWVzc2FnZS50ZXh0KSA9PT0gbnVsbCB8fCBfbWVzc2FnZSR0ZXh0ID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX21lc3NhZ2UkdGV4dCRyZXBsYWNlID0gX21lc3NhZ2UkdGV4dC5yZXBsYWNlQWxsKCdcXFxcXFxuJywgJyZuYnNwOycpKSA9PT0gbnVsbCB8fCBfbWVzc2FnZSR0ZXh0JHJlcGxhY2UgPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfbWVzc2FnZSR0ZXh0JHJlcGxhY2UyID0gX21lc3NhZ2UkdGV4dCRyZXBsYWNlLnJlcGxhY2VBbGwoJ1xcbicsICcgIFxcbicpKSA9PT0gbnVsbCB8fCBfbWVzc2FnZSR0ZXh0JHJlcGxhY2UyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfbWVzc2FnZSR0ZXh0JHJlcGxhY2UyLnJlcGxhY2VBbGwoJyZuYnNwOycsICcmbmJzcDsgIFxcbicpKSksICEhKG1lc3NhZ2UgIT09IG51bGwgJiYgbWVzc2FnZSAhPT0gdm9pZCAwICYmIChfbWVzc2FnZSRzdWJ0ZXh0ID0gbWVzc2FnZS5zdWJ0ZXh0KSAhPT0gbnVsbCAmJiBfbWVzc2FnZSRzdWJ0ZXh0ICE9PSB2b2lkIDAgJiYgX21lc3NhZ2Ukc3VidGV4dC50ZXh0KSAmJiAvKiNfX1BVUkVfXyovUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChTdWJUZXh0Vmlldywge1xuICAgIGxpbms6IG1lc3NhZ2UgPT09IG51bGwgfHwgbWVzc2FnZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9tZXNzYWdlJHN1YnRleHQyID0gbWVzc2FnZS5zdWJ0ZXh0KSA9PT0gbnVsbCB8fCBfbWVzc2FnZSRzdWJ0ZXh0MiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX21lc3NhZ2Ukc3VidGV4dDIuYWN0aW9uX3VybCxcbiAgICBvbkNsaWNrOiBmdW5jdGlvbiBvbkNsaWNrKGUpIHtcbiAgICAgIHZhciBzdWJUZXh0RGF0YSA9IG1lc3NhZ2UgPT09IG51bGwgfHwgbWVzc2FnZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogbWVzc2FnZS5zdWJ0ZXh0O1xuICAgICAgaGFuZGxlQWN0aW9uQ2xpY2soZSwge1xuICAgICAgICB0eXBlOiAnc3VidGV4dCcsXG4gICAgICAgIHVybDogc3ViVGV4dERhdGEgPT09IG51bGwgfHwgc3ViVGV4dERhdGEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHN1YlRleHREYXRhLmFjdGlvbl91cmwsXG4gICAgICAgIHRhcmdldDogc3ViVGV4dERhdGEgPT09IG51bGwgfHwgc3ViVGV4dERhdGEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHN1YlRleHREYXRhLm9wZW5faW5fbmV3X3RhYlxuICAgICAgfSk7XG4gICAgfVxuICB9LCAvKiNfX1BVUkVfXyovUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChTdWJUZXh0LCB7XG4gICAgc3R5bGU6IG5vdGlmaWNhdGlvbiA9PT0gbnVsbCB8fCBub3RpZmljYXRpb24gPT09IHZvaWQgMCA/IHZvaWQgMCA6IG5vdGlmaWNhdGlvbi5zdWJ0ZXh0XG4gIH0sIG1lc3NhZ2Uuc3VidGV4dC50ZXh0KSksIG5vdGlmaWNhdGlvbkRhdGEuZXhwaXJ5ICYmIChub3RpZmljYXRpb25EYXRhID09PSBudWxsIHx8IG5vdGlmaWNhdGlvbkRhdGEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IG5vdGlmaWNhdGlvbkRhdGEuaXNfZXhwaXJ5X3Zpc2libGUpICYmIC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KEV4cGlyeVRpbWUsIHtcbiAgICBkYXRlSW5wdXQ6IG5vdGlmaWNhdGlvbkRhdGEuZXhwaXJ5LFxuICAgIHN0eWxlOiBub3RpZmljYXRpb24gPT09IG51bGwgfHwgbm90aWZpY2F0aW9uID09PSB2b2lkIDAgPyB2b2lkIDAgOiBub3RpZmljYXRpb24uZXhwaXJlc1RleHRcbiAgfSksIGhhc0J1dHRvbnMgJiYgLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoQnV0dG9uQ29udGFpbmVyLCBudWxsLCBhY3Rpb25PbmUgJiYgLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoQnV0dG9uVmlldywge1xuICAgIHN0eWxlOiBub3RpZmljYXRpb24gPT09IG51bGwgfHwgbm90aWZpY2F0aW9uID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX25vdGlmaWNhdGlvbiRhY3Rpb25zID0gbm90aWZpY2F0aW9uLmFjdGlvbnMpID09PSBudWxsIHx8IF9ub3RpZmljYXRpb24kYWN0aW9ucyA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9ub3RpZmljYXRpb24kYWN0aW9uczIgPSBfbm90aWZpY2F0aW9uJGFjdGlvbnNbMF0pID09PSBudWxsIHx8IF9ub3RpZmljYXRpb24kYWN0aW9uczIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9ub3RpZmljYXRpb24kYWN0aW9uczIuY29udGFpbmVyLFxuICAgIGtleTogYWN0aW9uT25lLmlkLFxuICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soZSkge1xuICAgICAgaGFuZGxlQWN0aW9uQ2xpY2soZSwge1xuICAgICAgICB0eXBlOiAnYWN0aW9uX2J1dHRvbicsXG4gICAgICAgIHVybDogYWN0aW9uT25lLnVybCxcbiAgICAgICAgdGFyZ2V0OiBhY3Rpb25PbmUub3Blbl9pbl9uZXdfdGFiXG4gICAgICB9KTtcbiAgICB9XG4gIH0sIC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KEJ1dHRvblRleHQsIHtcbiAgICBzdHlsZTogbm90aWZpY2F0aW9uID09PSBudWxsIHx8IG5vdGlmaWNhdGlvbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9ub3RpZmljYXRpb24kYWN0aW9uczMgPSBub3RpZmljYXRpb24uYWN0aW9ucykgPT09IG51bGwgfHwgX25vdGlmaWNhdGlvbiRhY3Rpb25zMyA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9ub3RpZmljYXRpb24kYWN0aW9uczQgPSBfbm90aWZpY2F0aW9uJGFjdGlvbnMzWzBdKSA9PT0gbnVsbCB8fCBfbm90aWZpY2F0aW9uJGFjdGlvbnM0ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfbm90aWZpY2F0aW9uJGFjdGlvbnM0LnRleHRcbiAgfSwgYWN0aW9uT25lLm5hbWUpKSwgYWN0aW9uVHdvICYmIC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KEJ1dHRvbk91dGxpbmVWaWV3LCB7XG4gICAga2V5OiBhY3Rpb25Ud28uaWQsXG4gICAgc3R5bGU6IG5vdGlmaWNhdGlvbiA9PT0gbnVsbCB8fCBub3RpZmljYXRpb24gPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfbm90aWZpY2F0aW9uJGFjdGlvbnM1ID0gbm90aWZpY2F0aW9uLmFjdGlvbnMpID09PSBudWxsIHx8IF9ub3RpZmljYXRpb24kYWN0aW9uczUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfbm90aWZpY2F0aW9uJGFjdGlvbnM2ID0gX25vdGlmaWNhdGlvbiRhY3Rpb25zNVsxXSkgPT09IG51bGwgfHwgX25vdGlmaWNhdGlvbiRhY3Rpb25zNiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX25vdGlmaWNhdGlvbiRhY3Rpb25zNi5jb250YWluZXIsXG4gICAgb25DbGljazogZnVuY3Rpb24gb25DbGljayhlKSB7XG4gICAgICBoYW5kbGVBY3Rpb25DbGljayhlLCB7XG4gICAgICAgIHR5cGU6ICdhY3Rpb25fYnV0dG9uJyxcbiAgICAgICAgdXJsOiBhY3Rpb25Ud28udXJsLFxuICAgICAgICB0YXJnZXQ6IGFjdGlvblR3by5vcGVuX2luX25ld190YWJcbiAgICAgIH0pO1xuICAgIH1cbiAgfSwgLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoQnV0dG9uT3V0bGluZVRleHQsIHtcbiAgICBzdHlsZTogbm90aWZpY2F0aW9uID09PSBudWxsIHx8IG5vdGlmaWNhdGlvbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9ub3RpZmljYXRpb24kYWN0aW9uczcgPSBub3RpZmljYXRpb24uYWN0aW9ucykgPT09IG51bGwgfHwgX25vdGlmaWNhdGlvbiRhY3Rpb25zNyA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9ub3RpZmljYXRpb24kYWN0aW9uczggPSBfbm90aWZpY2F0aW9uJGFjdGlvbnM3WzFdKSA9PT0gbnVsbCB8fCBfbm90aWZpY2F0aW9uJGFjdGlvbnM4ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfbm90aWZpY2F0aW9uJGFjdGlvbnM4LnRleHRcbiAgfSwgYWN0aW9uVHdvLm5hbWUpKSkpKSwgLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoUmlnaHRWaWV3LCBudWxsLCAvKiNfX1BVUkVfXyovUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChDcmVhdGVkVGV4dCwge1xuICAgIHN0eWxlOiBub3RpZmljYXRpb24gPT09IG51bGwgfHwgbm90aWZpY2F0aW9uID09PSB2b2lkIDAgPyB2b2lkIDAgOiBub3RpZmljYXRpb24uY3JlYXRlZE9uVGV4dFxuICB9LCAvKiNfX1BVUkVfXyovUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChUaW1lQWdvLCB7XG4gICAgZGF0ZTogY3JlYXRlZE9uLFxuICAgIGxpdmU6IGZhbHNlLFxuICAgIGZvcm1hdHRlcjogZ2V0U2hvcnRGb3JtYXR0ZWRUaW1lXG4gIH0pKSwgLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoQ01lbnVWaWV3LCB7XG4gICAgc2hvd01vcmU6IHNob3dNb3JlXG4gIH0sIC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KENNZW51QnV0dG9uLCB7XG4gICAgaG92ZXJCR0NvbG9yOiBub3RpZmljYXRpb24gPT09IG51bGwgfHwgbm90aWZpY2F0aW9uID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX25vdGlmaWNhdGlvbiRhY3Rpb25zOSA9IG5vdGlmaWNhdGlvbi5hY3Rpb25zTWVudUljb24pID09PSBudWxsIHx8IF9ub3RpZmljYXRpb24kYWN0aW9uczkgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9ub3RpZmljYXRpb24kYWN0aW9uczkuaG92ZXJCYWNrZ3JvdW5kQ29sb3IsXG4gICAgb25DbGljazogZnVuY3Rpb24gb25DbGljayhlKSB7XG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgc2V0TW9yZU9wZW4oZnVuY3Rpb24gKHByZXYpIHtcbiAgICAgICAgcmV0dXJuICFwcmV2O1xuICAgICAgfSk7XG4gICAgfVxuICB9LCAvKiNfX1BVUkVfXyovUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChNb3JlSWNvbiwge1xuICAgIHN0eWxlOiBub3RpZmljYXRpb24gPT09IG51bGwgfHwgbm90aWZpY2F0aW9uID09PSB2b2lkIDAgPyB2b2lkIDAgOiBub3RpZmljYXRpb24uYWN0aW9uc01lbnVJY29uXG4gIH0pKSwgLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoQ01lbnVQb3B1cCwge1xuICAgIG1vcmVPcGVuOiBtb3JlT3BlbixcbiAgICBzdHlsZTogbm90aWZpY2F0aW9uID09PSBudWxsIHx8IG5vdGlmaWNhdGlvbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogbm90aWZpY2F0aW9uLmFjdGlvbnNNZW51XG4gIH0sIG5vdGlmaWNhdGlvbkRhdGEuc2Vlbl9vbiA/IC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KENNZW51SXRlbSwge1xuICAgIHN0eWxlOiBub3RpZmljYXRpb24gPT09IG51bGwgfHwgbm90aWZpY2F0aW9uID09PSB2b2lkIDAgPyB2b2lkIDAgOiBub3RpZmljYXRpb24uYWN0aW9uc01lbnVJdGVtLFxuICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soZSkge1xuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgIGluYm94LmZlZWQubWFya1VuUmVhZChub3RpZmljYXRpb25EYXRhLm5faWQpO1xuICAgICAgc2V0TW9yZU9wZW4oZmFsc2UpO1xuICAgIH1cbiAgfSwgLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoVW5SZWFkSWNvbiwge1xuICAgIHN0eWxlOiBub3RpZmljYXRpb24gPT09IG51bGwgfHwgbm90aWZpY2F0aW9uID09PSB2b2lkIDAgPyB2b2lkIDAgOiBub3RpZmljYXRpb24uYWN0aW9uc01lbnVJdGVtSWNvblxuICB9KSwgLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoQ01lbnVUZXh0LCB7XG4gICAgc3R5bGU6IG5vdGlmaWNhdGlvbiA9PT0gbnVsbCB8fCBub3RpZmljYXRpb24gPT09IHZvaWQgMCA/IHZvaWQgMCA6IG5vdGlmaWNhdGlvbi5hY3Rpb25zTWVudUl0ZW1UZXh0XG4gIH0sIFwiTWFyayBhcyB1bnJlYWRcIikpIDogLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoQ01lbnVJdGVtLCB7XG4gICAgc3R5bGU6IG5vdGlmaWNhdGlvbiA9PT0gbnVsbCB8fCBub3RpZmljYXRpb24gPT09IHZvaWQgMCA/IHZvaWQgMCA6IG5vdGlmaWNhdGlvbi5hY3Rpb25zTWVudUl0ZW0sXG4gICAgb25DbGljazogZnVuY3Rpb24gb25DbGljayhlKSB7XG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgaW5ib3guZmVlZC5tYXJrUmVhZChub3RpZmljYXRpb25EYXRhLm5faWQpO1xuICAgICAgc2V0TW9yZU9wZW4oZmFsc2UpO1xuICAgIH1cbiAgfSwgLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoUmVhZEljb24sIHtcbiAgICBzdHlsZTogbm90aWZpY2F0aW9uID09PSBudWxsIHx8IG5vdGlmaWNhdGlvbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogbm90aWZpY2F0aW9uLmFjdGlvbnNNZW51SXRlbUljb25cbiAgfSksIC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KENNZW51VGV4dCwge1xuICAgIHN0eWxlOiBub3RpZmljYXRpb24gPT09IG51bGwgfHwgbm90aWZpY2F0aW9uID09PSB2b2lkIDAgPyB2b2lkIDAgOiBub3RpZmljYXRpb24uYWN0aW9uc01lbnVJdGVtVGV4dFxuICB9LCBcIk1hcmsgYXMgcmVhZFwiKSksICEobm90aWZpY2F0aW9uRGF0YSAhPT0gbnVsbCAmJiBub3RpZmljYXRpb25EYXRhICE9PSB2b2lkIDAgJiYgbm90aWZpY2F0aW9uRGF0YS5hcmNoaXZlZCkgJiYgLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoQ01lbnVJdGVtLCB7XG4gICAgc3R5bGU6IG5vdGlmaWNhdGlvbiA9PT0gbnVsbCB8fCBub3RpZmljYXRpb24gPT09IHZvaWQgMCA/IHZvaWQgMCA6IG5vdGlmaWNhdGlvbi5hY3Rpb25zTWVudUl0ZW0sXG4gICAgb25DbGljazogZnVuY3Rpb24gb25DbGljayhlKSB7XG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgaW5ib3guZmVlZC5tYXJrQXJjaGl2ZWQobm90aWZpY2F0aW9uRGF0YS5uX2lkKTtcbiAgICB9XG4gIH0sIC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KEFyY2hpdmVJY29uLCB7XG4gICAgc3R5bGU6IG5vdGlmaWNhdGlvbiA9PT0gbnVsbCB8fCBub3RpZmljYXRpb24gPT09IHZvaWQgMCA/IHZvaWQgMCA6IG5vdGlmaWNhdGlvbi5hY3Rpb25zTWVudUl0ZW1JY29uXG4gIH0pLCAvKiNfX1BVUkVfXyovUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChDTWVudVRleHQsIHtcbiAgICBzdHlsZTogbm90aWZpY2F0aW9uID09PSBudWxsIHx8IG5vdGlmaWNhdGlvbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogbm90aWZpY2F0aW9uLmFjdGlvbnNNZW51SXRlbVRleHRcbiAgfSwgXCJBcmNoaXZlXCIpKSkpKSkpO1xufVxudmFyIENvbnRhaW5lciA9IHN0eWxlZC5kaXYoX3RlbXBsYXRlT2JqZWN0JDIgfHwgKF90ZW1wbGF0ZU9iamVjdCQyID0gX3RhZ2dlZFRlbXBsYXRlTGl0ZXJhbExvb3NlKFtcIlxcbiAgcGFkZGluZzogMTZweDtcXG4gIGN1cnNvcjogcG9pbnRlcjtcXG4gIGJhY2tncm91bmQtY29sb3I6IFwiLCBcIjtcXG4gIGJvcmRlci1ib3R0b206IDAuNXB4IHNvbGlkIFwiLCBcIjtcXG4gICY6aG92ZXIge1xcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiBcIiwgXCJcXG5cIl0pKSwgZnVuY3Rpb24gKHByb3BzKSB7XG4gIHZhciBfcHJvcHMkc3R5bGUsIF9wcm9wcyRzdHlsZTI7XG4gIHJldHVybiBwcm9wcy5yZWFkID8gKHByb3BzID09PSBudWxsIHx8IHByb3BzID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX3Byb3BzJHN0eWxlID0gcHJvcHMuc3R5bGUpID09PSBudWxsIHx8IF9wcm9wcyRzdHlsZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3Byb3BzJHN0eWxlLnJlYWRCYWNrZ3JvdW5kQ29sb3IpIHx8IGxpZ2h0Q29sb3JzLm1haW4gOiAocHJvcHMgPT09IG51bGwgfHwgcHJvcHMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfcHJvcHMkc3R5bGUyID0gcHJvcHMuc3R5bGUpID09PSBudWxsIHx8IF9wcm9wcyRzdHlsZTIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9wcm9wcyRzdHlsZTIudW5yZWFkQmFja2dyb3VuZENvbG9yKSB8fCAnI2VkZjNmZic7XG59LCBsaWdodENvbG9ycy5ib3JkZXIsIGZ1bmN0aW9uIChwcm9wcykge1xuICB2YXIgX3Byb3BzJHN0eWxlMztcbiAgcmV0dXJuIChwcm9wcyA9PT0gbnVsbCB8fCBwcm9wcyA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9wcm9wcyRzdHlsZTMgPSBwcm9wcy5zdHlsZSkgPT09IG51bGwgfHwgX3Byb3BzJHN0eWxlMyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3Byb3BzJHN0eWxlMy5ob3ZlckJhY2tncm91bmRDb2xvcikgfHwgJyNEQkU3RkYnO1xufSk7XG52YXIgUGlubmVkVmlldyA9IHN0eWxlZC5kaXYoX3RlbXBsYXRlT2JqZWN0MiQxIHx8IChfdGVtcGxhdGVPYmplY3QyJDEgPSBfdGFnZ2VkVGVtcGxhdGVMaXRlcmFsTG9vc2UoW1wiXFxuICBkaXNwbGF5OiBmbGV4O1xcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcXG4gIG1hcmdpbi1sZWZ0OiBcIiwgXCI7XFxuICBnYXA6IDRweDtcXG5cIl0pKSwgZnVuY3Rpb24gKHByb3BzKSB7XG4gIHJldHVybiBwcm9wcy5oaWRlQXZhdGFyID8gJzBweCcgOiAnNTJweCc7XG59KTtcbnZhciBQaW5uZWROb3RpZmljYXRpb25UZXh0ID0gc3R5bGVkKEhlbHBlclRleHQpKF90ZW1wbGF0ZU9iamVjdDMkMSB8fCAoX3RlbXBsYXRlT2JqZWN0MyQxID0gX3RhZ2dlZFRlbXBsYXRlTGl0ZXJhbExvb3NlKFtcIlwiXSkpKTtcbnZhciBTdWJUZXh0ID0gc3R5bGVkKEhlbHBlclRleHQpKF90ZW1wbGF0ZU9iamVjdDQgfHwgKF90ZW1wbGF0ZU9iamVjdDQgPSBfdGFnZ2VkVGVtcGxhdGVMaXRlcmFsTG9vc2UoW1wiXFxuICBjb2xvcjogIzY0NzQ4YjtcXG5cIl0pKSk7XG52YXIgU3ViVGV4dFZpZXcgPSBzdHlsZWQuZGl2KF90ZW1wbGF0ZU9iamVjdDUgfHwgKF90ZW1wbGF0ZU9iamVjdDUgPSBfdGFnZ2VkVGVtcGxhdGVMaXRlcmFsTG9vc2UoW1wiXFxuICB0ZXh0LWRlY29yYXRpb246IG5vbmU7XFxuICBvdmVyZmxvdy13cmFwOiBhbnl3aGVyZTtcXG4gIGRpc3BsYXk6IGlubGluZS1ibG9jaztcXG4gICY6aG92ZXIge1xcbiAgICB0ZXh0LWRlY29yYXRpb246IFwiLCBcIjtcXG4gICAgdGV4dC1kZWNvcmF0aW9uLWNvbG9yOiBcIiwgXCI7XFxuICB9XFxuXCJdKSksIGZ1bmN0aW9uIChwcm9wcykge1xuICByZXR1cm4gcHJvcHMubGluayA/ICd1bmRlcmxpbmUnIDogJ25vbmUnO1xufSwgbGlnaHRDb2xvcnMuc2Vjb25kYXJ5VGV4dCk7XG52YXIgRXhwaXJlc1RleHQgPSBzdHlsZWQoSGVscGVyVGV4dCkoX3RlbXBsYXRlT2JqZWN0NiB8fCAoX3RlbXBsYXRlT2JqZWN0NiA9IF90YWdnZWRUZW1wbGF0ZUxpdGVyYWxMb29zZShbXCJcXG4gIG1hcmdpbi10b3A6IDhweDtcXG4gIGRpc3BsYXk6IGlubGluZS1ibG9jaztcXG4gIHBhZGRpbmc6IDFweCA2cHg7XFxuICBib3JkZXItcmFkaXVzOiA0cHg7XFxuXCJdKSkpO1xudmFyIE5vdGlmaWNhdGlvblZpZXcgPSBzdHlsZWQuZGl2KF90ZW1wbGF0ZU9iamVjdDcgfHwgKF90ZW1wbGF0ZU9iamVjdDcgPSBfdGFnZ2VkVGVtcGxhdGVMaXRlcmFsTG9vc2UoW1wiXFxuICBkaXNwbGF5OiBmbGV4O1xcbiAgZmxleC1kaXJlY3Rpb246IHJvdztcXG4gIGFsaWduLWl0ZW1zOiBmbGV4LXN0YXJ0O1xcbiAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuO1xcblwiXSkpKTtcbnZhciBIZWFkZXJUZXh0ID0gc3R5bGVkKENUZXh0KShfdGVtcGxhdGVPYmplY3Q4IHx8IChfdGVtcGxhdGVPYmplY3Q4ID0gX3RhZ2dlZFRlbXBsYXRlTGl0ZXJhbExvb3NlKFtcIlxcbiAgbWFyZ2luOiA4cHggMHB4IDBweCAwcHg7XFxuICBvdmVyZmxvdy13cmFwOiBhbnl3aGVyZTtcXG4gIGxpbmUtaGVpZ2h0OiAxOHB4O1xcbiAgZm9udC13ZWlnaHQ6IDcwMDtcXG5cIl0pKSk7XG52YXIgQm9keVRleHQgPSBzdHlsZWQuZGl2KF90ZW1wbGF0ZU9iamVjdDkgfHwgKF90ZW1wbGF0ZU9iamVjdDkgPSBfdGFnZ2VkVGVtcGxhdGVMaXRlcmFsTG9vc2UoW1wiXFxuICBmb250LXNpemU6IDE0cHg7XFxuICBsaW5lLWhlaWdodDogMjBweDtcXG4gIG1hcmdpbjogOHB4IDBweCA2cHg7XFxuICBmb250LXdlaWdodDogNDAwO1xcbiAgZm9udC1mYW1pbHk6IC1hcHBsZS1zeXN0ZW0sIEJsaW5rTWFjU3lzdGVtRm9udCwgJ1NlZ29lIFVJJywgUm9ib3RvLCBIZWx2ZXRpY2EsXFxuICAgIEFyaWFsLCBzYW5zLXNlcmlmLCAnQXBwbGUgQ29sb3IgRW1vamknLCAnU2Vnb2UgVUkgRW1vamknLCAnU2Vnb2UgVUkgU3ltYm9sJztcXG4gIGNvbG9yOiBcIiwgXCI7XFxuXCJdKSksIGxpZ2h0Q29sb3JzLnNlY29uZGFyeVRleHQpO1xudmFyIFVuc2VlbkRvdCA9IHN0eWxlZC5kaXYoX3RlbXBsYXRlT2JqZWN0MTAgfHwgKF90ZW1wbGF0ZU9iamVjdDEwID0gX3RhZ2dlZFRlbXBsYXRlTGl0ZXJhbExvb3NlKFtcIlxcbiAgYmFja2dyb3VuZC1jb2xvcjogXCIsIFwiO1xcbiAgYm9yZGVyLXJhZGl1czogNTAlO1xcbiAgd2lkdGg6IDdweDtcXG4gIGhlaWdodDogN3B4O1xcbiAgdmlzaWJpbGl0eTogXCIsIFwiO1xcblwiXSkpLCBsaWdodENvbG9ycy5wcmltYXJ5LCBmdW5jdGlvbiAocHJvcHMpIHtcbiAgcmV0dXJuIHByb3BzLnNob3cgPyAndmlzaWJsZScgOiAnaGlkZGVuJztcbn0pO1xudmFyIENyZWF0ZWRUZXh0ID0gc3R5bGVkKEhlbHBlclRleHQpKF90ZW1wbGF0ZU9iamVjdDExIHx8IChfdGVtcGxhdGVPYmplY3QxMSA9IF90YWdnZWRUZW1wbGF0ZUxpdGVyYWxMb29zZShbXCJcIl0pKSk7XG52YXIgQnV0dG9uQ29udGFpbmVyID0gc3R5bGVkLmRpdihfdGVtcGxhdGVPYmplY3QxMiB8fCAoX3RlbXBsYXRlT2JqZWN0MTIgPSBfdGFnZ2VkVGVtcGxhdGVMaXRlcmFsTG9vc2UoW1wiXFxuICBkaXNwbGF5OiBmbGV4O1xcbiAgZmxleC1kaXJlY3Rpb246IHJvdztcXG4gIGdhcDogMTBweDtcXG4gIG1hcmdpbi1ib3R0b206IDZweDtcXG4gIG1hcmdpbi10b3A6IDEycHg7XFxuICBvdmVyZmxvdy13cmFwOiBhbnl3aGVyZTtcXG5cIl0pKSk7XG52YXIgQnV0dG9uVmlldyA9IHN0eWxlZC5kaXYoX3RlbXBsYXRlT2JqZWN0MTMgfHwgKF90ZW1wbGF0ZU9iamVjdDEzID0gX3RhZ2dlZFRlbXBsYXRlTGl0ZXJhbExvb3NlKFtcIlxcbiAgbWF4LXdpZHRoOiA1MCU7XFxuICBiYWNrZ3JvdW5kOiBcIiwgXCI7XFxuICBib3JkZXItcmFkaXVzOiA1cHg7XFxuICB0ZXh0LWRlY29yYXRpb246IG5vbmU7XFxuICBwYWRkaW5nOiA0cHggMTZweDtcXG4gICY6aG92ZXIge1xcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiBcIiwgXCIgIWltcG9ydGFudDtcXG4gIH1cXG5cIl0pKSwgbGlnaHRDb2xvcnMucHJpbWFyeSwgZnVuY3Rpb24gKHByb3BzKSB7XG4gIHZhciBfcHJvcHMkc3R5bGU0O1xuICByZXR1cm4gKChfcHJvcHMkc3R5bGU0ID0gcHJvcHMuc3R5bGUpID09PSBudWxsIHx8IF9wcm9wcyRzdHlsZTQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9wcm9wcyRzdHlsZTQuaG92ZXJCYWNrZ3JvdW5kQ29sb3IpIHx8ICcjMjY1Y2JmJztcbn0pO1xudmFyIEJ1dHRvblRleHQgPSBzdHlsZWQoQ1RleHQpKF90ZW1wbGF0ZU9iamVjdDE0IHx8IChfdGVtcGxhdGVPYmplY3QxNCA9IF90YWdnZWRUZW1wbGF0ZUxpdGVyYWxMb29zZShbXCJcXG4gIGNvbG9yOiBcIiwgXCI7XFxuICB0ZXh0LWFsaWduOiBjZW50ZXI7XFxuICB3b3JkLWJyZWFrOiBicmVhay1hbGw7XFxuICBmb250LXdlaWdodDogNjAwO1xcbiAgZm9udC1zaXplOiAxM3B4O1xcblwiXSkpLCBsaWdodENvbG9ycy5tYWluKTtcbnZhciBCdXR0b25PdXRsaW5lVmlldyA9IHN0eWxlZChCdXR0b25WaWV3KShfdGVtcGxhdGVPYmplY3QxNSB8fCAoX3RlbXBsYXRlT2JqZWN0MTUgPSBfdGFnZ2VkVGVtcGxhdGVMaXRlcmFsTG9vc2UoW1wiXFxuICBiYWNrZ3JvdW5kOiBcIiwgXCI7XFxuICBib3JkZXItY29sb3I6IFwiLCBcIjtcXG4gIGJvcmRlci1zdHlsZTogc29saWQ7XFxuICBib3JkZXItd2lkdGg6IDEuMnB4O1xcbiAgJjpob3ZlciB7XFxuICAgIGJhY2tncm91bmQtY29sb3I6IFwiLCBcIiAhaW1wb3J0YW50O1xcbiAgfVxcblwiXSkpLCBsaWdodENvbG9ycy5tYWluLCBsaWdodENvbG9ycy5ib3JkZXIsIGZ1bmN0aW9uIChwcm9wcykge1xuICB2YXIgX3Byb3BzJHN0eWxlNTtcbiAgcmV0dXJuICgoX3Byb3BzJHN0eWxlNSA9IHByb3BzLnN0eWxlKSA9PT0gbnVsbCB8fCBfcHJvcHMkc3R5bGU1ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfcHJvcHMkc3R5bGU1LmhvdmVyQmFja2dyb3VuZENvbG9yKSB8fCAnI2Y3ZjdmOSc7XG59KTtcbnZhciBCdXR0b25PdXRsaW5lVGV4dCA9IHN0eWxlZChCdXR0b25UZXh0KShfdGVtcGxhdGVPYmplY3QxNiB8fCAoX3RlbXBsYXRlT2JqZWN0MTYgPSBfdGFnZ2VkVGVtcGxhdGVMaXRlcmFsTG9vc2UoW1wiXFxuICBjb2xvcjogXCIsIFwiO1xcblwiXSkpLCBsaWdodENvbG9ycy5zZWNvbmRhcnlUZXh0KTtcbnZhciBMZWZ0VmlldyA9IHN0eWxlZC5kaXYoX3RlbXBsYXRlT2JqZWN0MTcgfHwgKF90ZW1wbGF0ZU9iamVjdDE3ID0gX3RhZ2dlZFRlbXBsYXRlTGl0ZXJhbExvb3NlKFtcIlxcbiAgZGlzcGxheTogZmxleDtcXG4gIG92ZXJmbG93LXdyYXA6IGFueXdoZXJlO1xcbiAgZmxleC1ncm93OiAxO1xcblwiXSkpKTtcbnZhciBMZWZ0QXZhdGFyVmlldyA9IHN0eWxlZC5kaXYoX3RlbXBsYXRlT2JqZWN0MTggfHwgKF90ZW1wbGF0ZU9iamVjdDE4ID0gX3RhZ2dlZFRlbXBsYXRlTGl0ZXJhbExvb3NlKFtcIlxcbiAgZGlzcGxheTogZmxleDtcXG4gIG1hcmdpbi10b3A6IDhweDtcXG4gIG1hcmdpbi1yaWdodDogMTJweDtcXG5cIl0pKSk7XG52YXIgQXZhdGFyVmlldyA9IHN0eWxlZC5kaXYoX3RlbXBsYXRlT2JqZWN0MTkgfHwgKF90ZW1wbGF0ZU9iamVjdDE5ID0gX3RhZ2dlZFRlbXBsYXRlTGl0ZXJhbExvb3NlKFtcIlwiXSkpKTtcbnZhciBDb250ZW50VmlldyA9IHN0eWxlZC5kaXYoX3RlbXBsYXRlT2JqZWN0MjAgfHwgKF90ZW1wbGF0ZU9iamVjdDIwID0gX3RhZ2dlZFRlbXBsYXRlTGl0ZXJhbExvb3NlKFtcIlxcbiAgZmxleDogMTtcXG5cIl0pKSk7XG52YXIgUmlnaHRWaWV3ID0gc3R5bGVkLmRpdihfdGVtcGxhdGVPYmplY3QyMSB8fCAoX3RlbXBsYXRlT2JqZWN0MjEgPSBfdGFnZ2VkVGVtcGxhdGVMaXRlcmFsTG9vc2UoW1wiXFxuICBkaXNwbGF5OiBmbGV4O1xcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcXG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XFxuICBtYXJnaW4tdG9wOiA1cHg7XFxuICBtYXgtd2lkdGg6IDQwcHg7XFxuICBnYXA6IDVweDtcXG5cIl0pKSk7XG52YXIgQXZhdGFySW1hZ2UgPSBzdHlsZWQuaW1nKF90ZW1wbGF0ZU9iamVjdDIyIHx8IChfdGVtcGxhdGVPYmplY3QyMiA9IF90YWdnZWRUZW1wbGF0ZUxpdGVyYWxMb29zZShbXCJcXG4gIGhlaWdodDogMzZweDtcXG4gIHdpZHRoOiAzNnB4O1xcbiAgYm9yZGVyLXJhZGl1czogMTAwcHg7XFxuXCJdKSkpO1xudmFyIENNZW51UG9wdXAgPSBzdHlsZWQuZGl2KF90ZW1wbGF0ZU9iamVjdDIzIHx8IChfdGVtcGxhdGVPYmplY3QyMyA9IF90YWdnZWRUZW1wbGF0ZUxpdGVyYWxMb29zZShbXCJcXG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcXG4gIHJpZ2h0OiAwcHg7XFxuICBkaXNwbGF5OiBcIiwgXCI7XFxuICBtaW4td2lkdGg6IDE1MHB4O1xcbiAgcGFkZGluZzogMnB4O1xcbiAgYmFja2dyb3VuZC1jb2xvcjogXCIsIFwiO1xcbiAgYm9yZGVyOiAxcHggc29saWQ7XFxuICBib3JkZXItY29sb3I6IFwiLCBcIjtcXG4gIGJvcmRlci1yYWRpdXM6IDRweDtcXG4gIGJveC1zaGFkb3c6IDFweCAxcHggMjBweCAxcHggcmdiYSgwLCAwLCAwLCAwLjEpO1xcbiAgei1pbmRleDogMTAwO1xcblwiXSkpLCBmdW5jdGlvbiAocHJvcHMpIHtcbiAgcmV0dXJuIHByb3BzLm1vcmVPcGVuID8gJ2Jsb2NrJyA6ICdub25lJztcbn0sIGxpZ2h0Q29sb3JzLm1haW4sIGxpZ2h0Q29sb3JzLmJvcmRlcik7XG52YXIgQ01lbnVJdGVtID0gc3R5bGVkLmRpdihfdGVtcGxhdGVPYmplY3QyNCB8fCAoX3RlbXBsYXRlT2JqZWN0MjQgPSBfdGFnZ2VkVGVtcGxhdGVMaXRlcmFsTG9vc2UoW1wiXFxuICBwYWRkaW5nOiA3cHg7XFxuICBib3JkZXItcmFkaXVzOiA0cHg7XFxuICBkaXNwbGF5OiBmbGV4O1xcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcXG4gIGdhcDogOHB4O1xcbiAgJjpob3ZlciB7XFxuICAgIGJhY2tncm91bmQtY29sb3I6IFwiLCBcIjtcXG4gIH1cXG5cIl0pKSwgZnVuY3Rpb24gKHByb3BzKSB7XG4gIHZhciBfcHJvcHMkc3R5bGU2O1xuICByZXR1cm4gKHByb3BzID09PSBudWxsIHx8IHByb3BzID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX3Byb3BzJHN0eWxlNiA9IHByb3BzLnN0eWxlKSA9PT0gbnVsbCB8fCBfcHJvcHMkc3R5bGU2ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfcHJvcHMkc3R5bGU2LmhvdmVyQmFja2dyb3VuZENvbG9yKSB8fCAncmdiYSgxMDAsIDExNiwgMTM5LCAwLjA5KSc7XG59KTtcbnZhciBDTWVudVRleHQgPSBzdHlsZWQoQ1RleHQpKF90ZW1wbGF0ZU9iamVjdDI1IHx8IChfdGVtcGxhdGVPYmplY3QyNSA9IF90YWdnZWRUZW1wbGF0ZUxpdGVyYWxMb29zZShbXCJcIl0pKSk7XG52YXIgQ01lbnVWaWV3ID0gc3R5bGVkLmRpdihfdGVtcGxhdGVPYmplY3QyNiB8fCAoX3RlbXBsYXRlT2JqZWN0MjYgPSBfdGFnZ2VkVGVtcGxhdGVMaXRlcmFsTG9vc2UoW1wiXFxuICBwb3NpdGlvbjogcmVsYXRpdmU7XFxuICB2aXNpYmlsaXR5OiBcIiwgXCI7XFxuXCJdKSksIGZ1bmN0aW9uIChwcm9wcykge1xuICByZXR1cm4gcHJvcHMgIT09IG51bGwgJiYgcHJvcHMgIT09IHZvaWQgMCAmJiBwcm9wcy5zaG93TW9yZSA/ICd2aXNpYmxlJyA6ICdoaWRkZW4nO1xufSk7XG52YXIgQ01lbnVCdXR0b24gPSBzdHlsZWQuZGl2KF90ZW1wbGF0ZU9iamVjdDI3IHx8IChfdGVtcGxhdGVPYmplY3QyNyA9IF90YWdnZWRUZW1wbGF0ZUxpdGVyYWxMb29zZShbXCJcXG4gIGhlaWdodDogMjBweDtcXG4gIHdpZHRoOiAyMHB4O1xcbiAgJjpob3ZlciB7XFxuICAgIGJvcmRlci1yYWRpdXM6IDUwJTtcXG4gICAgYmFja2dyb3VuZC1jb2xvcjogXCIsIFwiO1xcbiAgfVxcblwiXSkpLCBmdW5jdGlvbiAocHJvcHMpIHtcbiAgcmV0dXJuIChwcm9wcyA9PT0gbnVsbCB8fCBwcm9wcyA9PT0gdm9pZCAwID8gdm9pZCAwIDogcHJvcHMuaG92ZXJCR0NvbG9yKSB8fCAncmdiYSgxMDAsIDExNiwgMTM5LCAwLjA5KSc7XG59KTtcblxuZnVuY3Rpb24gZ2V0VVJMVGFyZ2V0KHRhcmdldCkge1xuICByZXR1cm4gdGFyZ2V0ID8gJ19ibGFuaycgOiAnX3NlbGYnO1xufVxuZnVuY3Rpb24gQ2xpY2thYmxlTm90aWZpY2F0aW9uKF9yZWYpIHtcbiAgdmFyIG5vdGlmaWNhdGlvbkRhdGEgPSBfcmVmLm5vdGlmaWNhdGlvbkRhdGE7XG4gIHZhciBfdXNlSW5ib3ggPSB1c2VJbmJveCgpLFxuICAgIG5vdGlmaWNhdGlvbkNsaWNrSGFuZGxlciA9IF91c2VJbmJveC5ub3RpZmljYXRpb25DbGlja0hhbmRsZXIsXG4gICAgaW5ib3ggPSBfdXNlSW5ib3guaW5ib3g7XG4gIHZhciBjYXJkQ2xpY2tOYXZpZ2F0aW9uID0gZnVuY3Rpb24gY2FyZENsaWNrTmF2aWdhdGlvbigpIHtcbiAgICBpZiAodHlwZW9mIG5vdGlmaWNhdGlvbkNsaWNrSGFuZGxlciA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgbm90aWZpY2F0aW9uQ2xpY2tIYW5kbGVyKG5vdGlmaWNhdGlvbkRhdGEpO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgbWVzc2FnZSA9IG5vdGlmaWNhdGlvbkRhdGEgPT09IG51bGwgfHwgbm90aWZpY2F0aW9uRGF0YSA9PT0gdm9pZCAwID8gdm9pZCAwIDogbm90aWZpY2F0aW9uRGF0YS5tZXNzYWdlO1xuICAgICAgaWYgKG1lc3NhZ2UgIT09IG51bGwgJiYgbWVzc2FnZSAhPT0gdm9pZCAwICYmIG1lc3NhZ2UudXJsKSB7XG4gICAgICAgIHZhciBhY3Rpb25VcmxUYXJnZXQgPSBnZXRVUkxUYXJnZXQobWVzc2FnZSA9PT0gbnVsbCB8fCBtZXNzYWdlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBtZXNzYWdlLm9wZW5faW5fbmV3X3RhYik7XG4gICAgICAgIHdpbmRvdy5vcGVuKGZvcm1hdEFjdGlvbkxpbmsobWVzc2FnZS51cmwpLCBhY3Rpb25VcmxUYXJnZXQpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbiAgdmFyIG1hcmtOb3RpZmljYXRpb25DbGlja2VkID0gZnVuY3Rpb24gbWFya05vdGlmaWNhdGlvbkNsaWNrZWQoKSB7XG4gICAgaW5ib3guZmVlZC5tYXJrQ2xpY2tlZChub3RpZmljYXRpb25EYXRhLm5faWQpO1xuICB9O1xuICB2YXIgaGFuZGxlQ2FyZENsaWNrID0gZnVuY3Rpb24gaGFuZGxlQ2FyZENsaWNrKGUpIHtcbiAgICB2YXIgX25vdGlmaWNhdGlvbkRhdGEkbWVzO1xuICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgdmFyIGNsaWNrZWQgPSBub3RpZmljYXRpb25EYXRhLmludGVyYWN0ZWRfb247XG4gICAgdmFyIGFjdGlvblVybFRhcmdldCA9IGdldFVSTFRhcmdldChub3RpZmljYXRpb25EYXRhID09PSBudWxsIHx8IG5vdGlmaWNhdGlvbkRhdGEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfbm90aWZpY2F0aW9uRGF0YSRtZXMgPSBub3RpZmljYXRpb25EYXRhLm1lc3NhZ2UpID09PSBudWxsIHx8IF9ub3RpZmljYXRpb25EYXRhJG1lcyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX25vdGlmaWNhdGlvbkRhdGEkbWVzLm9wZW5faW5fbmV3X3RhYik7XG4gICAgbWFya05vdGlmaWNhdGlvbkNsaWNrZWQoKTtcbiAgICBpZiAoIWNsaWNrZWQgJiYgYWN0aW9uVXJsVGFyZ2V0ID09PSAnX3NlbGYnKSB7XG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY2FyZENsaWNrTmF2aWdhdGlvbigpO1xuICAgICAgfSwgMTAwMCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNhcmRDbGlja05hdmlnYXRpb24oKTtcbiAgICB9XG4gIH07XG4gIHZhciBoYW5kbGVBY3Rpb25DbGljayA9IGZ1bmN0aW9uIGhhbmRsZUFjdGlvbkNsaWNrKGUsIGNsaWNrRGF0YSkge1xuICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgdmFyIGNsaWNrZWQgPSBub3RpZmljYXRpb25EYXRhLmludGVyYWN0ZWRfb247XG4gICAgdmFyIGFjdGlvblVybFRhcmdldCA9IGdldFVSTFRhcmdldChjbGlja0RhdGEgPT09IG51bGwgfHwgY2xpY2tEYXRhID09PSB2b2lkIDAgPyB2b2lkIDAgOiBjbGlja0RhdGEudGFyZ2V0KTtcbiAgICBtYXJrTm90aWZpY2F0aW9uQ2xpY2tlZCgpO1xuICAgIGlmICghY2xpY2tlZCAmJiBhY3Rpb25VcmxUYXJnZXQgPT09ICdfc2VsZicpIHtcbiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoY2xpY2tEYXRhICE9PSBudWxsICYmIGNsaWNrRGF0YSAhPT0gdm9pZCAwICYmIGNsaWNrRGF0YS51cmwpIHtcbiAgICAgICAgICB3aW5kb3cub3Blbihmb3JtYXRBY3Rpb25MaW5rKGNsaWNrRGF0YS51cmwpLCBhY3Rpb25VcmxUYXJnZXQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNhcmRDbGlja05hdmlnYXRpb24oKTtcbiAgICAgICAgfVxuICAgICAgfSwgMTAwMCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChjbGlja0RhdGEgIT09IG51bGwgJiYgY2xpY2tEYXRhICE9PSB2b2lkIDAgJiYgY2xpY2tEYXRhLnVybCkge1xuICAgICAgICB3aW5kb3cub3Blbihmb3JtYXRBY3Rpb25MaW5rKGNsaWNrRGF0YS51cmwpLCBhY3Rpb25VcmxUYXJnZXQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY2FyZENsaWNrTmF2aWdhdGlvbigpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbiAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHtcbiAgICBvbkNsaWNrOiBoYW5kbGVDYXJkQ2xpY2tcbiAgfSwgLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoTm90aWZpY2F0aW9uLCB7XG4gICAgbm90aWZpY2F0aW9uRGF0YTogbm90aWZpY2F0aW9uRGF0YSxcbiAgICBoYW5kbGVBY3Rpb25DbGljazogaGFuZGxlQWN0aW9uQ2xpY2tcbiAgfSkpO1xufVxuXG52YXIgRW1wdHlOb3RpZmljYXRpb25JY29uID0gZnVuY3Rpb24gRW1wdHlOb3RpZmljYXRpb25JY29uKHByb3BzKSB7XG4gIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChcInN2Z1wiLCBfZXh0ZW5kcyh7XG4gICAgd2lkdGg6IDE4NSxcbiAgICBoZWlnaHQ6IDExNCxcbiAgICBmaWxsOiBcIm5vbmVcIixcbiAgICB4bWxuczogXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiXG4gIH0sIHByb3BzKSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJlbGxpcHNlXCIsIHtcbiAgICBjeDogOTIuMzIsXG4gICAgY3k6IDU2LjYxNixcbiAgICByeDogNjAuMzIsXG4gICAgcnk6IDU2LjYxNixcbiAgICBmaWxsOiBcIiM5RjlGOUZcIixcbiAgICBmaWxsT3BhY2l0eTogMC4xMVxuICB9KSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJyZWN0XCIsIHtcbiAgICB4OiA2OS4xNzQsXG4gICAgeTogMTcuNDY5LFxuICAgIHdpZHRoOiAxMTUuODI2LFxuICAgIGhlaWdodDogNDAuMjE3LFxuICAgIHJ4OiAxMi44NyxcbiAgICBmaWxsOiBcIiM5RjlGOUZcIlxuICB9KSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJyZWN0XCIsIHtcbiAgICB4OiAxMjMuMDY1LFxuICAgIHk6IDI5LjUzMyxcbiAgICB3aWR0aDogMzMuNzgzLFxuICAgIGhlaWdodDogNS42MyxcbiAgICByeDogMi44MTUsXG4gICAgZmlsbDogXCIjRDlEOUQ5XCJcbiAgfSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwicmVjdFwiLCB7XG4gICAgeDogOTUuNzE3LFxuICAgIHk6IDM5LjE4NSxcbiAgICB3aWR0aDogNTkuNTIyLFxuICAgIGhlaWdodDogNS42MyxcbiAgICByeDogMi44MTUsXG4gICAgZmlsbDogXCIjRDlEOUQ5XCJcbiAgfSksIC8qI19fUFVSRV9fKi9SZWFjdC5jcmVhdGVFbGVtZW50KFwiZWxsaXBzZVwiLCB7XG4gICAgY3g6IDE3MC45MjQsXG4gICAgY3k6IDM3LjU3NyxcbiAgICByeDogOC40NDYsXG4gICAgcnk6IDguMDQzLFxuICAgIGZpbGw6IFwiI0Q5RDlEOVwiXG4gIH0pLCAvKiNfX1BVUkVfXyovUmVhY3QuY3JlYXRlRWxlbWVudChcInJlY3RcIiwge1xuICAgIHk6IDUxLjI1LFxuICAgIHdpZHRoOiAxMjAuNjUyLFxuICAgIGhlaWdodDogNDAuMjE3LFxuICAgIHJ4OiAxMi44NyxcbiAgICBmaWxsOiBcIiNEOUU5RkZcIlxuICB9KSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJyZWN0XCIsIHtcbiAgICB4OiAzMC41NjUsXG4gICAgeTogNjMuMzE1LFxuICAgIHdpZHRoOiAzMy43ODMsXG4gICAgaGVpZ2h0OiA1LjYzLFxuICAgIHJ4OiAyLjgxNSxcbiAgICBmaWxsOiBcIiM5M0FGRDZcIlxuICB9KSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJyZWN0XCIsIHtcbiAgICB4OiAzMC41NjUsXG4gICAgeTogNzIuOTY3LFxuICAgIHdpZHRoOiA1OS41MjIsXG4gICAgaGVpZ2h0OiA1LjYzLFxuICAgIHJ4OiAyLjgxNSxcbiAgICBmaWxsOiBcIiM5M0FGRDZcIlxuICB9KSwgLyojX19QVVJFX18qL1JlYWN0LmNyZWF0ZUVsZW1lbnQoXCJlbGxpcHNlXCIsIHtcbiAgICBjeDogMTcuMjk0LFxuICAgIGN5OiA3MS4zNTgsXG4gICAgcng6IDguNDQ2LFxuICAgIHJ5OiA4LjA0MyxcbiAgICBmaWxsOiBcIiM5M0FGRDZcIlxuICB9KSk7XG59O1xuXG52YXIgX3RlbXBsYXRlT2JqZWN0JDMsIF90ZW1wbGF0ZU9iamVjdDIkMiwgX3RlbXBsYXRlT2JqZWN0MyQyLCBfdGVtcGxhdGVPYmplY3Q0JDEsIF90ZW1wbGF0ZU9iamVjdDUkMSwgX3RlbXBsYXRlT2JqZWN0NiQxLCBfdGVtcGxhdGVPYmplY3Q3JDEsIF90ZW1wbGF0ZU9iamVjdDgkMTtcbmZ1bmN0aW9uIExvYWRlcihfcmVmKSB7XG4gIHZhciBzdHlsZSA9IF9yZWYuc3R5bGUsXG4gICAgc2l6ZSA9IF9yZWYuc2l6ZTtcbiAgdmFyIGNvbG9yID0gc3R5bGUgPT09IG51bGwgfHwgc3R5bGUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHN0eWxlLmNvbG9yO1xuICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoU3Bpbm5lckNvbnRhaW5lciwgbnVsbCwgLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoU3Bpbm5lciwge1xuICAgIHN0eWxlOiBzdHlsZSxcbiAgICBjb2xvcjogY29sb3IsXG4gICAgc2l6ZTogc2l6ZVxuICB9KSk7XG59XG5mdW5jdGlvbiBOb3RpZmljYXRpb25zTGlzdCgpIHtcbiAgdmFyIF9zdG9yZURhdGEkYWN0aXZlU3RvcjtcbiAgdmFyIF91c2VJbmJveCA9IHVzZUluYm94KCksXG4gICAgX3VzZUluYm94JG5vdGlmaWNhdGlvID0gX3VzZUluYm94Lm5vdGlmaWNhdGlvbnNEYXRhLFxuICAgIHN0b3JlRGF0YSA9IF91c2VJbmJveCRub3RpZmljYXRpby5zdG9yZURhdGEsXG4gICAgaGFzTmV4dCA9IF91c2VJbmJveCRub3RpZmljYXRpby5oYXNOZXh0LFxuICAgIGluaXRpYWxMb2FkaW5nID0gX3VzZUluYm94JG5vdGlmaWNhdGlvLmluaXRpYWxMb2FkaW5nLFxuICAgIGFjdGl2ZVN0b3JlSWQgPSBfdXNlSW5ib3gkbm90aWZpY2F0aW8uYWN0aXZlU3RvcmVJZCxcbiAgICBub05vdGlmaWNhdGlvbnNDb21wb25lbnQgPSBfdXNlSW5ib3gubm9Ob3RpZmljYXRpb25zQ29tcG9uZW50LFxuICAgIGxvYWRlckNvbXBvbmVudCA9IF91c2VJbmJveC5sb2FkZXJDb21wb25lbnQsXG4gICAgcGFnaW5hdGlvbiA9IF91c2VJbmJveC5wYWdpbmF0aW9uLFxuICAgIGNoYW5naW5nQWN0aXZlU3RvcmUgPSBfdXNlSW5ib3guY2hhbmdpbmdBY3RpdmVTdG9yZSxcbiAgICBpbmJveCA9IF91c2VJbmJveC5pbmJveDtcbiAgdmFyIF91c2VUaGVtZSA9IHVzZVRoZW1lKCksXG4gICAgbm90aWZpY2F0aW9uc0NvbnRhaW5lciA9IF91c2VUaGVtZS5ub3RpZmljYXRpb25zQ29udGFpbmVyO1xuICB2YXIgbm90aWZpY2F0aW9ucyA9IChzdG9yZURhdGEgPT09IG51bGwgfHwgc3RvcmVEYXRhID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX3N0b3JlRGF0YSRhY3RpdmVTdG9yID0gc3RvcmVEYXRhW2FjdGl2ZVN0b3JlSWRdKSA9PT0gbnVsbCB8fCBfc3RvcmVEYXRhJGFjdGl2ZVN0b3IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9zdG9yZURhdGEkYWN0aXZlU3Rvci5ub3RpZmljYXRpb25zKSB8fCBbXTtcbiAgaWYgKGluaXRpYWxMb2FkaW5nKSB7XG4gICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KEluaXRpYWxMb2FkZXIsIG51bGwsIC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KExvYWRlciwge1xuICAgICAgc3R5bGU6IG5vdGlmaWNhdGlvbnNDb250YWluZXIgPT09IG51bGwgfHwgbm90aWZpY2F0aW9uc0NvbnRhaW5lciA9PT0gdm9pZCAwID8gdm9pZCAwIDogbm90aWZpY2F0aW9uc0NvbnRhaW5lci5sb2FkZXIsXG4gICAgICBzaXplOiBcImxhcmdlXCJcbiAgICB9KSk7XG4gIH1cbiAgaWYgKG5vdGlmaWNhdGlvbnMubGVuZ3RoIDw9IDApIHtcbiAgICBpZiAobm9Ob3RpZmljYXRpb25zQ29tcG9uZW50KSB7XG4gICAgICB2YXIgTm9Ob3RpZmljYXRpb25zQ29tcG9uZW50ID0gbm9Ob3RpZmljYXRpb25zQ29tcG9uZW50O1xuICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KE5vTm90aWZpY2F0aW9uc0NvbXBvbmVudCwgbnVsbCk7XG4gICAgfVxuICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChFbXB0eU5vdGlmaWNhdGlvbnNDb250YWluZXIsIG51bGwsIC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KEVtcHR5Tm90aWZpY2F0aW9uSWNvbiwgbnVsbCksIC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KEVtcHR5VGV4dCwge1xuICAgICAgc3R5bGU6IG5vdGlmaWNhdGlvbnNDb250YWluZXIgPT09IG51bGwgfHwgbm90aWZpY2F0aW9uc0NvbnRhaW5lciA9PT0gdm9pZCAwID8gdm9pZCAwIDogbm90aWZpY2F0aW9uc0NvbnRhaW5lci5ub05vdGlmaWNhdGlvbnNUZXh0XG4gICAgfSwgXCJObyBub3RpZmljYXRpb25zIHlldFwiKSwgLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoRW1wdHlTdWJUZXh0LCB7XG4gICAgICBzdHlsZTogbm90aWZpY2F0aW9uc0NvbnRhaW5lciA9PT0gbnVsbCB8fCBub3RpZmljYXRpb25zQ29udGFpbmVyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBub3RpZmljYXRpb25zQ29udGFpbmVyLm5vTm90aWZpY2F0aW9uc1N1YnRleHRcbiAgICB9LCBcIldlJ2xsIGxldCB5b3Uga25vdyB3aGVuIHdlJ3ZlIGdvdCBzb21ldGhpbmcgbmV3IGZvciB5b3UuXCIpKTtcbiAgfVxuICBpZiAoY2hhbmdpbmdBY3RpdmVTdG9yZSkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChTY3JvbGxEaXYsIG51bGwsIC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KEluZmluaXRlU2Nyb2xsLCB7XG4gICAgc2Nyb2xsYWJsZVRhcmdldDogXCJzcy1ub3RpZmljYXRpb24tY29udGFpbmVyXCIsXG4gICAgZGF0YUxlbmd0aDogbm90aWZpY2F0aW9ucy5sZW5ndGgsXG4gICAgbmV4dDogZnVuY3Rpb24gbmV4dCgpIHtcbiAgICAgIGluYm94LmZlZWQuZmV0Y2hOb3RpZmljYXRpb25zKCk7XG4gICAgfSxcbiAgICBoYXNNb3JlOiBwYWdpbmF0aW9uICYmIGhhc05leHQsXG4gICAgbG9hZGVyOiAobG9hZGVyQ29tcG9uZW50ID09PSBudWxsIHx8IGxvYWRlckNvbXBvbmVudCA9PT0gdm9pZCAwID8gdm9pZCAwIDogbG9hZGVyQ29tcG9uZW50KCkpIHx8IC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KExvYWRlciwge1xuICAgICAgc3R5bGU6IG5vdGlmaWNhdGlvbnNDb250YWluZXIgPT09IG51bGwgfHwgbm90aWZpY2F0aW9uc0NvbnRhaW5lciA9PT0gdm9pZCAwID8gdm9pZCAwIDogbm90aWZpY2F0aW9uc0NvbnRhaW5lci5sb2FkZXJcbiAgICB9KVxuICB9LCBub3RpZmljYXRpb25zLm1hcChmdW5jdGlvbiAobm90aWZpY2F0aW9uKSB7XG4gICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KENsaWNrYWJsZU5vdGlmaWNhdGlvbiwge1xuICAgICAgbm90aWZpY2F0aW9uRGF0YTogbm90aWZpY2F0aW9uLFxuICAgICAga2V5OiBub3RpZmljYXRpb24ubl9pZFxuICAgIH0pO1xuICB9KSkpO1xufVxudmFyIFNjcm9sbERpdiA9IHN0eWxlZC5kaXYoX3RlbXBsYXRlT2JqZWN0JDMgfHwgKF90ZW1wbGF0ZU9iamVjdCQzID0gX3RhZ2dlZFRlbXBsYXRlTGl0ZXJhbExvb3NlKFtcIlwiXSkpKTtcbnZhciBFbXB0eU5vdGlmaWNhdGlvbnNDb250YWluZXIgPSBzdHlsZWQuZGl2KF90ZW1wbGF0ZU9iamVjdDIkMiB8fCAoX3RlbXBsYXRlT2JqZWN0MiQyID0gX3RhZ2dlZFRlbXBsYXRlTGl0ZXJhbExvb3NlKFtcIlxcbiAgZGlzcGxheTogZmxleDtcXG4gIGp1c3RpZnktY29udGVudDogY2VudGVyO1xcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcXG4gIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XFxuICBtYXJnaW46IDMycHg7XFxuICBtYXJnaW4tdG9wOiA0MHB4O1xcblwiXSkpKTtcbnZhciBFbXB0eVRleHQgPSBzdHlsZWQoSGVhZGluZ1RleHQpKF90ZW1wbGF0ZU9iamVjdDMkMiB8fCAoX3RlbXBsYXRlT2JqZWN0MyQyID0gX3RhZ2dlZFRlbXBsYXRlTGl0ZXJhbExvb3NlKFtcIlxcbiAgZm9udC13ZWlnaHQ6IDYwMDtcXG4gIHRleHQtYWxpZ246IGNlbnRlcjtcXG4gIGJhY2tncm91bmQtY29sb3I6IHRyYW5zcGFyZW50O1xcbiAgbWFyZ2luOiAyMHB4IDBweDtcXG4gIG1hcmdpbi1ib3R0b206IDE2cHg7XFxuICBjb2xvcjogXCIsIFwiO1xcblwiXSkpLCBsaWdodENvbG9ycy5wcmltYXJ5VGV4dCk7XG52YXIgRW1wdHlTdWJUZXh0ID0gc3R5bGVkKENUZXh0KShfdGVtcGxhdGVPYmplY3Q0JDEgfHwgKF90ZW1wbGF0ZU9iamVjdDQkMSA9IF90YWdnZWRUZW1wbGF0ZUxpdGVyYWxMb29zZShbXCJcXG4gIGNvbG9yOiBcIiwgXCI7XFxuICB0ZXh0LWFsaWduOiBjZW50ZXI7XFxuXCJdKSksIGxpZ2h0Q29sb3JzLnNlY29uZGFyeVRleHQpO1xudmFyIHNwaW4gPSByZWFjdC5rZXlmcmFtZXMoX3RlbXBsYXRlT2JqZWN0NSQxIHx8IChfdGVtcGxhdGVPYmplY3Q1JDEgPSBfdGFnZ2VkVGVtcGxhdGVMaXRlcmFsTG9vc2UoW1wiXFxuMCUge1xcbiAgdHJhbnNmb3JtOiByb3RhdGUoMGRlZyk7XFxufVxcbjEwMCUge1xcbiAgdHJhbnNmb3JtOiByb3RhdGUoMzYwZGVnKTtcXG59XFxuXCJdKSkpO1xudmFyIFNwaW5uZXIgPSBzdHlsZWQuZGl2KF90ZW1wbGF0ZU9iamVjdDYkMSB8fCAoX3RlbXBsYXRlT2JqZWN0NiQxID0gX3RhZ2dlZFRlbXBsYXRlTGl0ZXJhbExvb3NlKFtcIlxcbiAgYm9yZGVyOiBcIiwgXCI7XFxuICBib3JkZXItdG9wOiBcIiwgXCI7XFxuICBib3JkZXItdG9wLWNvbG9yOiBcIiwgXCI7XFxuICBib3JkZXItcmFkaXVzOiA1MCU7XFxuICB3aWR0aDogXCIsIFwiO1xcbiAgaGVpZ2h0OiBcIiwgXCI7XFxuICBhbmltYXRpb246IFwiLCBcIiAxcyBsaW5lYXIgaW5maW5pdGU7XFxuICBtYXJnaW46IDVweDtcXG5cIl0pKSwgZnVuY3Rpb24gKHByb3BzKSB7XG4gIHJldHVybiBwcm9wcy5zaXplID09PSAnbGFyZ2UnID8gXCI1cHggc29saWQgXCIgKyBsaWdodENvbG9ycy5ib3JkZXIgOiBcIjNweCBzb2xpZCBcIiArIGxpZ2h0Q29sb3JzLmJvcmRlcjtcbn0sIGZ1bmN0aW9uIChwcm9wcykge1xuICByZXR1cm4gcHJvcHMuc2l6ZSA9PT0gJ2xhcmdlJyA/ICc1cHggc29saWQnIDogJzNweCBzb2xpZCc7XG59LCBmdW5jdGlvbiAocHJvcHMpIHtcbiAgcmV0dXJuIHByb3BzLmNvbG9yID8gcHJvcHMuY29sb3IgOiBsaWdodENvbG9ycy5wcmltYXJ5O1xufSwgZnVuY3Rpb24gKHByb3BzKSB7XG4gIHJldHVybiBwcm9wcy5zaXplID09PSAnbGFyZ2UnID8gJzIwcHgnIDogJzEwcHgnO1xufSwgZnVuY3Rpb24gKHByb3BzKSB7XG4gIHJldHVybiBwcm9wcy5zaXplID09PSAnbGFyZ2UnID8gJzIwcHgnIDogJzEwcHgnO1xufSwgc3Bpbik7XG52YXIgU3Bpbm5lckNvbnRhaW5lciA9IHN0eWxlZC5kaXYoX3RlbXBsYXRlT2JqZWN0NyQxIHx8IChfdGVtcGxhdGVPYmplY3Q3JDEgPSBfdGFnZ2VkVGVtcGxhdGVMaXRlcmFsTG9vc2UoW1wiXFxuICBkaXNwbGF5OiBmbGV4O1xcbiAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XFxuICBhbGlnbi1pdGVtczogY2VudGVyO1xcblwiXSkpKTtcbnZhciBJbml0aWFsTG9hZGVyID0gc3R5bGVkLmRpdihfdGVtcGxhdGVPYmplY3Q4JDEgfHwgKF90ZW1wbGF0ZU9iamVjdDgkMSA9IF90YWdnZWRUZW1wbGF0ZUxpdGVyYWxMb29zZShbXCJcXG4gIG1hcmdpbi10b3A6IDMycHg7XFxuXCJdKSkpO1xuXG52YXIgX3RlbXBsYXRlT2JqZWN0JDQsIF90ZW1wbGF0ZU9iamVjdDIkMywgX3RlbXBsYXRlT2JqZWN0MyQzLCBfdGVtcGxhdGVPYmplY3Q0JDIsIF90ZW1wbGF0ZU9iamVjdDUkMiwgX3RlbXBsYXRlT2JqZWN0NiQyLCBfdGVtcGxhdGVPYmplY3Q3JDIsIF90ZW1wbGF0ZU9iamVjdDgkMiwgX3RlbXBsYXRlT2JqZWN0OSQxO1xuZnVuY3Rpb24gaGFzTm90aWZpY2F0aW9ucyhzdG9yZURhdGEpIHtcbiAgdmFyIGhhc0RhdGEgPSBmYWxzZTtcbiAgZm9yICh2YXIgc3RvcmVJZCBpbiBzdG9yZURhdGEpIHtcbiAgICB2YXIgX3N0b3JlJG5vdGlmaWNhdGlvbnM7XG4gICAgdmFyIHN0b3JlID0gc3RvcmVEYXRhW3N0b3JlSWRdO1xuICAgIGlmICgoc3RvcmUgPT09IG51bGwgfHwgc3RvcmUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfc3RvcmUkbm90aWZpY2F0aW9ucyA9IHN0b3JlLm5vdGlmaWNhdGlvbnMpID09PSBudWxsIHx8IF9zdG9yZSRub3RpZmljYXRpb25zID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfc3RvcmUkbm90aWZpY2F0aW9ucy5sZW5ndGgpID4gMCkge1xuICAgICAgaGFzRGF0YSA9IHRydWU7XG4gICAgfVxuICB9XG4gIHJldHVybiBoYXNEYXRhO1xufVxuZnVuY3Rpb24gSGVhZGVyKCkge1xuICB2YXIgX3VzZVRoZW1lID0gdXNlVGhlbWUoKSxcbiAgICBoZWFkZXIgPSBfdXNlVGhlbWUuaGVhZGVyLFxuICAgIHRhYnMgPSBfdXNlVGhlbWUudGFicztcbiAgdmFyIF91c2VJbmJveCA9IHVzZUluYm94KCksXG4gICAgaW5ib3ggPSBfdXNlSW5ib3guaW5ib3gsXG4gICAgbm90aWZpY2F0aW9uc0RhdGEgPSBfdXNlSW5ib3gubm90aWZpY2F0aW9uc0RhdGEsXG4gICAgYWN0aXZlU3RvcmUgPSBfdXNlSW5ib3guYWN0aXZlU3RvcmUsXG4gICAgc2V0QWN0aXZlU3RvcmUgPSBfdXNlSW5ib3guc2V0QWN0aXZlU3RvcmUsXG4gICAgc2V0Q2hhbmdpbmdBY3RpdmVTdG9yZSA9IF91c2VJbmJveC5zZXRDaGFuZ2luZ0FjdGl2ZVN0b3JlLFxuICAgIHNob3dVbnJlYWRDb3VudE9uVGFicyA9IF91c2VJbmJveC5zaG93VW5yZWFkQ291bnRPblRhYnMsXG4gICAgdGFiQmFkZ2VDb21wb25lbnQgPSBfdXNlSW5ib3gudGFiQmFkZ2VDb21wb25lbnQ7XG4gIHZhciBpc0VtcHR5ID0gIWhhc05vdGlmaWNhdGlvbnMobm90aWZpY2F0aW9uc0RhdGEgPT09IG51bGwgfHwgbm90aWZpY2F0aW9uc0RhdGEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IG5vdGlmaWNhdGlvbnNEYXRhLnN0b3JlRGF0YSk7XG4gIHZhciBzdG9yZXMgPSBpbmJveC5mZWVkLnN0b3JlcztcbiAgdmFyIGhhc1N0b3JlcyA9IChzdG9yZXMgPT09IG51bGwgfHwgc3RvcmVzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBzdG9yZXMubGVuZ3RoKSA+IDA7XG4gIHZhciBUYWJCYWRnZUNvbXBvbmVudCA9IHRhYkJhZGdlQ29tcG9uZW50O1xuICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoQ29udGFpbmVyJDEsIHtcbiAgICBzdHlsZTogaGVhZGVyID09PSBudWxsIHx8IGhlYWRlciA9PT0gdm9pZCAwID8gdm9pZCAwIDogaGVhZGVyLmNvbnRhaW5lclxuICB9LCAvKiNfX1BVUkVfXyovUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChUb3BDb250YWluZXIsIHtcbiAgICBoYXNTdG9yZXM6IGhhc1N0b3Jlc1xuICB9LCAvKiNfX1BVUkVfXyovUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChIZWFkZXJUZXh0JDEsIHtcbiAgICBzdHlsZTogaGVhZGVyID09PSBudWxsIHx8IGhlYWRlciA9PT0gdm9pZCAwID8gdm9pZCAwIDogaGVhZGVyLmhlYWRlclRleHRcbiAgfSwgXCJOb3RpZmljYXRpb25zXCIpLCAhaXNFbXB0eSAmJiAvKiNfX1BVUkVfXyovUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChBbGxSZWFkQnV0dG9uLCB7XG4gICAgc3R5bGU6IGhlYWRlciA9PT0gbnVsbCB8fCBoZWFkZXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGhlYWRlci5tYXJrQWxsUmVhZFRleHQsXG4gICAgb25DbGljazogZnVuY3Rpb24gb25DbGljayhlKSB7XG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgaW5ib3guZmVlZC5tYXJrQWxsUmVhZCgpO1xuICAgIH1cbiAgfSwgXCJNYXJrIGFsbCBhcyByZWFkXCIpKSwgc3RvcmVzICYmIHN0b3Jlcy5sZW5ndGggPiAwICYmIC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KFRhYnNDb250YWluZXIsIG51bGwsIHN0b3Jlcy5tYXAoZnVuY3Rpb24gKHN0b3JlLCBpbmRleCkge1xuICAgIHZhciBfbm90aWZpY2F0aW9uc0RhdGEkc3QsIF9ub3RpZmljYXRpb25zRGF0YSRzdDI7XG4gICAgdmFyIGlzQWN0aXZlVGFiID0gYWN0aXZlU3RvcmUgPT09IHN0b3JlLnN0b3JlSWQ7XG4gICAgdmFyIHRhYlVuc2VlbkNvdW50ID0gKG5vdGlmaWNhdGlvbnNEYXRhID09PSBudWxsIHx8IG5vdGlmaWNhdGlvbnNEYXRhID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX25vdGlmaWNhdGlvbnNEYXRhJHN0ID0gbm90aWZpY2F0aW9uc0RhdGEuc3RvcmVEYXRhKSA9PT0gbnVsbCB8fCBfbm90aWZpY2F0aW9uc0RhdGEkc3QgPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfbm90aWZpY2F0aW9uc0RhdGEkc3QyID0gX25vdGlmaWNhdGlvbnNEYXRhJHN0W3N0b3JlLnN0b3JlSWRdKSA9PT0gbnVsbCB8fCBfbm90aWZpY2F0aW9uc0RhdGEkc3QyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfbm90aWZpY2F0aW9uc0RhdGEkc3QyLnVuc2VlbkNvdW50KSB8fCAwO1xuICAgIHZhciBzaG93QmFkZ2UgPSBzaG93VW5yZWFkQ291bnRPblRhYnMgJiYgdGFiVW5zZWVuQ291bnQgPiAwO1xuICAgIHZhciBzZWxlY3RlZFRhYkJvdHRvbUNvbG9yID0gaXNBY3RpdmVUYWIgPyB0YWJzID09PSBudWxsIHx8IHRhYnMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHRhYnMuYm90dG9tQ29sb3IgOiAnbm9uZSc7XG4gICAgdmFyIHRleHRDb2xvciA9IGlzQWN0aXZlVGFiID8gdGFicyA9PT0gbnVsbCB8fCB0YWJzID09PSB2b2lkIDAgPyB2b2lkIDAgOiB0YWJzLmNvbG9yIDogKHRhYnMgPT09IG51bGwgfHwgdGFicyA9PT0gdm9pZCAwID8gdm9pZCAwIDogdGFicy51bnNlbGVjdGVkQ29sb3IpIHx8ICh0YWJzID09PSBudWxsIHx8IHRhYnMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHRhYnMuY29sb3IpO1xuICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChUYWJDb250YWluZXIsIHtcbiAgICAgIHN0eWxlOiB7XG4gICAgICAgIGJvcmRlckJvdHRvbUNvbG9yOiBzZWxlY3RlZFRhYkJvdHRvbUNvbG9yXG4gICAgICB9LFxuICAgICAga2V5OiBpbmRleCxcbiAgICAgIHNlbGVjdGVkOiBpc0FjdGl2ZVRhYixcbiAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uIG9uQ2xpY2soKSB7XG4gICAgICAgIHNldENoYW5naW5nQWN0aXZlU3RvcmUodHJ1ZSk7XG4gICAgICAgIHNldEFjdGl2ZVN0b3JlKHN0b3JlLnN0b3JlSWQpO1xuICAgICAgICBpbmJveC5jaGFuZ2VBY3RpdmVTdG9yZShzdG9yZS5zdG9yZUlkKTtcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgc2V0Q2hhbmdpbmdBY3RpdmVTdG9yZShmYWxzZSk7XG4gICAgICAgIH0sIDApO1xuICAgICAgfVxuICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KFRhYlRleHQsIHtcbiAgICAgIHNlbGVjdGVkOiBpc0FjdGl2ZVRhYixcbiAgICAgIHN0eWxlOiBfZXh0ZW5kcyh7fSwgdGFicywge1xuICAgICAgICBjb2xvcjogdGV4dENvbG9yXG4gICAgICB9KVxuICAgIH0sIHN0b3JlLmxhYmVsKSwgc2hvd0JhZGdlICYmIChUYWJCYWRnZUNvbXBvbmVudCA/IC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KFRhYkJhZGdlQ29tcG9uZW50LCB7XG4gICAgICBjb3VudDogdGFiVW5zZWVuQ291bnRcbiAgICB9KSA6IC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KFRhYkJhZGdlLCB7XG4gICAgICBzdHlsZToge1xuICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IHRhYnMgPT09IG51bGwgfHwgdGFicyA9PT0gdm9pZCAwID8gdm9pZCAwIDogdGFicy5iYWRnZUNvbG9yLFxuICAgICAgICBjb2xvcjogdGFicyA9PT0gbnVsbCB8fCB0YWJzID09PSB2b2lkIDAgPyB2b2lkIDAgOiB0YWJzLmJhZGdlVGV4dFxuICAgICAgfVxuICAgIH0sIC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KFRhYkJhZGdlVGV4dCwge1xuICAgICAgY291bnQ6IHRhYlVuc2VlbkNvdW50XG4gICAgfSwgdGFiVW5zZWVuQ291bnQpKSkpO1xuICB9KSkpO1xufVxudmFyIENvbnRhaW5lciQxID0gc3R5bGVkLmRpdihfdGVtcGxhdGVPYmplY3QkNCB8fCAoX3RlbXBsYXRlT2JqZWN0JDQgPSBfdGFnZ2VkVGVtcGxhdGVMaXRlcmFsTG9vc2UoW1wiXFxuICBwb3NpdGlvbjogc3RpY2t5O1xcbiAgdG9wOiAwO1xcbiAgcGFkZGluZzogMTZweDtcXG4gIHBhZGRpbmctYm90dG9tOiAwcHg7XFxuICB6LWluZGV4OiAxMDAwO1xcbiAgYmFja2dyb3VuZC1jb2xvcjogXCIsIFwiO1xcbiAgYm94LXNoYWRvdzogMCAwIDNweCAwIHJnYmEoMCwgMCwgMCwgMC4xKTtcXG5cIl0pKSwgbGlnaHRDb2xvcnMubWFpbik7XG52YXIgVG9wQ29udGFpbmVyID0gc3R5bGVkLmRpdihfdGVtcGxhdGVPYmplY3QyJDMgfHwgKF90ZW1wbGF0ZU9iamVjdDIkMyA9IF90YWdnZWRUZW1wbGF0ZUxpdGVyYWxMb29zZShbXCJcXG4gIGRpc3BsYXk6IGZsZXg7XFxuICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XFxuICBhbGlnbi1pdGVtczogY2VudGVyO1xcbiAgbWFyZ2luLWJvdHRvbTogXCIsIFwiO1xcbiAgcGFkZGluZy1ib3R0b206IFwiLCBcIjtcXG5cIl0pKSwgZnVuY3Rpb24gKHByb3BzKSB7XG4gIHJldHVybiBwcm9wcy5oYXNTdG9yZXMgPyAnMTZweCcgOiAnMHB4Jztcbn0sIGZ1bmN0aW9uIChwcm9wcykge1xuICByZXR1cm4gcHJvcHMuaGFzU3RvcmVzID8gJzBweCcgOiAnMTZweCc7XG59KTtcbnZhciBUYWJzQ29udGFpbmVyID0gc3R5bGVkLmRpdihfdGVtcGxhdGVPYmplY3QzJDMgfHwgKF90ZW1wbGF0ZU9iamVjdDMkMyA9IF90YWdnZWRUZW1wbGF0ZUxpdGVyYWxMb29zZShbXCJcXG4gIGRpc3BsYXk6IGZsZXg7XFxuICBvdmVyZmxvdy14OiBzY3JvbGw7XFxuICAtbXMtb3ZlcmZsb3ctc3R5bGU6IG5vbmU7XFxuICBzY3JvbGxiYXItd2lkdGg6IG5vbmU7XFxuICAmOjotd2Via2l0LXNjcm9sbGJhciB7XFxuICAgIGRpc3BsYXk6IG5vbmU7XFxuICB9XFxuXCJdKSkpO1xudmFyIFRhYkNvbnRhaW5lciA9IHN0eWxlZC5kaXYoX3RlbXBsYXRlT2JqZWN0NCQyIHx8IChfdGVtcGxhdGVPYmplY3Q0JDIgPSBfdGFnZ2VkVGVtcGxhdGVMaXRlcmFsTG9vc2UoW1wiXFxuICBwYWRkaW5nOiA1cHggMTVweCAzcHggMTVweDtcXG4gIGJvcmRlci1ib3R0b206IFwiLCBcIjtcXG4gIGN1cnNvcjogcG9pbnRlcjtcXG4gIGRpc3BsYXk6IGZsZXg7XFxuICBhbGlnbi1pdGVtczogY2VudGVyO1xcbiAgZ2FwOiA1cHg7XFxuXCJdKSksIGZ1bmN0aW9uIChwcm9wcykge1xuICByZXR1cm4gcHJvcHMuc2VsZWN0ZWQgPyBcIjJweCBzb2xpZCBcIiArIGxpZ2h0Q29sb3JzLnByaW1hcnkgOiAnbm9uZSc7XG59KTtcbnZhciBUYWJUZXh0ID0gc3R5bGVkKENUZXh0KShfdGVtcGxhdGVPYmplY3Q1JDIgfHwgKF90ZW1wbGF0ZU9iamVjdDUkMiA9IF90YWdnZWRUZW1wbGF0ZUxpdGVyYWxMb29zZShbXCJcXG4gIGZvbnQtc2l6ZTogMTRweDtcXG4gIGZvbnQtd2VpZ2h0OiA2MDA7XFxuICBjb2xvcjogXCIsIFwiO1xcblwiXSkpLCBmdW5jdGlvbiAocHJvcHMpIHtcbiAgcmV0dXJuIHByb3BzLnNlbGVjdGVkID8gbGlnaHRDb2xvcnMucHJpbWFyeVRleHQgOiBsaWdodENvbG9ycy5zZWNvbmRhcnlUZXh0ICsgJ0Q5Jztcbn0pO1xudmFyIEhlYWRlclRleHQkMSA9IHN0eWxlZChIZWFkaW5nVGV4dCkoX3RlbXBsYXRlT2JqZWN0NiQyIHx8IChfdGVtcGxhdGVPYmplY3Q2JDIgPSBfdGFnZ2VkVGVtcGxhdGVMaXRlcmFsTG9vc2UoW1wiXFxuICBmb250LXdlaWdodDogNjAwO1xcbiAgZm9udC1zaXplOiAxNnB4O1xcblwiXSkpKTtcbnZhciBBbGxSZWFkQnV0dG9uID0gc3R5bGVkKEhlYWRpbmdUZXh0KShfdGVtcGxhdGVPYmplY3Q3JDIgfHwgKF90ZW1wbGF0ZU9iamVjdDckMiA9IF90YWdnZWRUZW1wbGF0ZUxpdGVyYWxMb29zZShbXCJcXG4gIGNvbG9yOiBcIiwgXCI7XFxuICBmb250LXNpemU6IDEycHg7XFxuICBjdXJzb3I6IHBvaW50ZXI7XFxuXCJdKSksIGxpZ2h0Q29sb3JzLnByaW1hcnkpO1xudmFyIFRhYkJhZGdlID0gc3R5bGVkLmRpdihfdGVtcGxhdGVPYmplY3Q4JDIgfHwgKF90ZW1wbGF0ZU9iamVjdDgkMiA9IF90YWdnZWRUZW1wbGF0ZUxpdGVyYWxMb29zZShbXCJcXG4gIGhlaWdodDogMThweDtcXG4gIHdpZHRoOiAyMHB4O1xcbiAgYm9yZGVyLXJhZGl1czogNTAlO1xcbiAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgxMDAsIDExNiwgMTM5LCAwLjA5KTtcXG4gIGRpc3BsYXk6IGZsZXg7XFxuICBhbGlnbi1pdGVtczogY2VudGVyO1xcbiAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XFxuICBjb2xvcjogXCIsIFwiO1xcblwiXSkpLCBsaWdodENvbG9ycy5wcmltYXJ5VGV4dCk7XG52YXIgVGFiQmFkZ2VUZXh0ID0gc3R5bGVkLnAoX3RlbXBsYXRlT2JqZWN0OSQxIHx8IChfdGVtcGxhdGVPYmplY3Q5JDEgPSBfdGFnZ2VkVGVtcGxhdGVMaXRlcmFsTG9vc2UoW1wiXFxuICBtYXJnaW46IDBweDtcXG4gIHBhZGRpbmc6IDBweDtcXG4gIGZvbnQtc2l6ZTogXCIsIFwiO1xcbiAgZm9udC13ZWlnaHQ6IDYwMDtcXG4gIGxpbmUtaGVpZ2h0OiAxO1xcbiAgZm9udC1mYW1pbHk6IC1hcHBsZS1zeXN0ZW0sIEJsaW5rTWFjU3lzdGVtRm9udCwgJ1NlZ29lIFVJJywgUm9ib3RvLCBIZWx2ZXRpY2EsXFxuICAgIEFyaWFsLCBzYW5zLXNlcmlmLCAnQXBwbGUgQ29sb3IgRW1vamknLCAnU2Vnb2UgVUkgRW1vamknLCAnU2Vnb2UgVUkgU3ltYm9sJztcXG5cIl0pKSwgZnVuY3Rpb24gKHByb3BzKSB7XG4gIHJldHVybiAocHJvcHMgPT09IG51bGwgfHwgcHJvcHMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHByb3BzLmNvdW50KSA+IDk5ID8gJzhweCcgOiAnMTBweCc7XG59KTtcblxudmFyIF90ZW1wbGF0ZU9iamVjdCQ1O1xuZnVuY3Rpb24gTm90aWZpY2F0aW9uc0NvbnRhaW5lcigpIHtcbiAgdmFyIF91c2VUaGVtZSA9IHVzZVRoZW1lKCksXG4gICAgbm90aWZpY2F0aW9uc0NvbnRhaW5lciA9IF91c2VUaGVtZS5ub3RpZmljYXRpb25zQ29udGFpbmVyO1xuICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoQ29udGFpbmVyJDIsIHtcbiAgICBzdHlsZTogbm90aWZpY2F0aW9uc0NvbnRhaW5lciA9PT0gbnVsbCB8fCBub3RpZmljYXRpb25zQ29udGFpbmVyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBub3RpZmljYXRpb25zQ29udGFpbmVyLmNvbnRhaW5lcixcbiAgICBpZDogXCJzcy1ub3RpZmljYXRpb24tY29udGFpbmVyXCJcbiAgfSwgLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoSGVhZGVyLCBudWxsKSwgLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoTm90aWZpY2F0aW9uc0xpc3QsIG51bGwpKTtcbn1cbnZhciBDb250YWluZXIkMiA9IHN0eWxlZC5kaXYoX3RlbXBsYXRlT2JqZWN0JDUgfHwgKF90ZW1wbGF0ZU9iamVjdCQ1ID0gX3RhZ2dlZFRlbXBsYXRlTGl0ZXJhbExvb3NlKFtcIlxcbiAgaGVpZ2h0OiA1MDBweDtcXG4gIHdpZHRoOiA0NTBweDtcXG4gIG1hcmdpbjogMHB4IDE1cHg7XFxuICBib3JkZXItcmFkaXVzOiA1cHg7XFxuICBiYWNrZ3JvdW5kLWNvbG9yOiBcIiwgXCI7XFxuICBib3JkZXI6IDFweCBzb2xpZCBcIiwgXCI7XFxuICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XFxuICBvdmVyZmxvdzogc2Nyb2xsO1xcbiAgYm94LXNoYWRvdzogMCAwcHggN3B4IDAgcmdiYSgwLCAwLCAwLCAwLjEpO1xcbiAgQG1lZGlhIChtYXgtd2lkdGg6IDQyNXB4KSB7XFxuICAgIHdpZHRoOiA5OS41dnc7XFxuICAgIG1hcmdpbjogMHB4O1xcbiAgICBib3JkZXItcmFkaXVzOiAwcHg7XFxuICB9XFxuXCJdKSksIGxpZ2h0Q29sb3JzLm1haW4sIGxpZ2h0Q29sb3JzLmJvcmRlcik7XG5cbnZhciB1c2VDbGlja091dHNpZGUgPSBmdW5jdGlvbiB1c2VDbGlja091dHNpZGUocmVmLCBoYW5kbGVyKSB7XG4gIFJlYWN0LnVzZUVmZmVjdChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHN0YXJ0ZWRJbnNpZGUgPSBmYWxzZTtcbiAgICB2YXIgc3RhcnRlZFdoZW5Nb3VudGVkID0gZmFsc2U7XG4gICAgdmFyIGxpc3RlbmVyID0gZnVuY3Rpb24gbGlzdGVuZXIoZXZlbnQpIHtcbiAgICAgIGlmIChzdGFydGVkSW5zaWRlIHx8ICFzdGFydGVkV2hlbk1vdW50ZWQpIHJldHVybjtcbiAgICAgIGlmICghcmVmLmN1cnJlbnQgfHwgcmVmLmN1cnJlbnQuY29udGFpbnMoZXZlbnQudGFyZ2V0KSkgcmV0dXJuO1xuICAgICAgaGFuZGxlcihldmVudCk7XG4gICAgfTtcbiAgICB2YXIgdmFsaWRhdGVFdmVudFN0YXJ0ID0gZnVuY3Rpb24gdmFsaWRhdGVFdmVudFN0YXJ0KGV2ZW50KSB7XG4gICAgICBzdGFydGVkV2hlbk1vdW50ZWQgPSByZWYuY3VycmVudDtcbiAgICAgIHN0YXJ0ZWRJbnNpZGUgPSByZWYuY3VycmVudCAmJiByZWYuY3VycmVudC5jb250YWlucyhldmVudC50YXJnZXQpO1xuICAgIH07XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgdmFsaWRhdGVFdmVudFN0YXJ0KTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0JywgdmFsaWRhdGVFdmVudFN0YXJ0KTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGxpc3RlbmVyKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgdmFsaWRhdGVFdmVudFN0YXJ0KTtcbiAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCB2YWxpZGF0ZUV2ZW50U3RhcnQpO1xuICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCBsaXN0ZW5lcik7XG4gICAgfTtcbiAgfSwgW3JlZiwgaGFuZGxlcl0pO1xufTtcblxudmFyIF90ZW1wbGF0ZU9iamVjdCQ2LCBfdGVtcGxhdGVPYmplY3QyJDQ7XG5mdW5jdGlvbiBJbmJveChfcmVmKSB7XG4gIHZhciBvcGVuSW5ib3ggPSBfcmVmLm9wZW5JbmJveCxcbiAgICB0b2dnbGVJbmJveCA9IF9yZWYudG9nZ2xlSW5ib3gsXG4gICAgcG9wcGVyUG9zaXRpb24gPSBfcmVmLnBvcHBlclBvc2l0aW9uO1xuICB2YXIgX3VzZVN0YXRlID0gUmVhY3QudXNlU3RhdGUobnVsbCksXG4gICAgcmVmZXJlbmNlRWxlbWVudCA9IF91c2VTdGF0ZVswXSxcbiAgICBzZXRSZWZlcmVuY2VFbGVtZW50ID0gX3VzZVN0YXRlWzFdO1xuICB2YXIgX3VzZVN0YXRlMiA9IFJlYWN0LnVzZVN0YXRlKG51bGwpLFxuICAgIHBvcHBlckVsZW1lbnQgPSBfdXNlU3RhdGUyWzBdLFxuICAgIHNldFBvcHBlckVsZW1lbnQgPSBfdXNlU3RhdGUyWzFdO1xuICB2YXIgX3VzZUluYm94ID0gdXNlSW5ib3goKSxcbiAgICBzZXROb3RpZmljYXRpb25zRGF0YSA9IF91c2VJbmJveC5zZXROb3RpZmljYXRpb25zRGF0YTtcbiAgdXNlQ2xpY2tPdXRzaWRlKHtcbiAgICBjdXJyZW50OiBwb3BwZXJFbGVtZW50XG4gIH0sIGZ1bmN0aW9uICgpIHtcbiAgICB0b2dnbGVJbmJveChmdW5jdGlvbiAocHJldikge1xuICAgICAgcmV0dXJuICFwcmV2O1xuICAgIH0pO1xuICB9KTtcbiAgdmFyIF91c2VQb3BwZXIgPSByZWFjdFBvcHBlci51c2VQb3BwZXIocmVmZXJlbmNlRWxlbWVudCwgcG9wcGVyRWxlbWVudCwge1xuICAgICAgcGxhY2VtZW50OiBwb3BwZXJQb3NpdGlvbixcbiAgICAgIG1vZGlmaWVyczogW3tcbiAgICAgICAgbmFtZTogJ29mZnNldCcsXG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICBvZmZzZXQ6IFswLCA1XVxuICAgICAgICB9XG4gICAgICB9XVxuICAgIH0pLFxuICAgIHN0eWxlcyA9IF91c2VQb3BwZXIuc3R5bGVzLFxuICAgIGF0dHJpYnV0ZXMgPSBfdXNlUG9wcGVyLmF0dHJpYnV0ZXM7XG4gIHZhciBoYW5kbGVCZWxsQ2xpY2sgPSBmdW5jdGlvbiBoYW5kbGVCZWxsQ2xpY2soKSB7XG4gICAgc2V0Tm90aWZpY2F0aW9uc0RhdGEoZnVuY3Rpb24gKHByZXYpIHtcbiAgICAgIHJldHVybiBfZXh0ZW5kcyh7fSwgcHJldiwge1xuICAgICAgICBjb3VudDogMFxuICAgICAgfSk7XG4gICAgfSk7XG4gICAgdG9nZ2xlSW5ib3goZnVuY3Rpb24gKHByZXYpIHtcbiAgICAgIHJldHVybiAhcHJldjtcbiAgICB9KTtcbiAgfTtcbiAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KENvbnRhaW5lciQzLCBudWxsLCAvKiNfX1BVUkVfXyovUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChCZWxsQ29udGFpbmVyLCB7XG4gICAgb25DbGljazogaGFuZGxlQmVsbENsaWNrLFxuICAgIHJlZjogc2V0UmVmZXJlbmNlRWxlbWVudFxuICB9LCAvKiNfX1BVUkVfXyovUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChCYWRnZSwgbnVsbCksIC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KEJlbGwsIG51bGwpKSwgb3BlbkluYm94ICYmIC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIF9leHRlbmRzKHtcbiAgICByZWY6IHNldFBvcHBlckVsZW1lbnQsXG4gICAgc3R5bGU6IF9leHRlbmRzKHt9LCBzdHlsZXMucG9wcGVyLCB7XG4gICAgICB6SW5kZXg6IDk5OVxuICAgIH0pXG4gIH0sIGF0dHJpYnV0ZXMucG9wcGVyKSwgLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoTm90aWZpY2F0aW9uc0NvbnRhaW5lciwgbnVsbCkpKTtcbn1cbnZhciBDb250YWluZXIkMyA9IHN0eWxlZC5kaXYoX3RlbXBsYXRlT2JqZWN0JDYgfHwgKF90ZW1wbGF0ZU9iamVjdCQ2ID0gX3RhZ2dlZFRlbXBsYXRlTGl0ZXJhbExvb3NlKFtcIlxcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xcbiAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xcbiAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7XFxuICBsaW5lLWhlaWdodDogMTtcXG5cIl0pKSk7XG52YXIgQmVsbENvbnRhaW5lciA9IHN0eWxlZC5kaXYoX3RlbXBsYXRlT2JqZWN0MiQ0IHx8IChfdGVtcGxhdGVPYmplY3QyJDQgPSBfdGFnZ2VkVGVtcGxhdGVMaXRlcmFsTG9vc2UoW1wiXFxuICBwb3NpdGlvbjogcmVsYXRpdmU7XFxuICBtYXJnaW4tdG9wOiAxMnB4O1xcbiAgbWFyZ2luLXJpZ2h0OiAxMnB4O1xcbiAgY3Vyc29yOiBwb2ludGVyO1xcblwiXSkpKTtcblxudmFyIF90ZW1wbGF0ZU9iamVjdCQ3LCBfdGVtcGxhdGVPYmplY3QyJDUsIF90ZW1wbGF0ZU9iamVjdDMkNCwgX3RlbXBsYXRlT2JqZWN0NCQzLCBfdGVtcGxhdGVPYmplY3Q1JDM7XG5mdW5jdGlvbiBUb2FzdE5vdGlmaWNhdGlvbihfcmVmKSB7XG4gIHZhciBfdG9hc3QkYm9keVRleHQsIF90b2FzdCRib2R5VGV4dDIsIF9tZXNzYWdlJGF2YXRhcjIsIF9tZXNzYWdlJHRleHQsIF9tZXNzYWdlJHRleHQkcmVwbGFjZSwgX21lc3NhZ2UkdGV4dCRyZXBsYWNlMjtcbiAgdmFyIG5vdGlmaWNhdGlvbkRhdGEgPSBfcmVmLm5vdGlmaWNhdGlvbkRhdGEsXG4gICAgY2xvc2VUb2FzdCA9IF9yZWYuY2xvc2VUb2FzdDtcbiAgdmFyIF91c2VUaGVtZSA9IHVzZVRoZW1lKCksXG4gICAgdG9hc3QgPSBfdXNlVGhlbWUudG9hc3Q7XG4gIHZhciBfdXNlSW5ib3ggPSB1c2VJbmJveCgpLFxuICAgIHRvZ2dsZUluYm94ID0gX3VzZUluYm94LnRvZ2dsZUluYm94LFxuICAgIHRoZW1lVHlwZSA9IF91c2VJbmJveC50aGVtZVR5cGU7XG4gIHZhciBtZXNzYWdlID0gbm90aWZpY2F0aW9uRGF0YS5tZXNzYWdlO1xuICB2YXIgX3VzZVN0YXRlID0gUmVhY3QudXNlU3RhdGUoZmFsc2UpLFxuICAgIHZhbGlkQXZhdGFyID0gX3VzZVN0YXRlWzBdLFxuICAgIHNldFZhbGlkQXZhdGFyID0gX3VzZVN0YXRlWzFdO1xuICBSZWFjdC51c2VFZmZlY3QoZnVuY3Rpb24gKCkge1xuICAgIHZhciBfbWVzc2FnZSRhdmF0YXI7XG4gICAgdmFyIGlzVmFsaWRBdmF0YXIgPSBpc0ltZ1VybChtZXNzYWdlID09PSBudWxsIHx8IG1lc3NhZ2UgPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfbWVzc2FnZSRhdmF0YXIgPSBtZXNzYWdlLmF2YXRhcikgPT09IG51bGwgfHwgX21lc3NhZ2UkYXZhdGFyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfbWVzc2FnZSRhdmF0YXIuYXZhdGFyX3VybCk7XG4gICAgaXNWYWxpZEF2YXRhci50aGVuKGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgIHJldHVybiBzZXRWYWxpZEF2YXRhcihyZXMpO1xuICAgIH0pO1xuICB9LCBbbm90aWZpY2F0aW9uRGF0YV0pO1xuICB2YXIgYmxvY2txdW90ZUNvbG9yID0gKHRvYXN0ID09PSBudWxsIHx8IHRvYXN0ID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX3RvYXN0JGJvZHlUZXh0ID0gdG9hc3QuYm9keVRleHQpID09PSBudWxsIHx8IF90b2FzdCRib2R5VGV4dCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RvYXN0JGJvZHlUZXh0LmJsb2NrcXVvdGVDb2xvcikgfHwgbGlnaHRDb2xvcnMuYm9yZGVyO1xuICB2YXIgbGlua0NvbG9yID0gKHRvYXN0ID09PSBudWxsIHx8IHRvYXN0ID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX3RvYXN0JGJvZHlUZXh0MiA9IHRvYXN0LmJvZHlUZXh0KSA9PT0gbnVsbCB8fCBfdG9hc3QkYm9keVRleHQyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdG9hc3QkYm9keVRleHQyLmxpbmtDb2xvcikgfHwgbGlnaHRDb2xvcnMucHJpbWFyeTtcbiAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KENvbnRhaW5lciQ0LCB7XG4gICAgc3R5bGU6IHRvYXN0ID09PSBudWxsIHx8IHRvYXN0ID09PSB2b2lkIDAgPyB2b2lkIDAgOiB0b2FzdC5jb250YWluZXIsXG4gICAgb25DbGljazogZnVuY3Rpb24gb25DbGljayhlKSB7XG4gICAgICB0b2dnbGVJbmJveCh0cnVlKTtcbiAgICAgIGNsb3NlVG9hc3QoKTtcbiAgICB9XG4gIH0sIC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KEF2YXRhclZpZXckMSwgbnVsbCwgbWVzc2FnZSAhPT0gbnVsbCAmJiBtZXNzYWdlICE9PSB2b2lkIDAgJiYgKF9tZXNzYWdlJGF2YXRhcjIgPSBtZXNzYWdlLmF2YXRhcikgIT09IG51bGwgJiYgX21lc3NhZ2UkYXZhdGFyMiAhPT0gdm9pZCAwICYmIF9tZXNzYWdlJGF2YXRhcjIuYXZhdGFyX3VybCAmJiB2YWxpZEF2YXRhciA/IC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KEF2YXRhckltYWdlJDEsIHtcbiAgICBzcmM6IG1lc3NhZ2UuYXZhdGFyLmF2YXRhcl91cmwsXG4gICAgYWx0OiBcImF2YXRhclwiXG4gIH0pIDogLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoQXZhdGFySWNvbiwge1xuICAgIHR5cGU6IHRoZW1lVHlwZVxuICB9KSksIC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIG51bGwsIC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KEhlYWRlclRleHQkMiwge1xuICAgIHN0eWxlOiB0b2FzdCA9PT0gbnVsbCB8fCB0b2FzdCA9PT0gdm9pZCAwID8gdm9pZCAwIDogdG9hc3QuaGVhZGVyVGV4dFxuICB9LCBtZXNzYWdlLmhlYWRlciksIC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KEJvZHlUZXh0JDEsIHtcbiAgICBzdHlsZTogdG9hc3QgPT09IG51bGwgfHwgdG9hc3QgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHRvYXN0LmJvZHlUZXh0XG4gIH0sIC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KE1hcmtkb3duLCB7XG4gICAgY29tcG9uZW50czoge1xuICAgICAgYTogZnVuY3Rpb24gYShfcmVmMikge1xuICAgICAgICB2YXIgY2hpbGRyZW4gPSBfcmVmMi5jaGlsZHJlbixcbiAgICAgICAgICBocmVmID0gX3JlZjIuaHJlZjtcbiAgICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KFwiYVwiLCB7XG4gICAgICAgICAgaHJlZjogaHJlZixcbiAgICAgICAgICBzdHlsZToge1xuICAgICAgICAgICAgY29sb3I6IGxpbmtDb2xvcixcbiAgICAgICAgICAgIHRleHREZWNvcmF0aW9uOiAnbm9uZSdcbiAgICAgICAgICB9XG4gICAgICAgIH0sIGNoaWxkcmVuKTtcbiAgICAgIH0sXG4gICAgICBwOiBmdW5jdGlvbiBwKF9yZWYzKSB7XG4gICAgICAgIHZhciBjaGlsZHJlbiA9IF9yZWYzLmNoaWxkcmVuO1xuICAgICAgICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXCJwXCIsIHtcbiAgICAgICAgICBzdHlsZToge1xuICAgICAgICAgICAgbWFyZ2luOiAwLFxuICAgICAgICAgICAgb3ZlcmZsb3dXcmFwOiAnYW55d2hlcmUnXG4gICAgICAgICAgfVxuICAgICAgICB9LCBjaGlsZHJlbik7XG4gICAgICB9LFxuICAgICAgYmxvY2txdW90ZTogZnVuY3Rpb24gYmxvY2txdW90ZShfcmVmNCkge1xuICAgICAgICB2YXIgY2hpbGRyZW4gPSBfcmVmNC5jaGlsZHJlbjtcbiAgICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KFwiYmxvY2txdW90ZVwiLCB7XG4gICAgICAgICAgc3R5bGU6IHtcbiAgICAgICAgICAgIG1hcmdpbjogMCxcbiAgICAgICAgICAgIHBhZGRpbmdMZWZ0OiAxMCxcbiAgICAgICAgICAgIGJvcmRlckxlZnQ6IFwiM3B4IFwiICsgYmxvY2txdW90ZUNvbG9yICsgXCIgc29saWRcIixcbiAgICAgICAgICAgIG1hcmdpbkJvdHRvbTogNSxcbiAgICAgICAgICAgIG1hcmdpblRvcDogNVxuICAgICAgICAgIH1cbiAgICAgICAgfSwgY2hpbGRyZW4pO1xuICAgICAgfSxcbiAgICAgIHVsOiBmdW5jdGlvbiB1bChfcmVmNSkge1xuICAgICAgICB2YXIgY2hpbGRyZW4gPSBfcmVmNS5jaGlsZHJlbjtcbiAgICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KFwidWxcIiwge1xuICAgICAgICAgIHN0eWxlOiB7XG4gICAgICAgICAgICB3aGl0ZVNwYWNlOiAnbm9ybWFsJyxcbiAgICAgICAgICAgIG1hcmdpbjogMCxcbiAgICAgICAgICAgIHBhZGRpbmdMZWZ0OiAxMFxuICAgICAgICAgIH1cbiAgICAgICAgfSwgY2hpbGRyZW4pO1xuICAgICAgfSxcbiAgICAgIG9sOiBmdW5jdGlvbiBvbChfcmVmNikge1xuICAgICAgICB2YXIgY2hpbGRyZW4gPSBfcmVmNi5jaGlsZHJlbjtcbiAgICAgICAgcmV0dXJuIC8qI19fUFVSRV9fKi9SZWFjdF9fZGVmYXVsdC5jcmVhdGVFbGVtZW50KFwib2xcIiwge1xuICAgICAgICAgIHN0eWxlOiB7XG4gICAgICAgICAgICB3aGl0ZVNwYWNlOiAnbm9ybWFsJyxcbiAgICAgICAgICAgIG1hcmdpbjogMCxcbiAgICAgICAgICAgIHBhZGRpbmdMZWZ0OiAxMFxuICAgICAgICAgIH1cbiAgICAgICAgfSwgY2hpbGRyZW4pO1xuICAgICAgfSxcbiAgICAgIGltZzogZnVuY3Rpb24gaW1nKHByb3BzKSB7XG4gICAgICAgIHJldHVybiAvKiNfX1BVUkVfXyovUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChcImltZ1wiLCBfZXh0ZW5kcyh7XG4gICAgICAgICAgc3R5bGU6IHtcbiAgICAgICAgICAgIG1heFdpZHRoOiAnMTAwJScsXG4gICAgICAgICAgICBvYmplY3RGaXQ6ICdjb250YWluJ1xuICAgICAgICAgIH1cbiAgICAgICAgfSwgcHJvcHMpKTtcbiAgICAgIH1cbiAgICB9XG4gIH0sIG1lc3NhZ2UgPT09IG51bGwgfHwgbWVzc2FnZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9tZXNzYWdlJHRleHQgPSBtZXNzYWdlLnRleHQpID09PSBudWxsIHx8IF9tZXNzYWdlJHRleHQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfbWVzc2FnZSR0ZXh0JHJlcGxhY2UgPSBfbWVzc2FnZSR0ZXh0LnJlcGxhY2VBbGwoJ1xcXFxcXG4nLCAnJm5ic3A7JykpID09PSBudWxsIHx8IF9tZXNzYWdlJHRleHQkcmVwbGFjZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9tZXNzYWdlJHRleHQkcmVwbGFjZTIgPSBfbWVzc2FnZSR0ZXh0JHJlcGxhY2UucmVwbGFjZUFsbCgnXFxuJywgJyAgXFxuJykpID09PSBudWxsIHx8IF9tZXNzYWdlJHRleHQkcmVwbGFjZTIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9tZXNzYWdlJHRleHQkcmVwbGFjZTIucmVwbGFjZUFsbCgnJm5ic3A7JywgJyZuYnNwOyAgXFxuJykpKSkpO1xufVxudmFyIENvbnRhaW5lciQ0ID0gc3R5bGVkLmRpdihfdGVtcGxhdGVPYmplY3QkNyB8fCAoX3RlbXBsYXRlT2JqZWN0JDcgPSBfdGFnZ2VkVGVtcGxhdGVMaXRlcmFsTG9vc2UoW1wiXFxuICBiYWNrZ3JvdW5kLWNvbG9yOiBcIiwgXCI7XFxuICBjdXJzb3I6IHBvaW50ZXI7XFxuICBwYWRkaW5nOiAxNHB4O1xcbiAgZGlzcGxheTogZmxleDtcXG4gIG92ZXJmbG93LXdyYXA6IGFueXdoZXJlO1xcblwiXSkpLCBsaWdodENvbG9ycy5tYWluKTtcbnZhciBIZWFkZXJUZXh0JDIgPSBzdHlsZWQoQ1RleHQpKF90ZW1wbGF0ZU9iamVjdDIkNSB8fCAoX3RlbXBsYXRlT2JqZWN0MiQ1ID0gX3RhZ2dlZFRlbXBsYXRlTGl0ZXJhbExvb3NlKFtcIlxcbiAgZm9udC1zaXplOiAxM3B4O1xcbiAgbGluZS1oZWlnaHQ6IDE2cHg7XFxuICBmb250LXdlaWdodDogNzAwO1xcbiAgbWFyZ2luOiAxMHB4IDBweDtcXG5cIl0pKSk7XG52YXIgQm9keVRleHQkMSA9IHN0eWxlZC5kaXYoX3RlbXBsYXRlT2JqZWN0MyQ0IHx8IChfdGVtcGxhdGVPYmplY3QzJDQgPSBfdGFnZ2VkVGVtcGxhdGVMaXRlcmFsTG9vc2UoW1wiXFxuICBmb250LXNpemU6IDEycHg7XFxuICBsaW5lLWhlaWdodDogMThweDtcXG4gIGZvbnQtd2VpZ2h0OiA0MDA7XFxuICBmb250LWZhbWlseTogLWFwcGxlLXN5c3RlbSwgQmxpbmtNYWNTeXN0ZW1Gb250LCAnU2Vnb2UgVUknLCBSb2JvdG8sIEhlbHZldGljYSxcXG4gICAgQXJpYWwsIHNhbnMtc2VyaWYsICdBcHBsZSBDb2xvciBFbW9qaScsICdTZWdvZSBVSSBFbW9qaScsICdTZWdvZSBVSSBTeW1ib2wnO1xcbiAgY29sb3I6IFwiLCBcIjtcXG4gIG1hcmdpbjogMTBweCAwcHg7XFxuICBjb2xvcjogXCIsIFwiO1xcblwiXSkpLCBsaWdodENvbG9ycy5wcmltYXJ5VGV4dCwgbGlnaHRDb2xvcnMucHJpbWFyeVRleHQpO1xudmFyIEF2YXRhckltYWdlJDEgPSBzdHlsZWQuaW1nKF90ZW1wbGF0ZU9iamVjdDQkMyB8fCAoX3RlbXBsYXRlT2JqZWN0NCQzID0gX3RhZ2dlZFRlbXBsYXRlTGl0ZXJhbExvb3NlKFtcIlxcbiAgaGVpZ2h0OiAzNnB4O1xcbiAgd2lkdGg6IDM2cHg7XFxuICBib3JkZXItcmFkaXVzOiAxMDBweDtcXG5cIl0pKSk7XG52YXIgQXZhdGFyVmlldyQxID0gc3R5bGVkLmRpdihfdGVtcGxhdGVPYmplY3Q1JDMgfHwgKF90ZW1wbGF0ZU9iamVjdDUkMyA9IF90YWdnZWRUZW1wbGF0ZUxpdGVyYWxMb29zZShbXCJcXG4gIG1hcmdpbi10b3A6IDhweDtcXG4gIG1hcmdpbi1yaWdodDogMTJweDtcXG5cIl0pKSk7XG5cbnZhciBfdGVtcGxhdGVPYmplY3QkODtcbmZ1bmN0aW9uIFRvYXN0KF9yZWYpIHtcbiAgdmFyIHBvc2l0aW9uID0gX3JlZi5wb3NpdGlvbixcbiAgICBkdXJhdGlvbiA9IF9yZWYuZHVyYXRpb24sXG4gICAgbGltaXQgPSBfcmVmLmxpbWl0O1xuICB2YXIgdG9hc3REdXJhdGlvbiA9IGR1cmF0aW9uIHx8IDMwMDA7XG4gIHZhciB0b2FzdHNMaW1pdCA9IGxpbWl0IHx8IDM7XG4gIHZhciB0b2FzdFBvc2l0aW9uID0gIXBvc2l0aW9uID8gd2luZG93LmlubmVyV2lkdGggPiA0MjUgPyAnYm90dG9tLXJpZ2h0JyA6ICdib3R0b20tY2VudGVyJyA6IHBvc2l0aW9uO1xuICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoU3R5bGVkQ29udGFpbmVyLCB7XG4gICAgYXV0b0Nsb3NlOiB0b2FzdER1cmF0aW9uLFxuICAgIHBvc2l0aW9uOiB0b2FzdFBvc2l0aW9uLFxuICAgIGxpbWl0OiB0b2FzdHNMaW1pdCxcbiAgICBoaWRlUHJvZ3Jlc3NCYXI6IHRydWUsXG4gICAgcGF1c2VPbkhvdmVyOiBmYWxzZSxcbiAgICBjbG9zZUJ1dHRvbjogZmFsc2UsXG4gICAgcGF1c2VPbkZvY3VzTG9zczogZmFsc2VcbiAgfSk7XG59XG5mdW5jdGlvbiBub3RpZnkoX3JlZjIpIHtcbiAgdmFyIG5vdGlmaWNhdGlvbnNEYXRhID0gX3JlZjIubm90aWZpY2F0aW9uc0RhdGEsXG4gICAgdG9hc3RQcm9wcyA9IF9yZWYyLnRvYXN0UHJvcHM7XG4gIHZhciBUb2FzdE5vdGlmaWNhdGlvbkNvbXBvbmVudCA9ICh0b2FzdFByb3BzID09PSBudWxsIHx8IHRvYXN0UHJvcHMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHRvYXN0UHJvcHMudG9hc3RDb21wb25lbnQpIHx8IFRvYXN0Tm90aWZpY2F0aW9uO1xuICBpZiAoZG9jdW1lbnQuaGlkZGVuKSByZXR1cm47XG4gIHZhciB0b2FzdElkID0gcmVhY3RUb2FzdGlmeS50b2FzdCggLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoVG9hc3ROb3RpZmljYXRpb25Db21wb25lbnQsIHtcbiAgICBub3RpZmljYXRpb25EYXRhOiBub3RpZmljYXRpb25zRGF0YSxcbiAgICBjbG9zZVRvYXN0OiBmdW5jdGlvbiBjbG9zZVRvYXN0KCkge1xuICAgICAgcmVhY3RUb2FzdGlmeS50b2FzdC5kaXNtaXNzKHtcbiAgICAgICAgaWQ6IHRvYXN0SWRcbiAgICAgIH0pO1xuICAgIH1cbiAgfSkpO1xufVxudmFyIFN0eWxlZENvbnRhaW5lciA9IHN0eWxlZChyZWFjdFRvYXN0aWZ5LlRvYXN0Q29udGFpbmVyKShfdGVtcGxhdGVPYmplY3QkOCB8fCAoX3RlbXBsYXRlT2JqZWN0JDggPSBfdGFnZ2VkVGVtcGxhdGVMaXRlcmFsTG9vc2UoW1wiXFxuICAmLlRvYXN0aWZ5X190b2FzdC1jb250YWluZXIge1xcbiAgICBtYXgtd2lkdGg6IDQ1MHB4O1xcbiAgICBtaW4td2lkdGg6IDMwMHB4O1xcbiAgICBwYWRkaW5nOiAwcHg7XFxuICAgIHdpZHRoOiB1bnNldDtcXG4gIH1cXG5cXG4gIC5Ub2FzdGlmeV9fdG9hc3QtdGhlbWUtLWxpZ2h0LFxcbiAgLlRvYXN0aWZ5X190b2FzdC10aGVtZS0tZGVmYXVsdCxcXG4gIC5Ub2FzdGlmeV9fdG9hc3QtdGhlbWUtLWRhcmsge1xcbiAgICBwYWRkaW5nOiAwcHg7XFxuICAgIGJvcmRlci1yYWRpdXM6IDVweDtcXG4gICAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7XFxuICB9XFxuXFxuICAuVG9hc3RpZnlfX3RvYXN0LWJvZHkge1xcbiAgICBwYWRkaW5nOiAwcHg7XFxuICB9XFxuXCJdKSkpO1xuXG52YXIgaW5pdGlhbE5vdGlmaWNhdGlvbkRhdGEgPSB7XG4gIHN0b3JlRGF0YToge30sXG4gIHVuc2VlbkNvdW50OiAwLFxuICBoYXNOZXh0OiBmYWxzZSxcbiAgaW5pdGlhbExvYWRpbmc6IGZhbHNlLFxuICBmZXRjaE1vcmVMb2FkaW5nOiBmYWxzZVxufTtcbnZhciBJbmJveENvbnRleHQkMSA9IFJlYWN0LmNyZWF0ZUNvbnRleHQoe1xuICBub3RpZmljYXRpb25zRGF0YTogaW5pdGlhbE5vdGlmaWNhdGlvbkRhdGFcbn0pO1xuZnVuY3Rpb24gU3VwclNlbmRQcm92aWRlcihfcmVmKSB7XG4gIHZhciBjaGlsZHJlbiA9IF9yZWYuY2hpbGRyZW4sXG4gICAgd29ya3NwYWNlS2V5ID0gX3JlZi53b3Jrc3BhY2VLZXksXG4gICAgZGlzdGluY3RJZCA9IF9yZWYuZGlzdGluY3RJZCxcbiAgICBzdWJzY3JpYmVySWQgPSBfcmVmLnN1YnNjcmliZXJJZCxcbiAgICBpbmJveElkID0gX3JlZi5pbmJveElkLFxuICAgIHRlbmFudElkID0gX3JlZi50ZW5hbnRJZCxcbiAgICBzdG9yZXMgPSBfcmVmLnN0b3JlcyxcbiAgICBwYWdlU2l6ZSA9IF9yZWYucGFnZVNpemU7XG4gIGlmIChpbmJveElkKSB7XG4gICAgc3Vic2NyaWJlcklkID0gaW5ib3hJZDtcbiAgfVxuICB2YXIgX3VzZVN0YXRlID0gUmVhY3QudXNlU3RhdGUoKSxcbiAgICBpbmJveCA9IF91c2VTdGF0ZVswXSxcbiAgICBzZXRJbmJveCA9IF91c2VTdGF0ZVsxXTtcbiAgdmFyIF91c2VTdGF0ZTIgPSBSZWFjdC51c2VTdGF0ZShfZXh0ZW5kcyh7fSwgaW5pdGlhbE5vdGlmaWNhdGlvbkRhdGEpKSxcbiAgICBub3RpZmljYXRpb25zRGF0YSA9IF91c2VTdGF0ZTJbMF0sXG4gICAgc2V0Tm90aWZpY2F0aW9uc0RhdGEgPSBfdXNlU3RhdGUyWzFdO1xuICBSZWFjdC51c2VFZmZlY3QoZnVuY3Rpb24gKCkge1xuICAgIHZhciBpbmJveEluc3QgPSBuZXcgU3VwcnNlbmRKU0luYm94KHdvcmtzcGFjZUtleSwge1xuICAgICAgcGFnZVNpemU6IHBhZ2VTaXplLFxuICAgICAgdGVuYW50SUQ6IHRlbmFudElkLFxuICAgICAgc3RvcmVzOiBzdG9yZXNcbiAgICB9KTtcbiAgICBzZXRJbmJveChpbmJveEluc3QpO1xuICAgIGluYm94SW5zdC5lbWl0dGVyLm9uKCdzeW5jX25vdGlmX3N0b3JlJywgZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIGluYm94RGF0YSA9IGluYm94SW5zdC5mZWVkLmRhdGE7XG4gICAgICBzZXROb3RpZmljYXRpb25zRGF0YSh7XG4gICAgICAgIHN0b3JlRGF0YTogKGluYm94RGF0YSA9PT0gbnVsbCB8fCBpbmJveERhdGEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGluYm94RGF0YS5zdG9yZXMpIHx8IHt9LFxuICAgICAgICBjb3VudDogKGluYm94RGF0YSA9PT0gbnVsbCB8fCBpbmJveERhdGEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGluYm94RGF0YS51bnNlZW5Db3VudCkgfHwgMCxcbiAgICAgICAgaGFzTmV4dDogaW5ib3hEYXRhID09PSBudWxsIHx8IGluYm94RGF0YSA9PT0gdm9pZCAwID8gdm9pZCAwIDogaW5ib3hEYXRhLmhhc05leHQsXG4gICAgICAgIGluaXRpYWxMb2FkaW5nOiBpbmJveERhdGEgPT09IG51bGwgfHwgaW5ib3hEYXRhID09PSB2b2lkIDAgPyB2b2lkIDAgOiBpbmJveERhdGEuaW5pdGlhbExvYWRpbmcsXG4gICAgICAgIGZldGNoTW9yZUxvYWRpbmc6IGluYm94RGF0YSA9PT0gbnVsbCB8fCBpbmJveERhdGEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGluYm94RGF0YS5mZXRjaE1vcmVMb2FkaW5nLFxuICAgICAgICBhY3RpdmVTdG9yZUlkOiBpbmJveERhdGEgPT09IG51bGwgfHwgaW5ib3hEYXRhID09PSB2b2lkIDAgPyB2b2lkIDAgOiBpbmJveERhdGEuYWN0aXZlU3RvcmVJZFxuICAgICAgfSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgIGluYm94SW5zdC5lbWl0dGVyLmFsbC5jbGVhcigpO1xuICAgIH07XG4gIH0sIFtdKTtcbiAgUmVhY3QudXNlRWZmZWN0KGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXN1YnNjcmliZXJJZCB8fCAhaW5ib3gpIHJldHVybjtcbiAgICBpbmJveC5pZGVudGlmeVVzZXIoZGlzdGluY3RJZCwgc3Vic2NyaWJlcklkKTtcbiAgICBpbmJveC5mZWVkLmZldGNoTm90aWZpY2F0aW9ucygpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICBpbmJveC5yZXNldFVzZXIoKTtcbiAgICB9O1xuICB9LCBbc3Vic2NyaWJlcklkLCBpbmJveF0pO1xuICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoSW5ib3hDb250ZXh0JDEuUHJvdmlkZXIsIHtcbiAgICB2YWx1ZToge1xuICAgICAgaW5ib3g6IGluYm94LFxuICAgICAgbm90aWZpY2F0aW9uc0RhdGE6IG5vdGlmaWNhdGlvbnNEYXRhLFxuICAgICAgc3Vic2NyaWJlcklkOiBzdWJzY3JpYmVySWRcbiAgICB9XG4gIH0sIGNoaWxkcmVuKTtcbn1cblxuZnVuY3Rpb24gdXNlTm90aWZpY2F0aW9ucyhzdG9yZUlkKSB7XG4gIHZhciBfaW5ib3hEYXRhJGluYm94LCBfbm90aWZpY2F0aW9uc0ZlZWQkc3QsIF9ub3RpZmljYXRpb25zRmVlZCRzdDIsIF9pbmJveERhdGEkbm90aWZpY2F0aSwgX2luYm94RGF0YSRub3RpZmljYXRpMjtcbiAgdmFyIGluYm94RGF0YSA9IFJlYWN0LnVzZUNvbnRleHQoSW5ib3hDb250ZXh0JDEpO1xuICB2YXIgbm90aWZpY2F0aW9uc0ZlZWQgPSAoX2luYm94RGF0YSRpbmJveCA9IGluYm94RGF0YS5pbmJveCkgPT09IG51bGwgfHwgX2luYm94RGF0YSRpbmJveCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2luYm94RGF0YSRpbmJveC5mZWVkO1xuICBSZWFjdC51c2VFZmZlY3QoZnVuY3Rpb24gKCkge1xuICAgIGlmIChpbmJveERhdGEgIT09IG51bGwgJiYgaW5ib3hEYXRhICE9PSB2b2lkIDAgJiYgaW5ib3hEYXRhLmluYm94ICYmIHN0b3JlSWQpIHtcbiAgICAgIGluYm94RGF0YS5pbmJveC5jaGFuZ2VBY3RpdmVTdG9yZShzdG9yZUlkKTtcbiAgICB9XG4gIH0sIFtzdG9yZUlkLCBpbmJveERhdGEgPT09IG51bGwgfHwgaW5ib3hEYXRhID09PSB2b2lkIDAgPyB2b2lkIDAgOiBpbmJveERhdGEuaW5ib3gsIGluYm94RGF0YSA9PT0gbnVsbCB8fCBpbmJveERhdGEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGluYm94RGF0YS5zdWJzY3JpYmVySWRdKTtcbiAgdmFyIGZpcnN0U3RvcmUgPSAobm90aWZpY2F0aW9uc0ZlZWQgPT09IG51bGwgfHwgbm90aWZpY2F0aW9uc0ZlZWQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfbm90aWZpY2F0aW9uc0ZlZWQkc3QgPSBub3RpZmljYXRpb25zRmVlZC5zdG9yZXMpID09PSBudWxsIHx8IF9ub3RpZmljYXRpb25zRmVlZCRzdCA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9ub3RpZmljYXRpb25zRmVlZCRzdDIgPSBfbm90aWZpY2F0aW9uc0ZlZWQkc3RbMF0pID09PSBudWxsIHx8IF9ub3RpZmljYXRpb25zRmVlZCRzdDIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9ub3RpZmljYXRpb25zRmVlZCRzdDIuc3RvcmVJZCkgfHwgJ2RlZmF1bHRfc3RvcmUnO1xuICB2YXIgYWN0aXZlU3RvcmVJZCA9IHN0b3JlSWQgfHwgZmlyc3RTdG9yZTtcbiAgdmFyIGFjdGl2ZVN0b3JlRGF0YSA9IGluYm94RGF0YSA9PT0gbnVsbCB8fCBpbmJveERhdGEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfaW5ib3hEYXRhJG5vdGlmaWNhdGkgPSBpbmJveERhdGEubm90aWZpY2F0aW9uc0RhdGEpID09PSBudWxsIHx8IF9pbmJveERhdGEkbm90aWZpY2F0aSA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9pbmJveERhdGEkbm90aWZpY2F0aTIgPSBfaW5ib3hEYXRhJG5vdGlmaWNhdGkuc3RvcmVEYXRhKSA9PT0gbnVsbCB8fCBfaW5ib3hEYXRhJG5vdGlmaWNhdGkyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfaW5ib3hEYXRhJG5vdGlmaWNhdGkyW2FjdGl2ZVN0b3JlSWRdO1xuICByZXR1cm4ge1xuICAgIG5vdGlmaWNhdGlvbnM6IChhY3RpdmVTdG9yZURhdGEgPT09IG51bGwgfHwgYWN0aXZlU3RvcmVEYXRhID09PSB2b2lkIDAgPyB2b2lkIDAgOiBhY3RpdmVTdG9yZURhdGEubm90aWZpY2F0aW9ucykgfHwgW10sXG4gICAgaW5pdGlhbExvYWRpbmc6IGluYm94RGF0YS5ub3RpZmljYXRpb25zRGF0YS5pbml0aWFsTG9hZGluZyxcbiAgICBoYXNOZXh0OiBpbmJveERhdGEubm90aWZpY2F0aW9uc0RhdGEuaGFzTmV4dCxcbiAgICBmZXRjaE1vcmVMb2FkaW5nOiBpbmJveERhdGEubm90aWZpY2F0aW9uc0RhdGEuZmV0Y2hNb3JlTG9hZGluZyxcbiAgICBtYXJrQ2xpY2tlZDogbm90aWZpY2F0aW9uc0ZlZWQgPT09IG51bGwgfHwgbm90aWZpY2F0aW9uc0ZlZWQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IG5vdGlmaWNhdGlvbnNGZWVkLm1hcmtDbGlja2VkLmJpbmQobm90aWZpY2F0aW9uc0ZlZWQpLFxuICAgIG1hcmtSZWFkOiBub3RpZmljYXRpb25zRmVlZCA9PT0gbnVsbCB8fCBub3RpZmljYXRpb25zRmVlZCA9PT0gdm9pZCAwID8gdm9pZCAwIDogbm90aWZpY2F0aW9uc0ZlZWQubWFya1JlYWQuYmluZChub3RpZmljYXRpb25zRmVlZCksXG4gICAgbWFya1VuUmVhZDogbm90aWZpY2F0aW9uc0ZlZWQgPT09IG51bGwgfHwgbm90aWZpY2F0aW9uc0ZlZWQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IG5vdGlmaWNhdGlvbnNGZWVkLm1hcmtVblJlYWQuYmluZChub3RpZmljYXRpb25zRmVlZCksXG4gICAgbWFya0FyY2hpdmVkOiBub3RpZmljYXRpb25zRmVlZCA9PT0gbnVsbCB8fCBub3RpZmljYXRpb25zRmVlZCA9PT0gdm9pZCAwID8gdm9pZCAwIDogbm90aWZpY2F0aW9uc0ZlZWQubWFya0FyY2hpdmVkLmJpbmQobm90aWZpY2F0aW9uc0ZlZWQpLFxuICAgIG1hcmtBbGxTZWVuOiBub3RpZmljYXRpb25zRmVlZCA9PT0gbnVsbCB8fCBub3RpZmljYXRpb25zRmVlZCA9PT0gdm9pZCAwID8gdm9pZCAwIDogbm90aWZpY2F0aW9uc0ZlZWQubWFya0FsbFNlZW4uYmluZChub3RpZmljYXRpb25zRmVlZCksXG4gICAgbWFya0FsbFJlYWQ6IG5vdGlmaWNhdGlvbnNGZWVkID09PSBudWxsIHx8IG5vdGlmaWNhdGlvbnNGZWVkID09PSB2b2lkIDAgPyB2b2lkIDAgOiBub3RpZmljYXRpb25zRmVlZC5tYXJrQWxsUmVhZC5iaW5kKG5vdGlmaWNhdGlvbnNGZWVkKSxcbiAgICBmZXRjaFByZXZpb3VzOiBub3RpZmljYXRpb25zRmVlZCA9PT0gbnVsbCB8fCBub3RpZmljYXRpb25zRmVlZCA9PT0gdm9pZCAwID8gdm9pZCAwIDogbm90aWZpY2F0aW9uc0ZlZWQuZmV0Y2hOb3RpZmljYXRpb25zLmJpbmQobm90aWZpY2F0aW9uc0ZlZWQpXG4gIH07XG59XG5cbmZ1bmN0aW9uIHVzZUJlbGwoKSB7XG4gIHZhciBfaW5ib3hEYXRhJGluYm94LCBfaW5ib3hEYXRhJGluYm94JGZlZWQsIF9pbmJveERhdGEkaW5ib3gyO1xuICB2YXIgaW5ib3hEYXRhID0gUmVhY3QudXNlQ29udGV4dChJbmJveENvbnRleHQkMSk7XG4gIHJldHVybiB7XG4gICAgdW5TZWVuQ291bnQ6IGluYm94RGF0YS5ub3RpZmljYXRpb25zRGF0YS5jb3VudCxcbiAgICBtYXJrQWxsU2VlbjogKF9pbmJveERhdGEkaW5ib3ggPSBpbmJveERhdGEuaW5ib3gpID09PSBudWxsIHx8IF9pbmJveERhdGEkaW5ib3ggPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfaW5ib3hEYXRhJGluYm94JGZlZWQgPSBfaW5ib3hEYXRhJGluYm94LmZlZWQubWFya0FsbFNlZW4pID09PSBudWxsIHx8IF9pbmJveERhdGEkaW5ib3gkZmVlZCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2luYm94RGF0YSRpbmJveCRmZWVkLmJpbmQoKF9pbmJveERhdGEkaW5ib3gyID0gaW5ib3hEYXRhLmluYm94KSA9PT0gbnVsbCB8fCBfaW5ib3hEYXRhJGluYm94MiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2luYm94RGF0YSRpbmJveDIuZmVlZClcbiAgfTtcbn1cbmZ1bmN0aW9uIHVzZVVuc2VlbkNvdW50KCkge1xuICB2YXIgX2luYm94RGF0YSRpbmJveDMsIF9pbmJveERhdGEkaW5ib3gzJGZlZSwgX2luYm94RGF0YSRpbmJveDQ7XG4gIHZhciBpbmJveERhdGEgPSBSZWFjdC51c2VDb250ZXh0KEluYm94Q29udGV4dCQxKTtcbiAgcmV0dXJuIHtcbiAgICB1blNlZW5Db3VudDogaW5ib3hEYXRhLm5vdGlmaWNhdGlvbnNEYXRhLmNvdW50LFxuICAgIG1hcmtBbGxTZWVuOiAoX2luYm94RGF0YSRpbmJveDMgPSBpbmJveERhdGEuaW5ib3gpID09PSBudWxsIHx8IF9pbmJveERhdGEkaW5ib3gzID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX2luYm94RGF0YSRpbmJveDMkZmVlID0gX2luYm94RGF0YSRpbmJveDMuZmVlZC5tYXJrQWxsU2VlbikgPT09IG51bGwgfHwgX2luYm94RGF0YSRpbmJveDMkZmVlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfaW5ib3hEYXRhJGluYm94MyRmZWUuYmluZCgoX2luYm94RGF0YSRpbmJveDQgPSBpbmJveERhdGEuaW5ib3gpID09PSBudWxsIHx8IF9pbmJveERhdGEkaW5ib3g0ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfaW5ib3hEYXRhJGluYm94NC5mZWVkKVxuICB9O1xufVxuXG5mdW5jdGlvbiB1c2VFdmVudChldmVudE5hbWUsIGNhbGxiYWNrKSB7XG4gIHZhciBpbmJveERhdGEgPSBSZWFjdC51c2VDb250ZXh0KEluYm94Q29udGV4dCQxKTtcbiAgUmVhY3QudXNlRWZmZWN0KGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgX2luYm94RGF0YSRpbmJveDtcbiAgICB2YXIgZW1pdHRlciA9IGluYm94RGF0YSA9PT0gbnVsbCB8fCBpbmJveERhdGEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IChfaW5ib3hEYXRhJGluYm94ID0gaW5ib3hEYXRhLmluYm94KSA9PT0gbnVsbCB8fCBfaW5ib3hEYXRhJGluYm94ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfaW5ib3hEYXRhJGluYm94LmVtaXR0ZXI7XG4gICAgaWYgKGVtaXR0ZXIpIHtcbiAgICAgIGVtaXR0ZXIub24oZXZlbnROYW1lLCBjYWxsYmFjayk7XG4gICAgfVxuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gZW1pdHRlciA9PT0gbnVsbCB8fCBlbWl0dGVyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBlbWl0dGVyLm9mZihldmVudE5hbWUpO1xuICAgIH07XG4gIH0sIFtpbmJveERhdGEgPT09IG51bGwgfHwgaW5ib3hEYXRhID09PSB2b2lkIDAgPyB2b2lkIDAgOiBpbmJveERhdGEuaW5ib3hdKTtcbn1cblxuZnVuY3Rpb24gdXNlU3RvcmVVbnNlZW5Db3VudChzdG9yZUlkKSB7XG4gIHZhciBfaW5ib3hEYXRhJG5vdGlmaWNhdGksIF9pbmJveERhdGEkbm90aWZpY2F0aTI7XG4gIHZhciBpbmJveERhdGEgPSBSZWFjdC51c2VDb250ZXh0KEluYm94Q29udGV4dCQxKTtcbiAgcmV0dXJuIHtcbiAgICB1blNlZW5Db3VudDogKF9pbmJveERhdGEkbm90aWZpY2F0aSA9IGluYm94RGF0YS5ub3RpZmljYXRpb25zRGF0YS5zdG9yZURhdGEpID09PSBudWxsIHx8IF9pbmJveERhdGEkbm90aWZpY2F0aSA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF9pbmJveERhdGEkbm90aWZpY2F0aTIgPSBfaW5ib3hEYXRhJG5vdGlmaWNhdGlbc3RvcmVJZF0pID09PSBudWxsIHx8IF9pbmJveERhdGEkbm90aWZpY2F0aTIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9pbmJveERhdGEkbm90aWZpY2F0aTIudW5zZWVuQ291bnRcbiAgfTtcbn1cbmZ1bmN0aW9uIHVzZVN0b3Jlc1Vuc2VlbkNvdW50KCkge1xuICB2YXIgaW5ib3hEYXRhID0gUmVhY3QudXNlQ29udGV4dChJbmJveENvbnRleHQkMSk7XG4gIHZhciBzdG9yZURhdGEgPSBpbmJveERhdGEubm90aWZpY2F0aW9uc0RhdGEuc3RvcmVEYXRhO1xuICB2YXIgc3RvcmVDb3VudCA9IHt9O1xuICBmb3IgKHZhciBzdG9yZUlkIGluIHN0b3JlRGF0YSkge1xuICAgIHZhciBzdG9yZSA9IHN0b3JlRGF0YVtzdG9yZUlkXTtcbiAgICBzdG9yZUNvdW50W3N0b3JlSWRdID0gc3RvcmUudW5zZWVuQ291bnQ7XG4gIH1cbiAgcmV0dXJuIHN0b3JlQ291bnQ7XG59XG5cbmZ1bmN0aW9uIFN1cHJzZW5kSW5ib3goX3JlZikge1xuICB2YXIgX3JlZiR3b3Jrc3BhY2VLZXkgPSBfcmVmLndvcmtzcGFjZUtleSxcbiAgICB3b3Jrc3BhY2VLZXkgPSBfcmVmJHdvcmtzcGFjZUtleSA9PT0gdm9pZCAwID8gJycgOiBfcmVmJHdvcmtzcGFjZUtleSxcbiAgICBfcmVmJHRlbmFudElkID0gX3JlZi50ZW5hbnRJZCxcbiAgICB0ZW5hbnRJZCA9IF9yZWYkdGVuYW50SWQgPT09IHZvaWQgMCA/ICcnIDogX3JlZiR0ZW5hbnRJZCxcbiAgICBfcmVmJGRpc3RpbmN0SWQgPSBfcmVmLmRpc3RpbmN0SWQsXG4gICAgZGlzdGluY3RJZCA9IF9yZWYkZGlzdGluY3RJZCA9PT0gdm9pZCAwID8gJycgOiBfcmVmJGRpc3RpbmN0SWQsXG4gICAgX3JlZiRzdWJzY3JpYmVySWQgPSBfcmVmLnN1YnNjcmliZXJJZCxcbiAgICBzdWJzY3JpYmVySWQgPSBfcmVmJHN1YnNjcmliZXJJZCA9PT0gdm9pZCAwID8gJycgOiBfcmVmJHN1YnNjcmliZXJJZCxcbiAgICBfcmVmJGluYm94SWQgPSBfcmVmLmluYm94SWQsXG4gICAgaW5ib3hJZCA9IF9yZWYkaW5ib3hJZCA9PT0gdm9pZCAwID8gJycgOiBfcmVmJGluYm94SWQsXG4gICAgc3RvcmVzID0gX3JlZi5zdG9yZXMsXG4gICAgdG9hc3RQcm9wcyA9IF9yZWYudG9hc3RQcm9wcyxcbiAgICBub3RpZmljYXRpb25DbGlja0hhbmRsZXIgPSBfcmVmLm5vdGlmaWNhdGlvbkNsaWNrSGFuZGxlcixcbiAgICBiZWxsQ29tcG9uZW50ID0gX3JlZi5iZWxsQ29tcG9uZW50LFxuICAgIGJhZGdlQ29tcG9uZW50ID0gX3JlZi5iYWRnZUNvbXBvbmVudCxcbiAgICBub3RpZmljYXRpb25Db21wb25lbnQgPSBfcmVmLm5vdGlmaWNhdGlvbkNvbXBvbmVudCxcbiAgICBub05vdGlmaWNhdGlvbnNDb21wb25lbnQgPSBfcmVmLm5vTm90aWZpY2F0aW9uc0NvbXBvbmVudCxcbiAgICBsb2FkZXJDb21wb25lbnQgPSBfcmVmLmxvYWRlckNvbXBvbmVudCxcbiAgICB0YWJCYWRnZUNvbXBvbmVudCA9IF9yZWYudGFiQmFkZ2VDb21wb25lbnQsXG4gICAgX3JlZiRoaWRlQXZhdGFyID0gX3JlZi5oaWRlQXZhdGFyLFxuICAgIGhpZGVBdmF0YXIgPSBfcmVmJGhpZGVBdmF0YXIgPT09IHZvaWQgMCA/IGZhbHNlIDogX3JlZiRoaWRlQXZhdGFyLFxuICAgIGhpZGVJbmJveCA9IF9yZWYuaGlkZUluYm94LFxuICAgIGhpZGVUb2FzdCA9IF9yZWYuaGlkZVRvYXN0LFxuICAgIHRoZW1lID0gX3JlZi50aGVtZSxcbiAgICBfcmVmJHRoZW1lVHlwZSA9IF9yZWYudGhlbWVUeXBlLFxuICAgIHRoZW1lVHlwZSA9IF9yZWYkdGhlbWVUeXBlID09PSB2b2lkIDAgPyAnbGlnaHQnIDogX3JlZiR0aGVtZVR5cGUsXG4gICAgX3JlZiRwYWdpbmF0aW9uID0gX3JlZi5wYWdpbmF0aW9uLFxuICAgIHBhZ2luYXRpb24gPSBfcmVmJHBhZ2luYXRpb24gPT09IHZvaWQgMCA/IHRydWUgOiBfcmVmJHBhZ2luYXRpb24sXG4gICAgcGFnZVNpemUgPSBfcmVmLnBhZ2VTaXplLFxuICAgIF9yZWYkcG9wcGVyUG9zaXRpb24gPSBfcmVmLnBvcHBlclBvc2l0aW9uLFxuICAgIHBvcHBlclBvc2l0aW9uID0gX3JlZiRwb3BwZXJQb3NpdGlvbiA9PT0gdm9pZCAwID8gJ2JvdHRvbScgOiBfcmVmJHBvcHBlclBvc2l0aW9uLFxuICAgIF9yZWYkc2hvd1VucmVhZENvdW50TyA9IF9yZWYuc2hvd1VucmVhZENvdW50T25UYWJzLFxuICAgIHNob3dVbnJlYWRDb3VudE9uVGFicyA9IF9yZWYkc2hvd1VucmVhZENvdW50TyA9PT0gdm9pZCAwID8gdHJ1ZSA6IF9yZWYkc2hvd1VucmVhZENvdW50TztcbiAgaWYgKGluYm94SWQpIHtcbiAgICBzdWJzY3JpYmVySWQgPSBpbmJveElkO1xuICB9XG4gIHZhciBfdXNlU3RhdGUgPSBSZWFjdC51c2VTdGF0ZShmYWxzZSksXG4gICAgb3BlbkluYm94ID0gX3VzZVN0YXRlWzBdLFxuICAgIHRvZ2dsZUluYm94ID0gX3VzZVN0YXRlWzFdO1xuICB2YXIgX3VzZVN0YXRlMiA9IFJlYWN0LnVzZVN0YXRlKCksXG4gICAgaW5ib3ggPSBfdXNlU3RhdGUyWzBdLFxuICAgIHNldEluYm94ID0gX3VzZVN0YXRlMlsxXTtcbiAgdmFyIF91c2VTdGF0ZTMgPSBSZWFjdC51c2VTdGF0ZSh7XG4gICAgICBzdG9yZURhdGE6IHt9LFxuICAgICAgY291bnQ6IDBcbiAgICB9KSxcbiAgICBub3RpZmljYXRpb25zRGF0YSA9IF91c2VTdGF0ZTNbMF0sXG4gICAgc2V0Tm90aWZpY2F0aW9uc0RhdGEgPSBfdXNlU3RhdGUzWzFdO1xuICB2YXIgX3VzZVN0YXRlNCA9IFJlYWN0LnVzZVN0YXRlKCcnKSxcbiAgICBhY3RpdmVTdG9yZSA9IF91c2VTdGF0ZTRbMF0sXG4gICAgc2V0QWN0aXZlU3RvcmUgPSBfdXNlU3RhdGU0WzFdO1xuICB2YXIgX3VzZVN0YXRlNSA9IFJlYWN0LnVzZVN0YXRlKGZhbHNlKSxcbiAgICBjaGFuZ2luZ0FjdGl2ZVN0b3JlID0gX3VzZVN0YXRlNVswXSxcbiAgICBzZXRDaGFuZ2luZ0FjdGl2ZVN0b3JlID0gX3VzZVN0YXRlNVsxXTtcbiAgUmVhY3QudXNlRWZmZWN0KGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgaW5ib3hJbnN0ID0gbmV3IFN1cHJzZW5kSlNJbmJveCh3b3Jrc3BhY2VLZXksIHtcbiAgICAgIHBhZ2VTaXplOiBwYWdlU2l6ZSxcbiAgICAgIHRlbmFudElEOiB0ZW5hbnRJZCxcbiAgICAgIHN0b3Jlczogc3RvcmVzXG4gICAgfSk7XG4gICAgc2V0SW5ib3goaW5ib3hJbnN0KTtcbiAgICBpbmJveEluc3QuZW1pdHRlci5vbignc3luY19ub3RpZl9zdG9yZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBpbmJveERhdGEgPSBpbmJveEluc3QuZmVlZC5kYXRhO1xuICAgICAgc2V0Tm90aWZpY2F0aW9uc0RhdGEoe1xuICAgICAgICBzdG9yZURhdGE6IChpbmJveERhdGEgPT09IG51bGwgfHwgaW5ib3hEYXRhID09PSB2b2lkIDAgPyB2b2lkIDAgOiBpbmJveERhdGEuc3RvcmVzKSB8fCB7fSxcbiAgICAgICAgY291bnQ6IChpbmJveERhdGEgPT09IG51bGwgfHwgaW5ib3hEYXRhID09PSB2b2lkIDAgPyB2b2lkIDAgOiBpbmJveERhdGEudW5zZWVuQ291bnQpIHx8IDAsXG4gICAgICAgIGhhc05leHQ6IGluYm94RGF0YSA9PT0gbnVsbCB8fCBpbmJveERhdGEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGluYm94RGF0YS5oYXNOZXh0LFxuICAgICAgICBpbml0aWFsTG9hZGluZzogaW5ib3hEYXRhID09PSBudWxsIHx8IGluYm94RGF0YSA9PT0gdm9pZCAwID8gdm9pZCAwIDogaW5ib3hEYXRhLmluaXRpYWxMb2FkaW5nLFxuICAgICAgICBhY3RpdmVTdG9yZUlkOiBpbmJveERhdGEgPT09IG51bGwgfHwgaW5ib3hEYXRhID09PSB2b2lkIDAgPyB2b2lkIDAgOiBpbmJveERhdGEuYWN0aXZlU3RvcmVJZFxuICAgICAgfSk7XG4gICAgICBzZXRBY3RpdmVTdG9yZShpbmJveERhdGEgPT09IG51bGwgfHwgaW5ib3hEYXRhID09PSB2b2lkIDAgPyB2b2lkIDAgOiBpbmJveERhdGEuYWN0aXZlU3RvcmVJZCk7XG4gICAgfSk7XG4gICAgaW5ib3hJbnN0LmVtaXR0ZXIub24oJ25ld19ub3RpZmljYXRpb24nLCBmdW5jdGlvbiAobm90aWZpY2F0aW9uKSB7XG4gICAgICBub3RpZnkoe1xuICAgICAgICBub3RpZmljYXRpb25zRGF0YTogbm90aWZpY2F0aW9uLFxuICAgICAgICB0b2FzdFByb3BzOiB0b2FzdFByb3BzXG4gICAgICB9KTtcbiAgICB9KTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgaW5ib3hJbnN0LmVtaXR0ZXIuYWxsLmNsZWFyKCk7XG4gICAgfTtcbiAgfSwgW10pO1xuICBSZWFjdC51c2VFZmZlY3QoZnVuY3Rpb24gKCkge1xuICAgIGlmIChvcGVuSW5ib3ggJiYgc3Vic2NyaWJlcklkICYmIGluYm94KSB7XG4gICAgICBpbmJveC5mZWVkLm1hcmtBbGxTZWVuKCk7XG4gICAgfVxuICB9LCBbb3BlbkluYm94LCBzdWJzY3JpYmVySWQsIGluYm94XSk7XG4gIFJlYWN0LnVzZUVmZmVjdChmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCFzdWJzY3JpYmVySWQgfHwgIWluYm94KSByZXR1cm47XG4gICAgc2V0Tm90aWZpY2F0aW9uc0RhdGEoe1xuICAgICAgc3RvcmVEYXRhOiB7fSxcbiAgICAgIGNvdW50OiAwXG4gICAgfSk7XG4gICAgaW5ib3guaWRlbnRpZnlVc2VyKGRpc3RpbmN0SWQsIHN1YnNjcmliZXJJZCk7XG4gICAgaW5ib3guZmVlZC5mZXRjaE5vdGlmaWNhdGlvbnMoKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgaW5ib3gucmVzZXRVc2VyKCk7XG4gICAgfTtcbiAgfSwgW3N1YnNjcmliZXJJZCwgaW5ib3hdKTtcbiAgdmFyIHRoZW1lVmFsdWUgPSB0aGVtZVR5cGUgPT09ICdkYXJrJyA/IG1lcmdlRGVlcChkYXJrVGhlbWUsIHRoZW1lKSA6IHRoZW1lIHx8IHt9O1xuICByZXR1cm4gLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoSW5ib3hUaGVtZUNvbnRleHQuUHJvdmlkZXIsIHtcbiAgICB2YWx1ZTogdGhlbWVWYWx1ZVxuICB9LCAvKiNfX1BVUkVfXyovUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChJbmJveENvbnRleHQuUHJvdmlkZXIsIHtcbiAgICB2YWx1ZToge1xuICAgICAgd29ya3NwYWNlS2V5OiB3b3Jrc3BhY2VLZXksXG4gICAgICBub3RpZmljYXRpb25zRGF0YTogbm90aWZpY2F0aW9uc0RhdGEsXG4gICAgICBzZXROb3RpZmljYXRpb25zRGF0YTogc2V0Tm90aWZpY2F0aW9uc0RhdGEsXG4gICAgICBub3RpZmljYXRpb25DbGlja0hhbmRsZXI6IG5vdGlmaWNhdGlvbkNsaWNrSGFuZGxlcixcbiAgICAgIGJlbGxDb21wb25lbnQ6IGJlbGxDb21wb25lbnQsXG4gICAgICBiYWRnZUNvbXBvbmVudDogYmFkZ2VDb21wb25lbnQsXG4gICAgICBub3RpZmljYXRpb25Db21wb25lbnQ6IG5vdGlmaWNhdGlvbkNvbXBvbmVudCxcbiAgICAgIG5vTm90aWZpY2F0aW9uc0NvbXBvbmVudDogbm9Ob3RpZmljYXRpb25zQ29tcG9uZW50LFxuICAgICAgdGFiQmFkZ2VDb21wb25lbnQ6IHRhYkJhZGdlQ29tcG9uZW50LFxuICAgICAgdG9nZ2xlSW5ib3g6IHRvZ2dsZUluYm94LFxuICAgICAgaW5ib3g6IGluYm94LFxuICAgICAgbG9hZGVyQ29tcG9uZW50OiBsb2FkZXJDb21wb25lbnQsXG4gICAgICBwYWdpbmF0aW9uOiBwYWdpbmF0aW9uLFxuICAgICAgaGlkZUF2YXRhcjogaGlkZUF2YXRhcixcbiAgICAgIGFjdGl2ZVN0b3JlOiBhY3RpdmVTdG9yZSxcbiAgICAgIHNldEFjdGl2ZVN0b3JlOiBzZXRBY3RpdmVTdG9yZSxcbiAgICAgIGNoYW5naW5nQWN0aXZlU3RvcmU6IGNoYW5naW5nQWN0aXZlU3RvcmUsXG4gICAgICBzZXRDaGFuZ2luZ0FjdGl2ZVN0b3JlOiBzZXRDaGFuZ2luZ0FjdGl2ZVN0b3JlLFxuICAgICAgc2hvd1VucmVhZENvdW50T25UYWJzOiBzaG93VW5yZWFkQ291bnRPblRhYnMsXG4gICAgICB0aGVtZVR5cGU6IHRoZW1lVHlwZVxuICAgIH1cbiAgfSwgIWhpZGVJbmJveCAmJiAvKiNfX1BVUkVfXyovUmVhY3RfX2RlZmF1bHQuY3JlYXRlRWxlbWVudChJbmJveCwge1xuICAgIG9wZW5JbmJveDogb3BlbkluYm94LFxuICAgIHRvZ2dsZUluYm94OiB0b2dnbGVJbmJveCxcbiAgICBwb3BwZXJQb3NpdGlvbjogcG9wcGVyUG9zaXRpb25cbiAgfSksICFoaWRlVG9hc3QgJiYgLyojX19QVVJFX18qL1JlYWN0X19kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoVG9hc3QsIHRvYXN0UHJvcHMpKSk7XG59XG5cbmV4cG9ydHMuU3VwclNlbmRQcm92aWRlciA9IFN1cHJTZW5kUHJvdmlkZXI7XG5leHBvcnRzLmRlZmF1bHQgPSBTdXByc2VuZEluYm94O1xuZXhwb3J0cy51c2VCZWxsID0gdXNlQmVsbDtcbmV4cG9ydHMudXNlRXZlbnQgPSB1c2VFdmVudDtcbmV4cG9ydHMudXNlTm90aWZpY2F0aW9ucyA9IHVzZU5vdGlmaWNhdGlvbnM7XG5leHBvcnRzLnVzZVN0b3JlVW5zZWVuQ291bnQgPSB1c2VTdG9yZVVuc2VlbkNvdW50O1xuZXhwb3J0cy51c2VTdG9yZXNVbnNlZW5Db3VudCA9IHVzZVN0b3Jlc1Vuc2VlbkNvdW50O1xuZXhwb3J0cy51c2VVbnNlZW5Db3VudCA9IHVzZVVuc2VlbkNvdW50O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwXG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@suprsend/react-inbox/dist/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@suprsend/js-inbox/dist/index.cjs":
/*!********************************************************!*\
  !*** ./node_modules/@suprsend/js-inbox/dist/index.cjs ***!
  \********************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("var socket_ioClient = __webpack_require__(/*! socket.io-client */ \"(ssr)/./node_modules/socket.io-client/build/cjs/index.js\");\nvar vanilla = __webpack_require__(/*! zustand/vanilla */ \"(ssr)/./node_modules/zustand/esm/vanilla.js\");\nvar mitt = __webpack_require__(/*! mitt */ \"(ssr)/./node_modules/mitt/dist/mitt.mjs\");\n\nfunction _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }\n\nvar mitt__default = /*#__PURE__*/_interopDefaultLegacy(mitt);\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor);\n  }\n}\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\nfunction _extends() {\n  _extends = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}\nfunction _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  _setPrototypeOf(subClass, superClass);\n}\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\nfunction _construct(Parent, args, Class) {\n  if (_isNativeReflectConstruct()) {\n    _construct = Reflect.construct.bind();\n  } else {\n    _construct = function _construct(Parent, args, Class) {\n      var a = [null];\n      a.push.apply(a, args);\n      var Constructor = Function.bind.apply(Parent, a);\n      var instance = new Constructor();\n      if (Class) _setPrototypeOf(instance, Class.prototype);\n      return instance;\n    };\n  }\n  return _construct.apply(null, arguments);\n}\nfunction _isNativeFunction(fn) {\n  return Function.toString.call(fn).indexOf(\"[native code]\") !== -1;\n}\nfunction _wrapNativeSuper(Class) {\n  var _cache = typeof Map === \"function\" ? new Map() : undefined;\n  _wrapNativeSuper = function _wrapNativeSuper(Class) {\n    if (Class === null || !_isNativeFunction(Class)) return Class;\n    if (typeof Class !== \"function\") {\n      throw new TypeError(\"Super expression must either be null or a function\");\n    }\n    if (typeof _cache !== \"undefined\") {\n      if (_cache.has(Class)) return _cache.get(Class);\n      _cache.set(Class, Wrapper);\n    }\n    function Wrapper() {\n      return _construct(Class, arguments, _getPrototypeOf(this).constructor);\n    }\n    Wrapper.prototype = Object.create(Class.prototype, {\n      constructor: {\n        value: Wrapper,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n    return _setPrototypeOf(Wrapper, Class);\n  };\n  return _wrapNativeSuper(Class);\n}\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n  return arr2;\n}\nfunction _createForOfIteratorHelperLoose(o, allowArrayLike) {\n  var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"];\n  if (it) return (it = it.call(o)).next.bind(it);\n  if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n    if (it) o = it;\n    var i = 0;\n    return function () {\n      if (i >= o.length) return {\n        done: true\n      };\n      return {\n        done: false,\n        value: o[i++]\n      };\n    };\n  }\n  throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nfunction _toPrimitive(input, hint) {\n  if (typeof input !== \"object\" || input === null) return input;\n  var prim = input[Symbol.toPrimitive];\n  if (prim !== undefined) {\n    var res = prim.call(input, hint || \"default\");\n    if (typeof res !== \"object\") return res;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (hint === \"string\" ? String : Number)(input);\n}\nfunction _toPropertyKey(arg) {\n  var key = _toPrimitive(arg, \"string\");\n  return typeof key === \"symbol\" ? key : String(key);\n}\n\nvar SuprSendError = /*#__PURE__*/function (_Error) {\n  _inheritsLoose(SuprSendError, _Error);\n  function SuprSendError(message) {\n    var _this;\n    _this = _Error.call(this, message) || this;\n    _this.name = void 0;\n    _this.name = 'SuprSendError';\n    return _this;\n  }\n  return SuprSendError;\n}( /*#__PURE__*/_wrapNativeSuper(Error));\nfunction epochNow() {\n  return Math.round(Date.now());\n}\nfunction uuid() {\n  var dt = new Date().getTime();\n  var uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n    var r = (dt + Math.random() * 16) % 16 | 0;\n    dt = Math.floor(dt / 16);\n    return (c == 'x' ? r : r & 0x3 | 0x8).toString(16);\n  });\n  return uuid;\n}\n\nvar configurationStore = vanilla.createStore()(function () {\n  return {\n    apiUrl: 'https://inboxs.live',\n    collectorApiUrl: 'https://hub.suprsend.com',\n    socketUrl: 'https://betainbox.suprsend.com',\n    pageSize: 20\n  };\n});\nvar initialNotificationStore = {\n  unseenCount: 0,\n  stores: {},\n  activeStoreId: null,\n  pageNumber: 1,\n  hasNext: true,\n  initialLoading: false,\n  fetchMoreLoading: false,\n  initialFetchTime: null\n};\nvar notificationStore = vanilla.createStore()(function () {\n  return initialNotificationStore;\n});\n\nfunction _catch$1(body, recover) {\n  try {\n    var result = body();\n  } catch (e) {\n    return recover(e);\n  }\n  if (result && result.then) {\n    return result.then(void 0, recover);\n  }\n  return result;\n}\nvar ApiClient = /*#__PURE__*/function () {\n  function ApiClient(config) {\n    this.socket = void 0;\n    this.config = void 0;\n    this.config = config;\n    var configStore = configurationStore.getState();\n    this.socket = socket_ioClient.io(configStore.socketUrl, {\n      transports: ['websocket'],\n      auth: {\n        subscriber_id: this.config.subscriberId,\n        distinct_id: this.config.distinctId,\n        authorization: this.config.workspaceKey + \":\" + uuid(),\n        tenant_id: this.config.tenantId\n      },\n      reconnectionAttempts: 25,\n      reconnectionDelay: 5000,\n      reconnectionDelayMax: 10000\n    });\n    this._initializeSocketEvents();\n  }\n  var _proto = ApiClient.prototype;\n  _proto.orderNotifications = function orderNotifications(newNotification, oldNotifications) {\n    // if pinned notification add new notification at start else at end of pinned notifications\n    if (newNotification.is_pinned) {\n      return [newNotification].concat(oldNotifications);\n    } else {\n      var addedNotification = false;\n      var notifications = [];\n      oldNotifications.forEach(function (notification) {\n        if (notification.is_pinned) {\n          notifications.push(notification);\n        } else {\n          if (addedNotification) {\n            notifications.push(notification);\n          } else {\n            notifications.push(newNotification);\n            notifications.push(notification);\n            addedNotification = true;\n          }\n        }\n      });\n      if (!addedNotification) {\n        return [].concat(oldNotifications, [newNotification]);\n      }\n      return notifications;\n    }\n  };\n  _proto._initializeSocketEvents = function _initializeSocketEvents() {\n    var _this = this,\n      _this2 = this,\n      _this3 = this,\n      _this4 = this;\n    this.socket.on('new_notification', function (data) {\n      try {\n        if (!data.n_id) return Promise.resolve();\n        setTimeout(function () {\n          try {\n            return Promise.resolve(_catch$1(function () {\n              return Promise.resolve(_this.getNotificationDetails(data.n_id)).then(function (response) {\n                return Promise.resolve(response.json()).then(function (resData) {\n                  var notifStore = notificationStore.getState();\n                  if (_this.config.stores) {\n                    var overallCountUpdate = false;\n                    for (var _iterator = _createForOfIteratorHelperLoose(_this.config.stores), _step; !(_step = _iterator()).done;) {\n                      var store = _step.value;\n                      var storeData = notifStore.stores[store.storeId];\n                      if (_this._notificationBelongToStore(resData.data, store)) {\n                        overallCountUpdate = true;\n                        storeData.notifications = _this.orderNotifications(resData.data, storeData.notifications);\n                        storeData.unseenCount += 1;\n                      }\n                    }\n                    if (overallCountUpdate) {\n                      notifStore.unseenCount += 1;\n                      _this.config.emitter.emit('new_notification', resData.data);\n                    }\n                    notificationStore.setState({\n                      unseenCount: notifStore.unseenCount,\n                      stores: _extends({}, notifStore.stores)\n                    });\n                  } else {\n                    if (!notifStore.activeStoreId) return;\n                    var defaultStore = notifStore.stores[notifStore.activeStoreId];\n                    notifStore.unseenCount += 1;\n                    defaultStore.unseenCount += 1;\n                    defaultStore.notifications = _this.orderNotifications(resData.data, defaultStore.notifications);\n                    notificationStore.setState({\n                      unseenCount: notifStore.unseenCount,\n                      stores: _extends({}, notifStore.stores)\n                    });\n                    _this.config.emitter.emit('new_notification', resData.data);\n                  }\n                  _this.config.emitter.emit('sync_notif_store');\n                });\n              });\n            }, function (e) {\n              console.log('SuprSend: error in new_notification event', e);\n            }));\n          } catch (e) {\n            return Promise.reject(e);\n          }\n        }, 1000);\n        return Promise.resolve();\n      } catch (e) {\n        return Promise.reject(e);\n      }\n    });\n    this.socket.on('notification_updated', function (data) {\n      try {\n        if (!data.n_id) return Promise.resolve();\n        setTimeout(function () {\n          try {\n            return Promise.resolve(_catch$1(function () {\n              return Promise.resolve(Promise.allSettled([_this2.getNotificationDetails(data.n_id), _this2.getNotificationsCount()])).then(function (apiCalls) {\n                var _exit;\n                function _temp4(_result3) {\n                  if (_exit) return _result3;\n                  function _temp2() {\n                    _this2.config.emitter.emit('sync_notif_store');\n                  }\n                  var _temp = function () {\n                    if (apiCalls[1].status === 'fulfilled') {\n                      var countResponse = apiCalls[1].value;\n                      return Promise.resolve(countResponse.json()).then(function (countData) {\n                        notificationStore.setState(function (prevState) {\n                          for (var storeId in prevState.stores) {\n                            var store = prevState.stores[storeId];\n                            store.unseenCount = countData[storeId] || 0;\n                          }\n                          return {\n                            unseenCount: countData.ss_bell_count,\n                            stores: _extends({}, prevState.stores)\n                          };\n                        });\n                      });\n                    }\n                  }();\n                  return _temp && _temp.then ? _temp.then(_temp2) : _temp2(_temp);\n                }\n                var notifStore = notificationStore.getState();\n                var activeStoreId = notifStore.activeStoreId;\n                var _temp3 = function () {\n                  if (apiCalls[0].status === 'fulfilled') {\n                    var response = apiCalls[0].value;\n                    return Promise.resolve(response.json()).then(function (resData) {\n                      var _this2$config$stores;\n                      var newNotificationData = resData.data;\n                      if (!activeStoreId) {\n                        _exit = 1;\n                        return;\n                      }\n                      var activeStore = notifStore.stores[activeStoreId];\n                      var activeStoreQueryData = (_this2$config$stores = _this2.config.stores) == null ? void 0 : _this2$config$stores.find(function (store) {\n                        return store.storeId === activeStoreId;\n                      });\n                      if ((data == null ? void 0 : data.type) === 'archive') {\n                        var _activeStoreQueryData;\n                        if (activeStoreQueryData != null && (_activeStoreQueryData = activeStoreQueryData.query) != null && _activeStoreQueryData.archived) {\n                          if (_this2._notificationBelongToStore(newNotificationData, activeStoreQueryData)) {\n                            notifStore.stores[activeStoreId].notifications = [newNotificationData].concat(activeStore.notifications);\n                          }\n                        } else {\n                          notifStore.stores[activeStoreId].notifications = activeStore.notifications.filter(function (notification) {\n                            return notification.n_id !== data.n_id;\n                          });\n                        }\n                      } else {\n                        notifStore.stores[activeStoreId].notifications = activeStore.notifications.map(function (notification) {\n                          return notification.n_id === data.n_id ? resData.data : notification;\n                        });\n                      }\n                      notificationStore.setState({\n                        stores: _extends({}, notifStore.stores)\n                      });\n                    });\n                  }\n                }();\n                return _temp3 && _temp3.then ? _temp3.then(_temp4) : _temp4(_temp3);\n              });\n            }, function (e) {\n              console.log('SuprSend: error in notification_updated event', e);\n            }));\n          } catch (e) {\n            return Promise.reject(e);\n          }\n        }, 1000);\n        return Promise.resolve();\n      } catch (e) {\n        return Promise.reject(e);\n      }\n    });\n    this.socket.on('update_badge', function () {\n      try {\n        notificationStore.setState({\n          unseenCount: 0\n        });\n        _this3.config.emitter.emit('sync_notif_store');\n        return Promise.resolve();\n      } catch (e) {\n        return Promise.reject(e);\n      }\n    });\n    this.socket.on('mark_all_read', function () {\n      try {\n        var notifStore = notificationStore.getState();\n        var clickedOn = epochNow();\n        for (var storeId in notifStore.stores) {\n          var store = notifStore.stores[storeId];\n          store.notifications.forEach(function (notification) {\n            if (!notification.seen_on) {\n              notification.seen_on = clickedOn;\n            }\n          });\n          store.unseenCount = 0;\n        }\n        notificationStore.setState({\n          stores: notifStore.stores\n        });\n        _this4.config.emitter.emit('sync_notif_store');\n        return Promise.resolve();\n      } catch (e) {\n        return Promise.reject(e);\n      }\n    });\n  };\n  _proto._notificationBelongToStore = function _notificationBelongToStore(notification, store) {\n    var _store$query, _store$query2, _store$query3, _store$query4;\n    var notifRead = !!notification.seen_on;\n    var notifArchived = notification.archived;\n    var notifTags = notification.tags;\n    var notifCategory = notification.n_category;\n    var storeRead = store == null ? void 0 : (_store$query = store.query) == null ? void 0 : _store$query.read;\n    var storeArchived = store == null ? void 0 : (_store$query2 = store.query) == null ? void 0 : _store$query2.archived;\n    var storeTags = store == null ? void 0 : (_store$query3 = store.query) == null ? void 0 : _store$query3.tags;\n    var storeCategories = store == null ? void 0 : (_store$query4 = store.query) == null ? void 0 : _store$query4.categories;\n    var sameRead = !storeRead || notifRead === storeRead;\n    var sameArchived = !storeArchived || notifArchived === storeArchived;\n    var sameTags, sameCategory;\n    if (Array.isArray(storeTags) && storeTags.length > 0) {\n      storeTags.forEach(function (tag) {\n        if (notifTags != null && notifTags.includes(tag)) {\n          sameTags = true;\n        }\n      });\n    } else {\n      sameTags = true;\n    }\n    if (Array.isArray(storeCategories) && storeCategories.length > 0) {\n      if (storeCategories.includes(notifCategory)) {\n        sameCategory = true;\n      }\n    } else {\n      sameCategory = true;\n    }\n    return sameRead && sameTags && sameCategory && sameArchived;\n  };\n  _proto._getStoreQueryString = function _getStoreQueryString(store) {\n    var query = store == null ? void 0 : store.query;\n    var tags = (query == null ? void 0 : query.tags) || [];\n    var categories = (query == null ? void 0 : query.categories) || [];\n    var read = query == null ? void 0 : query.read;\n    var archived = query == null ? void 0 : query.archived;\n    return {\n      store_id: store.storeId,\n      query: {\n        read: read,\n        archived: archived,\n        tags: {\n          or: tags\n        },\n        categories: {\n          or: categories\n        }\n      }\n    };\n  };\n  _proto._getStoresQueryString = function _getStoresQueryString() {\n    var _this5 = this;\n    var stores = this.config.stores;\n    var apiStores = stores == null ? void 0 : stores.map(function (store) {\n      return _this5._getStoreQueryString(store);\n    });\n    return apiStores;\n  };\n  _proto.getNotificationsCount = function getNotificationsCount() {\n    var _configurationStore$g = configurationStore.getState(),\n      apiUrl = _configurationStore$g.apiUrl;\n    var route = \"/notification_count/?subscriber_id=\" + this.config.subscriberId + \"&distinct_id=\" + this.config.distinctId + \"&tenant_id=\" + this.config.tenantId;\n    if (this.config.stores) {\n      var storedFilter = this._getStoresQueryString();\n      route += \"&stores=\" + encodeURIComponent(JSON.stringify(storedFilter));\n    }\n    return fetch(\"\" + apiUrl + route, {\n      method: 'GET',\n      headers: {\n        Authorization: this.config.workspaceKey + \":\" + uuid()\n      }\n    });\n  };\n  _proto.getNotifications = function getNotifications(store, page_no, page_size, before) {\n    if (page_size === void 0) {\n      page_size = 20;\n    }\n    var _configurationStore$g2 = configurationStore.getState(),\n      apiUrl = _configurationStore$g2.apiUrl;\n    var route = \"/notifications/?subscriber_id=\" + this.config.subscriberId + \"&distinct_id=\" + this.config.distinctId + \"&tenant_id=\" + this.config.tenantId + \"&page_no=\" + page_no + \"&page_size=\" + page_size + \"&before=\" + before;\n    if (store) {\n      var storedFilter = this._getStoreQueryString(store);\n      route += \"&store=\" + encodeURIComponent(JSON.stringify(storedFilter));\n    }\n    return fetch(\"\" + apiUrl + route, {\n      method: 'GET',\n      headers: {\n        Authorization: this.config.workspaceKey + \":\" + uuid()\n      }\n    });\n  };\n  _proto.getNotificationDetails = function getNotificationDetails(notification_id) {\n    var _configurationStore$g3 = configurationStore.getState(),\n      apiUrl = _configurationStore$g3.apiUrl;\n    var route = \"/notification/\" + notification_id + \"/?subscriber_id=\" + this.config.subscriberId + \"&distinct_id=\" + this.config.distinctId + \"&tenant_id=\" + this.config.tenantId;\n    return fetch(\"\" + apiUrl + route, {\n      method: 'GET',\n      headers: {\n        Authorization: this.config.workspaceKey + \":\" + uuid()\n      }\n    });\n  };\n  _proto.markBellClicked = function markBellClicked() {\n    var _configurationStore$g4 = configurationStore.getState(),\n      apiUrl = _configurationStore$g4.apiUrl;\n    var route = '/bell-clicked/';\n    var body = JSON.stringify({\n      time: epochNow(),\n      distinct_id: this.config.distinctId,\n      subscriber_id: this.config.subscriberId,\n      tenant_id: this.config.tenantId\n    });\n    return fetch(\"\" + apiUrl + route, {\n      method: 'POST',\n      body: body,\n      headers: {\n        Authorization: this.config.workspaceKey + \":\" + uuid(),\n        'Content-Type': 'application/json'\n      }\n    });\n  };\n  _proto.markAllRead = function markAllRead() {\n    var _configurationStore$g5 = configurationStore.getState(),\n      apiUrl = _configurationStore$g5.apiUrl;\n    var route = '/mark-all-read/';\n    var body = JSON.stringify({\n      time: epochNow(),\n      distinct_id: this.config.distinctId,\n      subscriber_id: this.config.subscriberId,\n      tenant_id: this.config.tenantId\n    });\n    return fetch(\"\" + apiUrl + route, {\n      method: 'POST',\n      body: body,\n      headers: {\n        Authorization: this.config.workspaceKey + \":\" + uuid(),\n        'Content-Type': 'application/json'\n      }\n    });\n  };\n  _proto.markNotificationClicked = function markNotificationClicked(id) {\n    var _configurationStore$g6 = configurationStore.getState(),\n      collectorApiUrl = _configurationStore$g6.collectorApiUrl;\n    var body = {\n      event: '$notification_clicked',\n      env: this.config.workspaceKey,\n      $insert_id: uuid(),\n      $time: epochNow(),\n      properties: {\n        id: id\n      }\n    };\n    return fetch(collectorApiUrl + \"/event/\", {\n      method: 'POST',\n      body: JSON.stringify(body),\n      headers: {\n        Authorization: this.config.workspaceKey + \":\",\n        'Content-Type': 'application/json'\n      }\n    });\n  };\n  _proto.markNotificationRead = function markNotificationRead(id) {\n    var _configurationStore$g7 = configurationStore.getState(),\n      apiUrl = _configurationStore$g7.apiUrl;\n    return fetch(apiUrl + \"/notification/\" + id + \"/action\", {\n      method: 'POST',\n      body: JSON.stringify({\n        action: 'read',\n        distinct_id: this.config.distinctId,\n        subscriber_id: this.config.subscriberId\n      }),\n      headers: {\n        Authorization: this.config.workspaceKey + \":\",\n        'Content-Type': 'application/json'\n      }\n    });\n  };\n  _proto.markNotificationUnRead = function markNotificationUnRead(id) {\n    var _configurationStore$g8 = configurationStore.getState(),\n      apiUrl = _configurationStore$g8.apiUrl;\n    return fetch(apiUrl + \"/notification/\" + id + \"/action\", {\n      method: 'POST',\n      body: JSON.stringify({\n        action: 'unread',\n        distinct_id: this.config.distinctId,\n        subscriber_id: this.config.subscriberId\n      }),\n      headers: {\n        Authorization: this.config.workspaceKey + \":\",\n        'Content-Type': 'application/json'\n      }\n    });\n  };\n  _proto.markNotificationArchive = function markNotificationArchive(id) {\n    var _configurationStore$g9 = configurationStore.getState(),\n      apiUrl = _configurationStore$g9.apiUrl;\n    return fetch(apiUrl + \"/notification/\" + id + \"/action\", {\n      method: 'POST',\n      body: JSON.stringify({\n        action: 'archive',\n        distinct_id: this.config.distinctId,\n        subscriber_id: this.config.subscriberId\n      }),\n      headers: {\n        Authorization: this.config.workspaceKey + \":\",\n        'Content-Type': 'application/json'\n      }\n    });\n  };\n  return ApiClient;\n}();\n\nfunction _catch(body, recover) {\n  try {\n    var result = body();\n  } catch (e) {\n    return recover(e);\n  }\n  if (result && result.then) {\n    return result.then(void 0, recover);\n  }\n  return result;\n}\nvar Inbox = /*#__PURE__*/function () {\n  function Inbox(config) {\n    this.config = void 0;\n    this.config = config;\n  }\n  var _proto = Inbox.prototype;\n  _proto._overallFirstApiCall = function _overallFirstApiCall() {\n    var notifStore = notificationStore.getState();\n    for (var storeId in notifStore.stores) {\n      var store = notifStore.stores[storeId];\n      if (store.isFirstCall === false) {\n        return false;\n      }\n    }\n    return true;\n  };\n  _proto.fetchNotifications = function fetchNotifications() {\n    try {\n      var _notifStore$stores, _this$config$stores;\n      var _this = this;\n      var apiClient = _this.config.client;\n      var notifStore = notificationStore.getState();\n      var configStore = configurationStore.getState();\n      var activeStoreId = notifStore.activeStoreId;\n      if (!activeStoreId || !((_notifStore$stores = notifStore.stores) != null && _notifStore$stores[activeStoreId])) return Promise.resolve();\n      var storeData = notifStore.stores[activeStoreId];\n      var isFirstTime = storeData.isFirstCall;\n      var initialFetchTime = notifStore.initialFetchTime || Date.now();\n      var storeQuery = (_this$config$stores = _this.config.stores) == null ? void 0 : _this$config$stores.find(function (store) {\n        return store.storeId === activeStoreId;\n      });\n      return Promise.resolve(_catch(function () {\n        if (!apiClient || !notifStore.hasNext) return;\n        if (isFirstTime) {\n          notificationStore.setState({\n            initialLoading: true\n          });\n          if (_this._overallFirstApiCall()) {\n            _this.getNotificationsCount();\n          }\n        } else if (notifStore.pageNumber > 1) {\n          notificationStore.setState({\n            fetchMoreLoading: true\n          });\n        }\n        _this.config.emitter.emit('sync_notif_store');\n        return Promise.resolve(apiClient.getNotifications(storeQuery, notifStore.pageNumber, configStore.pageSize, initialFetchTime)).then(function (response) {\n          return Promise.resolve(response.json()).then(function (data) {\n            var newNotifications;\n            if (isFirstTime || !isFirstTime && notifStore.pageNumber === 1) {\n              newNotifications = data.results;\n            } else {\n              newNotifications = [].concat(storeData.notifications, data.results);\n            }\n            notifStore.stores[activeStoreId].notifications = newNotifications;\n            notifStore.stores[activeStoreId].isFirstCall = false;\n            notificationStore.setState({\n              stores: notifStore.stores,\n              pageNumber: notifStore.pageNumber + 1,\n              hasNext: data.meta.current_page < data.meta.total_pages,\n              initialFetchTime: initialFetchTime,\n              initialLoading: false,\n              fetchMoreLoading: false\n            });\n            _this.config.emitter.emit('sync_notif_store');\n            _this.config._startExipryCheck();\n          });\n        });\n      }, function (e) {\n        console.log('SUPRSEND: error getting latest notifications', e);\n        notificationStore.setState({\n          initialLoading: false,\n          fetchMoreLoading: false\n        });\n        _this.config.emitter.emit('sync_notif_store');\n      }));\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  };\n  _proto.getNotificationsCount = function getNotificationsCount() {\n    try {\n      var _this2 = this;\n      var apiClient = _this2.config.client;\n      if (!apiClient) return Promise.resolve();\n      var _temp = _catch(function () {\n        return Promise.resolve(apiClient.getNotificationsCount()).then(function (response) {\n          return Promise.resolve(response.json()).then(function (data) {\n            notificationStore.setState(function (prevState) {\n              for (var storeId in prevState.stores) {\n                var store = prevState.stores[storeId];\n                store.unseenCount = data[storeId] || 0;\n              }\n              return {\n                unseenCount: data.ss_bell_count,\n                stores: _extends({}, prevState.stores)\n              };\n            });\n            _this2.config.emitter.emit('sync_notif_store');\n          });\n        });\n      }, function (e) {\n        console.log('SUPRSEND: error getting notifications count', e);\n      });\n      return Promise.resolve(_temp && _temp.then ? _temp.then(function () {}) : void 0);\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  };\n  _proto.markClicked = function markClicked(id) {\n    try {\n      var _notifStore$stores2;\n      var _this3 = this;\n      var apiClient = _this3.config.client;\n      var notifStore = notificationStore.getState();\n      var activeStoreId = notifStore.activeStoreId;\n      if (!activeStoreId || !((_notifStore$stores2 = notifStore.stores) != null && _notifStore$stores2[activeStoreId])) return Promise.resolve();\n      var storeData = notifStore.stores[activeStoreId];\n      var notifications = storeData.notifications;\n      var clickedNotification = notifications.find(function (item) {\n        return item.n_id === id;\n      });\n      if (clickedNotification && (!clickedNotification.interacted_on || !clickedNotification.seen_on)) {\n        if (!apiClient) return Promise.resolve();\n        try {\n          if (!clickedNotification.interacted_on) {\n            apiClient.markNotificationClicked(id);\n          } else if (!clickedNotification.seen_on) {\n            apiClient.markNotificationRead(id);\n          }\n          var clickedOn = epochNow();\n          clickedNotification.interacted_on = clickedOn;\n          if (!clickedNotification.seen_on) {\n            var _loop = function _loop() {\n              var _store$notifications;\n              var store = notifStore.stores[storeId];\n              (_store$notifications = store.notifications) == null ? void 0 : _store$notifications.forEach(function (item) {\n                if (item.n_id === clickedNotification.n_id) {\n                  item.seen_on = clickedOn;\n                  item.interacted_on = clickedOn;\n                  if (store.unseenCount > 0) {\n                    store.unseenCount -= 1;\n                  }\n                }\n              });\n            };\n            for (var storeId in notifStore == null ? void 0 : notifStore.stores) {\n              _loop();\n            }\n          }\n          notificationStore.setState(_extends({}, notifStore));\n          _this3.config.emitter.emit('sync_notif_store');\n        } catch (e) {\n          console.log('SUPRSEND: error marking notification clicked', e);\n        }\n      }\n      return Promise.resolve();\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  };\n  _proto.markAllSeen = function markAllSeen() {\n    try {\n      var _this4 = this;\n      var apiClient = _this4.config.client;\n      try {\n        if (!apiClient) return Promise.resolve();\n        apiClient.markBellClicked();\n        notificationStore.setState({\n          unseenCount: 0\n        });\n        _this4.config.emitter.emit('sync_notif_store');\n      } catch (e) {\n        console.log('SUPRSEND: error marking all notifications seen', e);\n      }\n      return Promise.resolve();\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  };\n  _proto.markAllRead = function markAllRead() {\n    try {\n      var _this5 = this;\n      var apiClient = _this5.config.client;\n      try {\n        if (!apiClient) return Promise.resolve();\n        apiClient.markAllRead();\n        var notifStore = notificationStore.getState();\n        var clickedOn = epochNow();\n        for (var storeId in notifStore.stores) {\n          var store = notifStore.stores[storeId];\n          store.notifications.forEach(function (notification) {\n            if (!notification.seen_on) {\n              notification.seen_on = clickedOn;\n            }\n          });\n          store.unseenCount = 0;\n        }\n        notificationStore.setState({\n          stores: notifStore.stores\n        });\n        _this5.config.emitter.emit('sync_notif_store');\n      } catch (e) {\n        console.log('SUPRSEND: error marking all notifications read', e);\n      }\n      return Promise.resolve();\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  };\n  _proto.markRead = function markRead(id) {\n    try {\n      var _notifStore$stores3;\n      var _this6 = this;\n      var apiClient = _this6.config.client;\n      var notifStore = notificationStore.getState();\n      var activeStoreId = notifStore.activeStoreId;\n      if (!activeStoreId || !((_notifStore$stores3 = notifStore.stores) != null && _notifStore$stores3[activeStoreId])) return Promise.resolve();\n      var storeData = notifStore.stores[activeStoreId];\n      var notifications = storeData.notifications;\n      var clickedNotification = notifications.find(function (item) {\n        return item.n_id === id;\n      });\n      if (clickedNotification && !clickedNotification.seen_on) {\n        if (!apiClient) return Promise.resolve();\n        try {\n          apiClient.markNotificationRead(id);\n          var clickedOn = epochNow();\n          if (!clickedNotification.seen_on) {\n            var _loop2 = function _loop2() {\n              var _store$notifications2;\n              var store = notifStore.stores[storeId];\n              (_store$notifications2 = store.notifications) == null ? void 0 : _store$notifications2.forEach(function (item) {\n                if (item.n_id === clickedNotification.n_id) {\n                  item.seen_on = clickedOn;\n                  if (store.unseenCount > 0) {\n                    store.unseenCount -= 1;\n                  }\n                }\n              });\n            };\n            for (var storeId in notifStore == null ? void 0 : notifStore.stores) {\n              _loop2();\n            }\n          }\n          notificationStore.setState(_extends({}, notifStore));\n          _this6.config.emitter.emit('sync_notif_store');\n        } catch (e) {\n          console.log('SUPRSEND: error marking notification read', e);\n        }\n      }\n      return Promise.resolve();\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  };\n  _proto.markUnRead = function markUnRead(id) {\n    try {\n      var _notifStore$stores4;\n      var _this7 = this;\n      var apiClient = _this7.config.client;\n      var notifStore = notificationStore.getState();\n      var activeStoreId = notifStore.activeStoreId;\n      if (!activeStoreId || !((_notifStore$stores4 = notifStore.stores) != null && _notifStore$stores4[activeStoreId])) return Promise.resolve();\n      var storeData = notifStore.stores[activeStoreId];\n      var notifications = storeData.notifications;\n      var clickedNotification = notifications.find(function (item) {\n        return item.n_id === id;\n      });\n      if (clickedNotification && clickedNotification.seen_on) {\n        if (!apiClient) return Promise.resolve();\n        try {\n          apiClient.markNotificationUnRead(id);\n          if (clickedNotification.seen_on) {\n            var _loop3 = function _loop3() {\n              var _store$notifications3;\n              var store = notifStore.stores[storeId];\n              (_store$notifications3 = store.notifications) == null ? void 0 : _store$notifications3.forEach(function (item) {\n                if (item.n_id === clickedNotification.n_id) {\n                  item.seen_on = undefined;\n                  if (store.unseenCount >= 0) {\n                    store.unseenCount += 1;\n                  }\n                }\n              });\n            };\n            for (var storeId in notifStore == null ? void 0 : notifStore.stores) {\n              _loop3();\n            }\n          }\n          notificationStore.setState(_extends({}, notifStore));\n          _this7.config.emitter.emit('sync_notif_store');\n        } catch (e) {\n          console.log('SUPRSEND: error marking notification read', e);\n        }\n      }\n      return Promise.resolve();\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  };\n  _proto.markArchived = function markArchived(id) {\n    var _notifStore$stores5;\n    var apiClient = this.config.client;\n    var notifStore = notificationStore.getState();\n    var activeStoreId = notifStore.activeStoreId;\n    if (!activeStoreId || !((_notifStore$stores5 = notifStore.stores) != null && _notifStore$stores5[activeStoreId])) return;\n    var stores = notifStore == null ? void 0 : notifStore.stores;\n    var storeData = stores[activeStoreId];\n    var clickedNotification = storeData.notifications.find(function (item) {\n      return item.n_id === id;\n    });\n    if (clickedNotification && !clickedNotification.archived) {\n      if (!apiClient) return;\n      try {\n        apiClient.markNotificationArchive(id);\n        storeData.notifications = storeData.notifications.filter(function (notification) {\n          return notification.n_id !== id;\n        });\n        if (!clickedNotification.seen_on && storeData.unseenCount > 0) {\n          storeData.unseenCount -= 1;\n        }\n        notificationStore.setState(_extends({}, notifStore));\n        this.config.emitter.emit('sync_notif_store');\n      } catch (e) {\n        console.log('SUPRSEND: error marking notification archived', e);\n      }\n    }\n  };\n  _createClass(Inbox, [{\n    key: \"stores\",\n    get: function get() {\n      return this.config.stores;\n    }\n  }, {\n    key: \"data\",\n    get: function get() {\n      var notifStore = notificationStore.getState();\n      var activeStoreId = notifStore.activeStoreId;\n      var storeFilters = this.stores;\n      if (!activeStoreId) return;\n      return {\n        unseenCount: notifStore.unseenCount,\n        activeStoreId: notifStore.activeStoreId,\n        stores: notifStore.stores,\n        hasStores: storeFilters ? (storeFilters == null ? void 0 : storeFilters.length) > 0 : false,\n        hasNext: notifStore.hasNext,\n        initialLoading: notifStore.initialLoading,\n        fetchMoreLoading: notifStore.fetchMoreLoading\n      };\n    }\n  }]);\n  return Inbox;\n}();\n\nvar SuprSendInbox = /*#__PURE__*/function () {\n  function SuprSendInbox(workspaceKey, config) {\n    this.workspaceKey = '';\n    this.tenantId = void 0;\n    this.stores = void 0;\n    this.distinctId = void 0;\n    this.subscriberId = void 0;\n    this._client = void 0;\n    this._expiryTimerId = void 0;\n    this.feed = new Inbox(this);\n    this.emitter = mitt__default[\"default\"]();\n    this._validateConfig(workspaceKey);\n    this.tenantId = (config == null ? void 0 : config.tenantID) || 'default';\n    this._validateStore(config == null ? void 0 : config.stores);\n    this._validatePageSize(config == null ? void 0 : config.pageSize);\n    this._initializeStoreState();\n  }\n  var _proto = SuprSendInbox.prototype;\n  _proto._validateConfig = function _validateConfig(workspaceKey) {\n    if (!workspaceKey) {\n      throw new SuprSendError('workspaceKey missing');\n    } else {\n      this.workspaceKey = workspaceKey;\n    }\n  };\n  _proto._validateStore = function _validateStore(stores) {\n    if (!stores || !Array.isArray(stores)) return;\n    var validatedStores = [];\n    stores.forEach(function (store) {\n      if (!store.storeId) {\n        console.log('SuprSendInbox: storeId is mandatory if stores are used');\n        return;\n      }\n      var query = store == null ? void 0 : store.query;\n      var read;\n      var tags = [];\n      var categories = [];\n      var archived;\n      if (typeof (query == null ? void 0 : query.read) === 'boolean') {\n        read = query.read;\n      }\n      if (typeof (query == null ? void 0 : query.archived) === 'boolean') {\n        archived = query.archived;\n      }\n      if (typeof (query == null ? void 0 : query.tags) === 'string') {\n        tags = [query.tags];\n      } else if (Array.isArray(query == null ? void 0 : query.tags)) {\n        tags = query == null ? void 0 : query.tags.filter(function (tag) {\n          return typeof tag === 'string';\n        });\n      }\n      if (typeof (query == null ? void 0 : query.categories) === 'string') {\n        categories = [query.categories];\n      } else if (Array.isArray(query == null ? void 0 : query.categories)) {\n        categories = query == null ? void 0 : query.categories.filter(function (category) {\n          return typeof category === 'string';\n        });\n      }\n      validatedStores.push({\n        storeId: store.storeId,\n        label: store.label || store.storeId,\n        query: {\n          archived: archived,\n          read: read,\n          tags: tags,\n          categories: categories\n        }\n      });\n    });\n    this.stores = validatedStores;\n  };\n  _proto._validatePageSize = function _validatePageSize(pageSize) {\n    if (pageSize && typeof pageSize === 'number') {\n      var MAX_ALLOWED_PAGE_SIZE = 50;\n      var validatedPageSize = pageSize <= MAX_ALLOWED_PAGE_SIZE ? pageSize : MAX_ALLOWED_PAGE_SIZE;\n      configurationStore.setState({\n        pageSize: validatedPageSize\n      });\n    }\n  };\n  _proto._initializeStoreState = function _initializeStoreState() {\n    var _this = this;\n    var default_store = 'default_store';\n    var initialStoreData = {\n      notifications: [],\n      unseenCount: 0,\n      isFirstCall: true\n    };\n    if (this.stores && Array.isArray(this.stores) && this.stores.length > 0) {\n      var finalStores = {};\n      this.stores.map(function (store) {\n        finalStores[store.storeId] = _extends({}, initialStoreData);\n      });\n      notificationStore.setState({\n        stores: finalStores,\n        activeStoreId: this.stores[0].storeId\n      });\n    } else {\n      var _stores;\n      notificationStore.setState({\n        stores: (_stores = {}, _stores[default_store] = _extends({}, initialStoreData), _stores),\n        activeStoreId: default_store\n      });\n    }\n    // needed as wait for even listener to register after initialization\n    setTimeout(function () {\n      _this.emitter.emit('sync_notif_store');\n    }, 0);\n  };\n  _proto._startExipryCheck = function _startExipryCheck() {\n    var _this2 = this;\n    if (this._expiryTimerId) return;\n    this._expiryTimerId = setInterval(function () {\n      try {\n        var notifData = notificationStore.getState();\n        var storeNotifsData = notifData.stores;\n        var hasExpired = false;\n        for (var store in storeNotifsData) {\n          var notifications = storeNotifsData[store].notifications;\n          notifications = notifications.filter(function (notification) {\n            var expired = notification.expiry ? Date.now() > notification.expiry : false;\n            if (expired) {\n              hasExpired = true;\n              return false;\n            } else {\n              return true;\n            }\n          });\n          storeNotifsData[store].notifications = notifications;\n        }\n        var _temp = function () {\n          if (hasExpired) {\n            notificationStore.setState({\n              stores: storeNotifsData\n            });\n            return Promise.resolve(_this2.feed.getNotificationsCount()).then(function () {\n              _this2.emitter.emit('sync_notif_store');\n            });\n          }\n        }();\n        return Promise.resolve(_temp && _temp.then ? _temp.then(function () {}) : void 0);\n      } catch (e) {\n        return Promise.reject(e);\n      }\n    }, 30000);\n  };\n  _proto.identifyUser = function identifyUser(distinctId, subscriberId) {\n    this.distinctId = distinctId;\n    this.subscriberId = subscriberId;\n  };\n  _proto.changeActiveStore = function changeActiveStore(storeId) {\n    var _storeData$stores;\n    var storeData = notificationStore.getState();\n    var newStores = {};\n    if (storeData.activeStoreId === storeId) return;\n    if (!((_storeData$stores = storeData.stores) != null && _storeData$stores[storeId])) return;\n    for (var _storeId in storeData.stores) {\n      var store = storeData.stores[_storeId];\n      var storeNotifications = store.notifications.slice(0, 20);\n      newStores[_storeId] = {\n        notifications: storeNotifications,\n        unseenCount: store.unseenCount,\n        isFirstCall: store.isFirstCall\n      };\n    }\n    notificationStore.setState({\n      activeStoreId: storeId,\n      stores: newStores,\n      pageNumber: 1,\n      hasNext: true,\n      initialLoading: false,\n      fetchMoreLoading: false,\n      initialFetchTime: null\n    });\n    if (this.client) {\n      this.feed.fetchNotifications();\n    }\n  };\n  _proto.resetUser = function resetUser() {\n    var _this$_client;\n    notificationStore.setState({\n      unseenCount: 0,\n      pageNumber: 1,\n      hasNext: true,\n      initialLoading: false,\n      fetchMoreLoading: false,\n      initialFetchTime: null\n    });\n    this._initializeStoreState();\n    (_this$_client = this._client) == null ? void 0 : _this$_client.socket.disconnect();\n    this.distinctId = undefined;\n    this.subscriberId = undefined;\n    this._client = undefined;\n    clearInterval(this._expiryTimerId);\n    this._expiryTimerId = undefined;\n    this.feed = new Inbox(this);\n  };\n  _createClass(SuprSendInbox, [{\n    key: \"client\",\n    get: function get() {\n      if (this.distinctId && this.subscriberId) {\n        if (!this._client) {\n          this._client = new ApiClient(this);\n        }\n      }\n      return this._client;\n    }\n  }]);\n  return SuprSendInbox;\n}();\n\nmodule.exports = SuprSendInbox;\n//# sourceMappingURL=index.cjs.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQHN1cHJzZW5kL2pzLWluYm94L2Rpc3QvaW5kZXguY2pzIiwibWFwcGluZ3MiOiJBQUFBLHNCQUFzQixtQkFBTyxDQUFDLGtGQUFrQjtBQUNoRCxjQUFjLG1CQUFPLENBQUMsb0VBQWlCO0FBQ3ZDLFdBQVcsbUJBQU8sQ0FBQyxxREFBTTs7QUFFekIscUNBQXFDLDREQUE0RDs7QUFFakc7O0FBRUE7QUFDQSxrQkFBa0Isa0JBQWtCO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixzQkFBc0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnRkFBZ0Y7QUFDaEY7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5QyxTQUFTO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzR0FBc0csNEJBQTRCO0FBQ2xJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUM7QUFDekMscUJBQXFCO0FBQ3JCLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5QztBQUN6QyxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCLGVBQWU7QUFDZixhQUFhO0FBQ2I7QUFDQSxhQUFhO0FBQ2IsWUFBWTtBQUNaO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQ0FBK0M7QUFDL0M7QUFDQSx5QkFBeUI7QUFDekIsdUJBQXVCO0FBQ3ZCO0FBQ0EsbUJBQW1CO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUI7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQSwyQkFBMkI7QUFDM0I7QUFDQSx3QkFBd0I7QUFDeEI7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0EsMkNBQTJDO0FBQzNDLHVCQUF1QjtBQUN2QixxQkFBcUI7QUFDckI7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxlQUFlO0FBQ2YsYUFBYTtBQUNiO0FBQ0EsYUFBYTtBQUNiLFlBQVk7QUFDWjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxDQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLFdBQVc7QUFDWCxTQUFTO0FBQ1QsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsT0FBTztBQUNQLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUM7QUFDbkM7QUFDQSxhQUFhO0FBQ2I7QUFDQSxXQUFXO0FBQ1gsU0FBUztBQUNULE9BQU87QUFDUDtBQUNBLE9BQU87QUFDUCw0RUFBNEU7QUFDNUUsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnREFBZ0Q7QUFDaEQ7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0RBQWdEO0FBQ2hEO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdEQUFnRDtBQUNoRDtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsOENBQThDO0FBQzlDO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLENBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0RBQWdEO0FBQ2hELE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsTUFBTTtBQUNOO0FBQ0E7QUFDQSw2QkFBNkIsc0NBQXNDO0FBQ25FO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxTQUFTO0FBQ1QsOEVBQThFO0FBQzlFLFFBQVE7QUFDUjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbXl0YXNrcy8uL25vZGVfbW9kdWxlcy9Ac3VwcnNlbmQvanMtaW5ib3gvZGlzdC9pbmRleC5janM/NWIwMiJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgc29ja2V0X2lvQ2xpZW50ID0gcmVxdWlyZSgnc29ja2V0LmlvLWNsaWVudCcpO1xudmFyIHZhbmlsbGEgPSByZXF1aXJlKCd6dXN0YW5kL3ZhbmlsbGEnKTtcbnZhciBtaXR0ID0gcmVxdWlyZSgnbWl0dCcpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcERlZmF1bHRMZWdhY3kgKGUpIHsgcmV0dXJuIGUgJiYgdHlwZW9mIGUgPT09ICdvYmplY3QnICYmICdkZWZhdWx0JyBpbiBlID8gZSA6IHsgJ2RlZmF1bHQnOiBlIH07IH1cblxudmFyIG1pdHRfX2RlZmF1bHQgPSAvKiNfX1BVUkVfXyovX2ludGVyb3BEZWZhdWx0TGVnYWN5KG1pdHQpO1xuXG5mdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldO1xuICAgIGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTtcbiAgICBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7XG4gICAgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBfdG9Qcm9wZXJ0eUtleShkZXNjcmlwdG9yLmtleSksIGRlc2NyaXB0b3IpO1xuICB9XG59XG5mdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7XG4gIGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpO1xuICBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDb25zdHJ1Y3RvciwgXCJwcm90b3R5cGVcIiwge1xuICAgIHdyaXRhYmxlOiBmYWxzZVxuICB9KTtcbiAgcmV0dXJuIENvbnN0cnVjdG9yO1xufVxuZnVuY3Rpb24gX2V4dGVuZHMoKSB7XG4gIF9leHRlbmRzID0gT2JqZWN0LmFzc2lnbiA/IE9iamVjdC5hc3NpZ24uYmluZCgpIDogZnVuY3Rpb24gKHRhcmdldCkge1xuICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldO1xuICAgICAgZm9yICh2YXIga2V5IGluIHNvdXJjZSkge1xuICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHNvdXJjZSwga2V5KSkge1xuICAgICAgICAgIHRhcmdldFtrZXldID0gc291cmNlW2tleV07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRhcmdldDtcbiAgfTtcbiAgcmV0dXJuIF9leHRlbmRzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG59XG5mdW5jdGlvbiBfaW5oZXJpdHNMb29zZShzdWJDbGFzcywgc3VwZXJDbGFzcykge1xuICBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MucHJvdG90eXBlKTtcbiAgc3ViQ2xhc3MucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gc3ViQ2xhc3M7XG4gIF9zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcyk7XG59XG5mdW5jdGlvbiBfZ2V0UHJvdG90eXBlT2Yobykge1xuICBfZ2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3QuZ2V0UHJvdG90eXBlT2YuYmluZCgpIDogZnVuY3Rpb24gX2dldFByb3RvdHlwZU9mKG8pIHtcbiAgICByZXR1cm4gby5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKG8pO1xuICB9O1xuICByZXR1cm4gX2dldFByb3RvdHlwZU9mKG8pO1xufVxuZnVuY3Rpb24gX3NldFByb3RvdHlwZU9mKG8sIHApIHtcbiAgX3NldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mLmJpbmQoKSA6IGZ1bmN0aW9uIF9zZXRQcm90b3R5cGVPZihvLCBwKSB7XG4gICAgby5fX3Byb3RvX18gPSBwO1xuICAgIHJldHVybiBvO1xuICB9O1xuICByZXR1cm4gX3NldFByb3RvdHlwZU9mKG8sIHApO1xufVxuZnVuY3Rpb24gX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCgpIHtcbiAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcInVuZGVmaW5lZFwiIHx8ICFSZWZsZWN0LmNvbnN0cnVjdCkgcmV0dXJuIGZhbHNlO1xuICBpZiAoUmVmbGVjdC5jb25zdHJ1Y3Quc2hhbSkgcmV0dXJuIGZhbHNlO1xuICBpZiAodHlwZW9mIFByb3h5ID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiB0cnVlO1xuICB0cnkge1xuICAgIEJvb2xlYW4ucHJvdG90eXBlLnZhbHVlT2YuY2FsbChSZWZsZWN0LmNvbnN0cnVjdChCb29sZWFuLCBbXSwgZnVuY3Rpb24gKCkge30pKTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuZnVuY3Rpb24gX2NvbnN0cnVjdChQYXJlbnQsIGFyZ3MsIENsYXNzKSB7XG4gIGlmIChfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KCkpIHtcbiAgICBfY29uc3RydWN0ID0gUmVmbGVjdC5jb25zdHJ1Y3QuYmluZCgpO1xuICB9IGVsc2Uge1xuICAgIF9jb25zdHJ1Y3QgPSBmdW5jdGlvbiBfY29uc3RydWN0KFBhcmVudCwgYXJncywgQ2xhc3MpIHtcbiAgICAgIHZhciBhID0gW251bGxdO1xuICAgICAgYS5wdXNoLmFwcGx5KGEsIGFyZ3MpO1xuICAgICAgdmFyIENvbnN0cnVjdG9yID0gRnVuY3Rpb24uYmluZC5hcHBseShQYXJlbnQsIGEpO1xuICAgICAgdmFyIGluc3RhbmNlID0gbmV3IENvbnN0cnVjdG9yKCk7XG4gICAgICBpZiAoQ2xhc3MpIF9zZXRQcm90b3R5cGVPZihpbnN0YW5jZSwgQ2xhc3MucHJvdG90eXBlKTtcbiAgICAgIHJldHVybiBpbnN0YW5jZTtcbiAgICB9O1xuICB9XG4gIHJldHVybiBfY29uc3RydWN0LmFwcGx5KG51bGwsIGFyZ3VtZW50cyk7XG59XG5mdW5jdGlvbiBfaXNOYXRpdmVGdW5jdGlvbihmbikge1xuICByZXR1cm4gRnVuY3Rpb24udG9TdHJpbmcuY2FsbChmbikuaW5kZXhPZihcIltuYXRpdmUgY29kZV1cIikgIT09IC0xO1xufVxuZnVuY3Rpb24gX3dyYXBOYXRpdmVTdXBlcihDbGFzcykge1xuICB2YXIgX2NhY2hlID0gdHlwZW9mIE1hcCA9PT0gXCJmdW5jdGlvblwiID8gbmV3IE1hcCgpIDogdW5kZWZpbmVkO1xuICBfd3JhcE5hdGl2ZVN1cGVyID0gZnVuY3Rpb24gX3dyYXBOYXRpdmVTdXBlcihDbGFzcykge1xuICAgIGlmIChDbGFzcyA9PT0gbnVsbCB8fCAhX2lzTmF0aXZlRnVuY3Rpb24oQ2xhc3MpKSByZXR1cm4gQ2xhc3M7XG4gICAgaWYgKHR5cGVvZiBDbGFzcyAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb25cIik7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgX2NhY2hlICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICBpZiAoX2NhY2hlLmhhcyhDbGFzcykpIHJldHVybiBfY2FjaGUuZ2V0KENsYXNzKTtcbiAgICAgIF9jYWNoZS5zZXQoQ2xhc3MsIFdyYXBwZXIpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBXcmFwcGVyKCkge1xuICAgICAgcmV0dXJuIF9jb25zdHJ1Y3QoQ2xhc3MsIGFyZ3VtZW50cywgX2dldFByb3RvdHlwZU9mKHRoaXMpLmNvbnN0cnVjdG9yKTtcbiAgICB9XG4gICAgV3JhcHBlci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKENsYXNzLnByb3RvdHlwZSwge1xuICAgICAgY29uc3RydWN0b3I6IHtcbiAgICAgICAgdmFsdWU6IFdyYXBwZXIsXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIF9zZXRQcm90b3R5cGVPZihXcmFwcGVyLCBDbGFzcyk7XG4gIH07XG4gIHJldHVybiBfd3JhcE5hdGl2ZVN1cGVyKENsYXNzKTtcbn1cbmZ1bmN0aW9uIF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShvLCBtaW5MZW4pIHtcbiAgaWYgKCFvKSByZXR1cm47XG4gIGlmICh0eXBlb2YgbyA9PT0gXCJzdHJpbmdcIikgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KG8sIG1pbkxlbik7XG4gIHZhciBuID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG8pLnNsaWNlKDgsIC0xKTtcbiAgaWYgKG4gPT09IFwiT2JqZWN0XCIgJiYgby5jb25zdHJ1Y3RvcikgbiA9IG8uY29uc3RydWN0b3IubmFtZTtcbiAgaWYgKG4gPT09IFwiTWFwXCIgfHwgbiA9PT0gXCJTZXRcIikgcmV0dXJuIEFycmF5LmZyb20obyk7XG4gIGlmIChuID09PSBcIkFyZ3VtZW50c1wiIHx8IC9eKD86VWl8SSludCg/Ojh8MTZ8MzIpKD86Q2xhbXBlZCk/QXJyYXkkLy50ZXN0KG4pKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTtcbn1cbmZ1bmN0aW9uIF9hcnJheUxpa2VUb0FycmF5KGFyciwgbGVuKSB7XG4gIGlmIChsZW4gPT0gbnVsbCB8fCBsZW4gPiBhcnIubGVuZ3RoKSBsZW4gPSBhcnIubGVuZ3RoO1xuICBmb3IgKHZhciBpID0gMCwgYXJyMiA9IG5ldyBBcnJheShsZW4pOyBpIDwgbGVuOyBpKyspIGFycjJbaV0gPSBhcnJbaV07XG4gIHJldHVybiBhcnIyO1xufVxuZnVuY3Rpb24gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXJMb29zZShvLCBhbGxvd0FycmF5TGlrZSkge1xuICB2YXIgaXQgPSB0eXBlb2YgU3ltYm9sICE9PSBcInVuZGVmaW5lZFwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXSB8fCBvW1wiQEBpdGVyYXRvclwiXTtcbiAgaWYgKGl0KSByZXR1cm4gKGl0ID0gaXQuY2FsbChvKSkubmV4dC5iaW5kKGl0KTtcbiAgaWYgKEFycmF5LmlzQXJyYXkobykgfHwgKGl0ID0gX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KG8pKSB8fCBhbGxvd0FycmF5TGlrZSAmJiBvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gXCJudW1iZXJcIikge1xuICAgIGlmIChpdCkgbyA9IGl0O1xuICAgIHZhciBpID0gMDtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKGkgPj0gby5sZW5ndGgpIHJldHVybiB7XG4gICAgICAgIGRvbmU6IHRydWVcbiAgICAgIH07XG4gICAgICByZXR1cm4ge1xuICAgICAgICBkb25lOiBmYWxzZSxcbiAgICAgICAgdmFsdWU6IG9baSsrXVxuICAgICAgfTtcbiAgICB9O1xuICB9XG4gIHRocm93IG5ldyBUeXBlRXJyb3IoXCJJbnZhbGlkIGF0dGVtcHQgdG8gaXRlcmF0ZSBub24taXRlcmFibGUgaW5zdGFuY2UuXFxuSW4gb3JkZXIgdG8gYmUgaXRlcmFibGUsIG5vbi1hcnJheSBvYmplY3RzIG11c3QgaGF2ZSBhIFtTeW1ib2wuaXRlcmF0b3JdKCkgbWV0aG9kLlwiKTtcbn1cbmZ1bmN0aW9uIF90b1ByaW1pdGl2ZShpbnB1dCwgaGludCkge1xuICBpZiAodHlwZW9mIGlucHV0ICE9PSBcIm9iamVjdFwiIHx8IGlucHV0ID09PSBudWxsKSByZXR1cm4gaW5wdXQ7XG4gIHZhciBwcmltID0gaW5wdXRbU3ltYm9sLnRvUHJpbWl0aXZlXTtcbiAgaWYgKHByaW0gIT09IHVuZGVmaW5lZCkge1xuICAgIHZhciByZXMgPSBwcmltLmNhbGwoaW5wdXQsIGhpbnQgfHwgXCJkZWZhdWx0XCIpO1xuICAgIGlmICh0eXBlb2YgcmVzICE9PSBcIm9iamVjdFwiKSByZXR1cm4gcmVzO1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJAQHRvUHJpbWl0aXZlIG11c3QgcmV0dXJuIGEgcHJpbWl0aXZlIHZhbHVlLlwiKTtcbiAgfVxuICByZXR1cm4gKGhpbnQgPT09IFwic3RyaW5nXCIgPyBTdHJpbmcgOiBOdW1iZXIpKGlucHV0KTtcbn1cbmZ1bmN0aW9uIF90b1Byb3BlcnR5S2V5KGFyZykge1xuICB2YXIga2V5ID0gX3RvUHJpbWl0aXZlKGFyZywgXCJzdHJpbmdcIik7XG4gIHJldHVybiB0eXBlb2Yga2V5ID09PSBcInN5bWJvbFwiID8ga2V5IDogU3RyaW5nKGtleSk7XG59XG5cbnZhciBTdXByU2VuZEVycm9yID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfRXJyb3IpIHtcbiAgX2luaGVyaXRzTG9vc2UoU3VwclNlbmRFcnJvciwgX0Vycm9yKTtcbiAgZnVuY3Rpb24gU3VwclNlbmRFcnJvcihtZXNzYWdlKSB7XG4gICAgdmFyIF90aGlzO1xuICAgIF90aGlzID0gX0Vycm9yLmNhbGwodGhpcywgbWVzc2FnZSkgfHwgdGhpcztcbiAgICBfdGhpcy5uYW1lID0gdm9pZCAwO1xuICAgIF90aGlzLm5hbWUgPSAnU3VwclNlbmRFcnJvcic7XG4gICAgcmV0dXJuIF90aGlzO1xuICB9XG4gIHJldHVybiBTdXByU2VuZEVycm9yO1xufSggLyojX19QVVJFX18qL193cmFwTmF0aXZlU3VwZXIoRXJyb3IpKTtcbmZ1bmN0aW9uIGVwb2NoTm93KCkge1xuICByZXR1cm4gTWF0aC5yb3VuZChEYXRlLm5vdygpKTtcbn1cbmZ1bmN0aW9uIHV1aWQoKSB7XG4gIHZhciBkdCA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuICB2YXIgdXVpZCA9ICd4eHh4eHh4eC14eHh4LTR4eHgteXh4eC14eHh4eHh4eHh4eHgnLnJlcGxhY2UoL1t4eV0vZywgZnVuY3Rpb24gKGMpIHtcbiAgICB2YXIgciA9IChkdCArIE1hdGgucmFuZG9tKCkgKiAxNikgJSAxNiB8IDA7XG4gICAgZHQgPSBNYXRoLmZsb29yKGR0IC8gMTYpO1xuICAgIHJldHVybiAoYyA9PSAneCcgPyByIDogciAmIDB4MyB8IDB4OCkudG9TdHJpbmcoMTYpO1xuICB9KTtcbiAgcmV0dXJuIHV1aWQ7XG59XG5cbnZhciBjb25maWd1cmF0aW9uU3RvcmUgPSB2YW5pbGxhLmNyZWF0ZVN0b3JlKCkoZnVuY3Rpb24gKCkge1xuICByZXR1cm4ge1xuICAgIGFwaVVybDogJ2h0dHBzOi8vaW5ib3hzLmxpdmUnLFxuICAgIGNvbGxlY3RvckFwaVVybDogJ2h0dHBzOi8vaHViLnN1cHJzZW5kLmNvbScsXG4gICAgc29ja2V0VXJsOiAnaHR0cHM6Ly9iZXRhaW5ib3guc3VwcnNlbmQuY29tJyxcbiAgICBwYWdlU2l6ZTogMjBcbiAgfTtcbn0pO1xudmFyIGluaXRpYWxOb3RpZmljYXRpb25TdG9yZSA9IHtcbiAgdW5zZWVuQ291bnQ6IDAsXG4gIHN0b3Jlczoge30sXG4gIGFjdGl2ZVN0b3JlSWQ6IG51bGwsXG4gIHBhZ2VOdW1iZXI6IDEsXG4gIGhhc05leHQ6IHRydWUsXG4gIGluaXRpYWxMb2FkaW5nOiBmYWxzZSxcbiAgZmV0Y2hNb3JlTG9hZGluZzogZmFsc2UsXG4gIGluaXRpYWxGZXRjaFRpbWU6IG51bGxcbn07XG52YXIgbm90aWZpY2F0aW9uU3RvcmUgPSB2YW5pbGxhLmNyZWF0ZVN0b3JlKCkoZnVuY3Rpb24gKCkge1xuICByZXR1cm4gaW5pdGlhbE5vdGlmaWNhdGlvblN0b3JlO1xufSk7XG5cbmZ1bmN0aW9uIF9jYXRjaCQxKGJvZHksIHJlY292ZXIpIHtcbiAgdHJ5IHtcbiAgICB2YXIgcmVzdWx0ID0gYm9keSgpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgcmV0dXJuIHJlY292ZXIoZSk7XG4gIH1cbiAgaWYgKHJlc3VsdCAmJiByZXN1bHQudGhlbikge1xuICAgIHJldHVybiByZXN1bHQudGhlbih2b2lkIDAsIHJlY292ZXIpO1xuICB9XG4gIHJldHVybiByZXN1bHQ7XG59XG52YXIgQXBpQ2xpZW50ID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gQXBpQ2xpZW50KGNvbmZpZykge1xuICAgIHRoaXMuc29ja2V0ID0gdm9pZCAwO1xuICAgIHRoaXMuY29uZmlnID0gdm9pZCAwO1xuICAgIHRoaXMuY29uZmlnID0gY29uZmlnO1xuICAgIHZhciBjb25maWdTdG9yZSA9IGNvbmZpZ3VyYXRpb25TdG9yZS5nZXRTdGF0ZSgpO1xuICAgIHRoaXMuc29ja2V0ID0gc29ja2V0X2lvQ2xpZW50LmlvKGNvbmZpZ1N0b3JlLnNvY2tldFVybCwge1xuICAgICAgdHJhbnNwb3J0czogWyd3ZWJzb2NrZXQnXSxcbiAgICAgIGF1dGg6IHtcbiAgICAgICAgc3Vic2NyaWJlcl9pZDogdGhpcy5jb25maWcuc3Vic2NyaWJlcklkLFxuICAgICAgICBkaXN0aW5jdF9pZDogdGhpcy5jb25maWcuZGlzdGluY3RJZCxcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5jb25maWcud29ya3NwYWNlS2V5ICsgXCI6XCIgKyB1dWlkKCksXG4gICAgICAgIHRlbmFudF9pZDogdGhpcy5jb25maWcudGVuYW50SWRcbiAgICAgIH0sXG4gICAgICByZWNvbm5lY3Rpb25BdHRlbXB0czogMjUsXG4gICAgICByZWNvbm5lY3Rpb25EZWxheTogNTAwMCxcbiAgICAgIHJlY29ubmVjdGlvbkRlbGF5TWF4OiAxMDAwMFxuICAgIH0pO1xuICAgIHRoaXMuX2luaXRpYWxpemVTb2NrZXRFdmVudHMoKTtcbiAgfVxuICB2YXIgX3Byb3RvID0gQXBpQ2xpZW50LnByb3RvdHlwZTtcbiAgX3Byb3RvLm9yZGVyTm90aWZpY2F0aW9ucyA9IGZ1bmN0aW9uIG9yZGVyTm90aWZpY2F0aW9ucyhuZXdOb3RpZmljYXRpb24sIG9sZE5vdGlmaWNhdGlvbnMpIHtcbiAgICAvLyBpZiBwaW5uZWQgbm90aWZpY2F0aW9uIGFkZCBuZXcgbm90aWZpY2F0aW9uIGF0IHN0YXJ0IGVsc2UgYXQgZW5kIG9mIHBpbm5lZCBub3RpZmljYXRpb25zXG4gICAgaWYgKG5ld05vdGlmaWNhdGlvbi5pc19waW5uZWQpIHtcbiAgICAgIHJldHVybiBbbmV3Tm90aWZpY2F0aW9uXS5jb25jYXQob2xkTm90aWZpY2F0aW9ucyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhciBhZGRlZE5vdGlmaWNhdGlvbiA9IGZhbHNlO1xuICAgICAgdmFyIG5vdGlmaWNhdGlvbnMgPSBbXTtcbiAgICAgIG9sZE5vdGlmaWNhdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAobm90aWZpY2F0aW9uKSB7XG4gICAgICAgIGlmIChub3RpZmljYXRpb24uaXNfcGlubmVkKSB7XG4gICAgICAgICAgbm90aWZpY2F0aW9ucy5wdXNoKG5vdGlmaWNhdGlvbik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKGFkZGVkTm90aWZpY2F0aW9uKSB7XG4gICAgICAgICAgICBub3RpZmljYXRpb25zLnB1c2gobm90aWZpY2F0aW9uKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbm90aWZpY2F0aW9ucy5wdXNoKG5ld05vdGlmaWNhdGlvbik7XG4gICAgICAgICAgICBub3RpZmljYXRpb25zLnB1c2gobm90aWZpY2F0aW9uKTtcbiAgICAgICAgICAgIGFkZGVkTm90aWZpY2F0aW9uID0gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgaWYgKCFhZGRlZE5vdGlmaWNhdGlvbikge1xuICAgICAgICByZXR1cm4gW10uY29uY2F0KG9sZE5vdGlmaWNhdGlvbnMsIFtuZXdOb3RpZmljYXRpb25dKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBub3RpZmljYXRpb25zO1xuICAgIH1cbiAgfTtcbiAgX3Byb3RvLl9pbml0aWFsaXplU29ja2V0RXZlbnRzID0gZnVuY3Rpb24gX2luaXRpYWxpemVTb2NrZXRFdmVudHMoKSB7XG4gICAgdmFyIF90aGlzID0gdGhpcyxcbiAgICAgIF90aGlzMiA9IHRoaXMsXG4gICAgICBfdGhpczMgPSB0aGlzLFxuICAgICAgX3RoaXM0ID0gdGhpcztcbiAgICB0aGlzLnNvY2tldC5vbignbmV3X25vdGlmaWNhdGlvbicsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICB0cnkge1xuICAgICAgICBpZiAoIWRhdGEubl9pZCkgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShfY2F0Y2gkMShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoX3RoaXMuZ2V0Tm90aWZpY2F0aW9uRGV0YWlscyhkYXRhLm5faWQpKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUocmVzcG9uc2UuanNvbigpKS50aGVuKGZ1bmN0aW9uIChyZXNEYXRhKSB7XG4gICAgICAgICAgICAgICAgICB2YXIgbm90aWZTdG9yZSA9IG5vdGlmaWNhdGlvblN0b3JlLmdldFN0YXRlKCk7XG4gICAgICAgICAgICAgICAgICBpZiAoX3RoaXMuY29uZmlnLnN0b3Jlcykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgb3ZlcmFsbENvdW50VXBkYXRlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIF9pdGVyYXRvciA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyTG9vc2UoX3RoaXMuY29uZmlnLnN0b3JlcyksIF9zdGVwOyAhKF9zdGVwID0gX2l0ZXJhdG9yKCkpLmRvbmU7KSB7XG4gICAgICAgICAgICAgICAgICAgICAgdmFyIHN0b3JlID0gX3N0ZXAudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgdmFyIHN0b3JlRGF0YSA9IG5vdGlmU3RvcmUuc3RvcmVzW3N0b3JlLnN0b3JlSWRdO1xuICAgICAgICAgICAgICAgICAgICAgIGlmIChfdGhpcy5fbm90aWZpY2F0aW9uQmVsb25nVG9TdG9yZShyZXNEYXRhLmRhdGEsIHN0b3JlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgb3ZlcmFsbENvdW50VXBkYXRlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0b3JlRGF0YS5ub3RpZmljYXRpb25zID0gX3RoaXMub3JkZXJOb3RpZmljYXRpb25zKHJlc0RhdGEuZGF0YSwgc3RvcmVEYXRhLm5vdGlmaWNhdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RvcmVEYXRhLnVuc2VlbkNvdW50ICs9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChvdmVyYWxsQ291bnRVcGRhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICBub3RpZlN0b3JlLnVuc2VlbkNvdW50ICs9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgX3RoaXMuY29uZmlnLmVtaXR0ZXIuZW1pdCgnbmV3X25vdGlmaWNhdGlvbicsIHJlc0RhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uU3RvcmUuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgICAgICAgIHVuc2VlbkNvdW50OiBub3RpZlN0b3JlLnVuc2VlbkNvdW50LFxuICAgICAgICAgICAgICAgICAgICAgIHN0b3JlczogX2V4dGVuZHMoe30sIG5vdGlmU3RvcmUuc3RvcmVzKVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghbm90aWZTdG9yZS5hY3RpdmVTdG9yZUlkKSByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIHZhciBkZWZhdWx0U3RvcmUgPSBub3RpZlN0b3JlLnN0b3Jlc1tub3RpZlN0b3JlLmFjdGl2ZVN0b3JlSWRdO1xuICAgICAgICAgICAgICAgICAgICBub3RpZlN0b3JlLnVuc2VlbkNvdW50ICs9IDE7XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHRTdG9yZS51bnNlZW5Db3VudCArPSAxO1xuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0U3RvcmUubm90aWZpY2F0aW9ucyA9IF90aGlzLm9yZGVyTm90aWZpY2F0aW9ucyhyZXNEYXRhLmRhdGEsIGRlZmF1bHRTdG9yZS5ub3RpZmljYXRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uU3RvcmUuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgICAgICAgIHVuc2VlbkNvdW50OiBub3RpZlN0b3JlLnVuc2VlbkNvdW50LFxuICAgICAgICAgICAgICAgICAgICAgIHN0b3JlczogX2V4dGVuZHMoe30sIG5vdGlmU3RvcmUuc3RvcmVzKVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuY29uZmlnLmVtaXR0ZXIuZW1pdCgnbmV3X25vdGlmaWNhdGlvbicsIHJlc0RhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICBfdGhpcy5jb25maWcuZW1pdHRlci5lbWl0KCdzeW5jX25vdGlmX3N0b3JlJyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1N1cHJTZW5kOiBlcnJvciBpbiBuZXdfbm90aWZpY2F0aW9uIGV2ZW50JywgZSk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSwgMTAwMCk7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGUpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHRoaXMuc29ja2V0Lm9uKCdub3RpZmljYXRpb25fdXBkYXRlZCcsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICB0cnkge1xuICAgICAgICBpZiAoIWRhdGEubl9pZCkgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShfY2F0Y2gkMShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoUHJvbWlzZS5hbGxTZXR0bGVkKFtfdGhpczIuZ2V0Tm90aWZpY2F0aW9uRGV0YWlscyhkYXRhLm5faWQpLCBfdGhpczIuZ2V0Tm90aWZpY2F0aW9uc0NvdW50KCldKSkudGhlbihmdW5jdGlvbiAoYXBpQ2FsbHMpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2V4aXQ7XG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gX3RlbXA0KF9yZXN1bHQzKSB7XG4gICAgICAgICAgICAgICAgICBpZiAoX2V4aXQpIHJldHVybiBfcmVzdWx0MztcbiAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIF90ZW1wMigpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMyLmNvbmZpZy5lbWl0dGVyLmVtaXQoJ3N5bmNfbm90aWZfc3RvcmUnKTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIHZhciBfdGVtcCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFwaUNhbGxzWzFdLnN0YXR1cyA9PT0gJ2Z1bGZpbGxlZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICB2YXIgY291bnRSZXNwb25zZSA9IGFwaUNhbGxzWzFdLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoY291bnRSZXNwb25zZS5qc29uKCkpLnRoZW4oZnVuY3Rpb24gKGNvdW50RGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uU3RvcmUuc2V0U3RhdGUoZnVuY3Rpb24gKHByZXZTdGF0ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBzdG9yZUlkIGluIHByZXZTdGF0ZS5zdG9yZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RvcmUgPSBwcmV2U3RhdGUuc3RvcmVzW3N0b3JlSWRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0b3JlLnVuc2VlbkNvdW50ID0gY291bnREYXRhW3N0b3JlSWRdIHx8IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNlZW5Db3VudDogY291bnREYXRhLnNzX2JlbGxfY291bnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RvcmVzOiBfZXh0ZW5kcyh7fSwgcHJldlN0YXRlLnN0b3JlcylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9KCk7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gX3RlbXAgJiYgX3RlbXAudGhlbiA/IF90ZW1wLnRoZW4oX3RlbXAyKSA6IF90ZW1wMihfdGVtcCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBub3RpZlN0b3JlID0gbm90aWZpY2F0aW9uU3RvcmUuZ2V0U3RhdGUoKTtcbiAgICAgICAgICAgICAgICB2YXIgYWN0aXZlU3RvcmVJZCA9IG5vdGlmU3RvcmUuYWN0aXZlU3RvcmVJZDtcbiAgICAgICAgICAgICAgICB2YXIgX3RlbXAzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgaWYgKGFwaUNhbGxzWzBdLnN0YXR1cyA9PT0gJ2Z1bGZpbGxlZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3BvbnNlID0gYXBpQ2FsbHNbMF0udmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUocmVzcG9uc2UuanNvbigpKS50aGVuKGZ1bmN0aW9uIChyZXNEYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgdmFyIF90aGlzMiRjb25maWckc3RvcmVzO1xuICAgICAgICAgICAgICAgICAgICAgIHZhciBuZXdOb3RpZmljYXRpb25EYXRhID0gcmVzRGF0YS5kYXRhO1xuICAgICAgICAgICAgICAgICAgICAgIGlmICghYWN0aXZlU3RvcmVJZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX2V4aXQgPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICB2YXIgYWN0aXZlU3RvcmUgPSBub3RpZlN0b3JlLnN0b3Jlc1thY3RpdmVTdG9yZUlkXTtcbiAgICAgICAgICAgICAgICAgICAgICB2YXIgYWN0aXZlU3RvcmVRdWVyeURhdGEgPSAoX3RoaXMyJGNvbmZpZyRzdG9yZXMgPSBfdGhpczIuY29uZmlnLnN0b3JlcykgPT0gbnVsbCA/IHZvaWQgMCA6IF90aGlzMiRjb25maWckc3RvcmVzLmZpbmQoZnVuY3Rpb24gKHN0b3JlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3RvcmUuc3RvcmVJZCA9PT0gYWN0aXZlU3RvcmVJZDtcbiAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICBpZiAoKGRhdGEgPT0gbnVsbCA/IHZvaWQgMCA6IGRhdGEudHlwZSkgPT09ICdhcmNoaXZlJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9hY3RpdmVTdG9yZVF1ZXJ5RGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhY3RpdmVTdG9yZVF1ZXJ5RGF0YSAhPSBudWxsICYmIChfYWN0aXZlU3RvcmVRdWVyeURhdGEgPSBhY3RpdmVTdG9yZVF1ZXJ5RGF0YS5xdWVyeSkgIT0gbnVsbCAmJiBfYWN0aXZlU3RvcmVRdWVyeURhdGEuYXJjaGl2ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzMi5fbm90aWZpY2F0aW9uQmVsb25nVG9TdG9yZShuZXdOb3RpZmljYXRpb25EYXRhLCBhY3RpdmVTdG9yZVF1ZXJ5RGF0YSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub3RpZlN0b3JlLnN0b3Jlc1thY3RpdmVTdG9yZUlkXS5ub3RpZmljYXRpb25zID0gW25ld05vdGlmaWNhdGlvbkRhdGFdLmNvbmNhdChhY3RpdmVTdG9yZS5ub3RpZmljYXRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgbm90aWZTdG9yZS5zdG9yZXNbYWN0aXZlU3RvcmVJZF0ubm90aWZpY2F0aW9ucyA9IGFjdGl2ZVN0b3JlLm5vdGlmaWNhdGlvbnMuZmlsdGVyKGZ1bmN0aW9uIChub3RpZmljYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbm90aWZpY2F0aW9uLm5faWQgIT09IGRhdGEubl9pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vdGlmU3RvcmUuc3RvcmVzW2FjdGl2ZVN0b3JlSWRdLm5vdGlmaWNhdGlvbnMgPSBhY3RpdmVTdG9yZS5ub3RpZmljYXRpb25zLm1hcChmdW5jdGlvbiAobm90aWZpY2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBub3RpZmljYXRpb24ubl9pZCA9PT0gZGF0YS5uX2lkID8gcmVzRGF0YS5kYXRhIDogbm90aWZpY2F0aW9uO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvblN0b3JlLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0b3JlczogX2V4dGVuZHMoe30sIG5vdGlmU3RvcmUuc3RvcmVzKVxuICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF90ZW1wMyAmJiBfdGVtcDMudGhlbiA/IF90ZW1wMy50aGVuKF90ZW1wNCkgOiBfdGVtcDQoX3RlbXAzKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZygnU3VwclNlbmQ6IGVycm9yIGluIG5vdGlmaWNhdGlvbl91cGRhdGVkIGV2ZW50JywgZSk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSwgMTAwMCk7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGUpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHRoaXMuc29ja2V0Lm9uKCd1cGRhdGVfYmFkZ2UnLCBmdW5jdGlvbiAoKSB7XG4gICAgICB0cnkge1xuICAgICAgICBub3RpZmljYXRpb25TdG9yZS5zZXRTdGF0ZSh7XG4gICAgICAgICAgdW5zZWVuQ291bnQ6IDBcbiAgICAgICAgfSk7XG4gICAgICAgIF90aGlzMy5jb25maWcuZW1pdHRlci5lbWl0KCdzeW5jX25vdGlmX3N0b3JlJyk7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGUpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHRoaXMuc29ja2V0Lm9uKCdtYXJrX2FsbF9yZWFkJywgZnVuY3Rpb24gKCkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgdmFyIG5vdGlmU3RvcmUgPSBub3RpZmljYXRpb25TdG9yZS5nZXRTdGF0ZSgpO1xuICAgICAgICB2YXIgY2xpY2tlZE9uID0gZXBvY2hOb3coKTtcbiAgICAgICAgZm9yICh2YXIgc3RvcmVJZCBpbiBub3RpZlN0b3JlLnN0b3Jlcykge1xuICAgICAgICAgIHZhciBzdG9yZSA9IG5vdGlmU3RvcmUuc3RvcmVzW3N0b3JlSWRdO1xuICAgICAgICAgIHN0b3JlLm5vdGlmaWNhdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAobm90aWZpY2F0aW9uKSB7XG4gICAgICAgICAgICBpZiAoIW5vdGlmaWNhdGlvbi5zZWVuX29uKSB7XG4gICAgICAgICAgICAgIG5vdGlmaWNhdGlvbi5zZWVuX29uID0gY2xpY2tlZE9uO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIHN0b3JlLnVuc2VlbkNvdW50ID0gMDtcbiAgICAgICAgfVxuICAgICAgICBub3RpZmljYXRpb25TdG9yZS5zZXRTdGF0ZSh7XG4gICAgICAgICAgc3RvcmVzOiBub3RpZlN0b3JlLnN0b3Jlc1xuICAgICAgICB9KTtcbiAgICAgICAgX3RoaXM0LmNvbmZpZy5lbWl0dGVyLmVtaXQoJ3N5bmNfbm90aWZfc3RvcmUnKTtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH07XG4gIF9wcm90by5fbm90aWZpY2F0aW9uQmVsb25nVG9TdG9yZSA9IGZ1bmN0aW9uIF9ub3RpZmljYXRpb25CZWxvbmdUb1N0b3JlKG5vdGlmaWNhdGlvbiwgc3RvcmUpIHtcbiAgICB2YXIgX3N0b3JlJHF1ZXJ5LCBfc3RvcmUkcXVlcnkyLCBfc3RvcmUkcXVlcnkzLCBfc3RvcmUkcXVlcnk0O1xuICAgIHZhciBub3RpZlJlYWQgPSAhIW5vdGlmaWNhdGlvbi5zZWVuX29uO1xuICAgIHZhciBub3RpZkFyY2hpdmVkID0gbm90aWZpY2F0aW9uLmFyY2hpdmVkO1xuICAgIHZhciBub3RpZlRhZ3MgPSBub3RpZmljYXRpb24udGFncztcbiAgICB2YXIgbm90aWZDYXRlZ29yeSA9IG5vdGlmaWNhdGlvbi5uX2NhdGVnb3J5O1xuICAgIHZhciBzdG9yZVJlYWQgPSBzdG9yZSA9PSBudWxsID8gdm9pZCAwIDogKF9zdG9yZSRxdWVyeSA9IHN0b3JlLnF1ZXJ5KSA9PSBudWxsID8gdm9pZCAwIDogX3N0b3JlJHF1ZXJ5LnJlYWQ7XG4gICAgdmFyIHN0b3JlQXJjaGl2ZWQgPSBzdG9yZSA9PSBudWxsID8gdm9pZCAwIDogKF9zdG9yZSRxdWVyeTIgPSBzdG9yZS5xdWVyeSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9zdG9yZSRxdWVyeTIuYXJjaGl2ZWQ7XG4gICAgdmFyIHN0b3JlVGFncyA9IHN0b3JlID09IG51bGwgPyB2b2lkIDAgOiAoX3N0b3JlJHF1ZXJ5MyA9IHN0b3JlLnF1ZXJ5KSA9PSBudWxsID8gdm9pZCAwIDogX3N0b3JlJHF1ZXJ5My50YWdzO1xuICAgIHZhciBzdG9yZUNhdGVnb3JpZXMgPSBzdG9yZSA9PSBudWxsID8gdm9pZCAwIDogKF9zdG9yZSRxdWVyeTQgPSBzdG9yZS5xdWVyeSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9zdG9yZSRxdWVyeTQuY2F0ZWdvcmllcztcbiAgICB2YXIgc2FtZVJlYWQgPSAhc3RvcmVSZWFkIHx8IG5vdGlmUmVhZCA9PT0gc3RvcmVSZWFkO1xuICAgIHZhciBzYW1lQXJjaGl2ZWQgPSAhc3RvcmVBcmNoaXZlZCB8fCBub3RpZkFyY2hpdmVkID09PSBzdG9yZUFyY2hpdmVkO1xuICAgIHZhciBzYW1lVGFncywgc2FtZUNhdGVnb3J5O1xuICAgIGlmIChBcnJheS5pc0FycmF5KHN0b3JlVGFncykgJiYgc3RvcmVUYWdzLmxlbmd0aCA+IDApIHtcbiAgICAgIHN0b3JlVGFncy5mb3JFYWNoKGZ1bmN0aW9uICh0YWcpIHtcbiAgICAgICAgaWYgKG5vdGlmVGFncyAhPSBudWxsICYmIG5vdGlmVGFncy5pbmNsdWRlcyh0YWcpKSB7XG4gICAgICAgICAgc2FtZVRhZ3MgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgc2FtZVRhZ3MgPSB0cnVlO1xuICAgIH1cbiAgICBpZiAoQXJyYXkuaXNBcnJheShzdG9yZUNhdGVnb3JpZXMpICYmIHN0b3JlQ2F0ZWdvcmllcy5sZW5ndGggPiAwKSB7XG4gICAgICBpZiAoc3RvcmVDYXRlZ29yaWVzLmluY2x1ZGVzKG5vdGlmQ2F0ZWdvcnkpKSB7XG4gICAgICAgIHNhbWVDYXRlZ29yeSA9IHRydWU7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHNhbWVDYXRlZ29yeSA9IHRydWU7XG4gICAgfVxuICAgIHJldHVybiBzYW1lUmVhZCAmJiBzYW1lVGFncyAmJiBzYW1lQ2F0ZWdvcnkgJiYgc2FtZUFyY2hpdmVkO1xuICB9O1xuICBfcHJvdG8uX2dldFN0b3JlUXVlcnlTdHJpbmcgPSBmdW5jdGlvbiBfZ2V0U3RvcmVRdWVyeVN0cmluZyhzdG9yZSkge1xuICAgIHZhciBxdWVyeSA9IHN0b3JlID09IG51bGwgPyB2b2lkIDAgOiBzdG9yZS5xdWVyeTtcbiAgICB2YXIgdGFncyA9IChxdWVyeSA9PSBudWxsID8gdm9pZCAwIDogcXVlcnkudGFncykgfHwgW107XG4gICAgdmFyIGNhdGVnb3JpZXMgPSAocXVlcnkgPT0gbnVsbCA/IHZvaWQgMCA6IHF1ZXJ5LmNhdGVnb3JpZXMpIHx8IFtdO1xuICAgIHZhciByZWFkID0gcXVlcnkgPT0gbnVsbCA/IHZvaWQgMCA6IHF1ZXJ5LnJlYWQ7XG4gICAgdmFyIGFyY2hpdmVkID0gcXVlcnkgPT0gbnVsbCA/IHZvaWQgMCA6IHF1ZXJ5LmFyY2hpdmVkO1xuICAgIHJldHVybiB7XG4gICAgICBzdG9yZV9pZDogc3RvcmUuc3RvcmVJZCxcbiAgICAgIHF1ZXJ5OiB7XG4gICAgICAgIHJlYWQ6IHJlYWQsXG4gICAgICAgIGFyY2hpdmVkOiBhcmNoaXZlZCxcbiAgICAgICAgdGFnczoge1xuICAgICAgICAgIG9yOiB0YWdzXG4gICAgICAgIH0sXG4gICAgICAgIGNhdGVnb3JpZXM6IHtcbiAgICAgICAgICBvcjogY2F0ZWdvcmllc1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgfTtcbiAgX3Byb3RvLl9nZXRTdG9yZXNRdWVyeVN0cmluZyA9IGZ1bmN0aW9uIF9nZXRTdG9yZXNRdWVyeVN0cmluZygpIHtcbiAgICB2YXIgX3RoaXM1ID0gdGhpcztcbiAgICB2YXIgc3RvcmVzID0gdGhpcy5jb25maWcuc3RvcmVzO1xuICAgIHZhciBhcGlTdG9yZXMgPSBzdG9yZXMgPT0gbnVsbCA/IHZvaWQgMCA6IHN0b3Jlcy5tYXAoZnVuY3Rpb24gKHN0b3JlKSB7XG4gICAgICByZXR1cm4gX3RoaXM1Ll9nZXRTdG9yZVF1ZXJ5U3RyaW5nKHN0b3JlKTtcbiAgICB9KTtcbiAgICByZXR1cm4gYXBpU3RvcmVzO1xuICB9O1xuICBfcHJvdG8uZ2V0Tm90aWZpY2F0aW9uc0NvdW50ID0gZnVuY3Rpb24gZ2V0Tm90aWZpY2F0aW9uc0NvdW50KCkge1xuICAgIHZhciBfY29uZmlndXJhdGlvblN0b3JlJGcgPSBjb25maWd1cmF0aW9uU3RvcmUuZ2V0U3RhdGUoKSxcbiAgICAgIGFwaVVybCA9IF9jb25maWd1cmF0aW9uU3RvcmUkZy5hcGlVcmw7XG4gICAgdmFyIHJvdXRlID0gXCIvbm90aWZpY2F0aW9uX2NvdW50Lz9zdWJzY3JpYmVyX2lkPVwiICsgdGhpcy5jb25maWcuc3Vic2NyaWJlcklkICsgXCImZGlzdGluY3RfaWQ9XCIgKyB0aGlzLmNvbmZpZy5kaXN0aW5jdElkICsgXCImdGVuYW50X2lkPVwiICsgdGhpcy5jb25maWcudGVuYW50SWQ7XG4gICAgaWYgKHRoaXMuY29uZmlnLnN0b3Jlcykge1xuICAgICAgdmFyIHN0b3JlZEZpbHRlciA9IHRoaXMuX2dldFN0b3Jlc1F1ZXJ5U3RyaW5nKCk7XG4gICAgICByb3V0ZSArPSBcIiZzdG9yZXM9XCIgKyBlbmNvZGVVUklDb21wb25lbnQoSlNPTi5zdHJpbmdpZnkoc3RvcmVkRmlsdGVyKSk7XG4gICAgfVxuICAgIHJldHVybiBmZXRjaChcIlwiICsgYXBpVXJsICsgcm91dGUsIHtcbiAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIEF1dGhvcml6YXRpb246IHRoaXMuY29uZmlnLndvcmtzcGFjZUtleSArIFwiOlwiICsgdXVpZCgpXG4gICAgICB9XG4gICAgfSk7XG4gIH07XG4gIF9wcm90by5nZXROb3RpZmljYXRpb25zID0gZnVuY3Rpb24gZ2V0Tm90aWZpY2F0aW9ucyhzdG9yZSwgcGFnZV9ubywgcGFnZV9zaXplLCBiZWZvcmUpIHtcbiAgICBpZiAocGFnZV9zaXplID09PSB2b2lkIDApIHtcbiAgICAgIHBhZ2Vfc2l6ZSA9IDIwO1xuICAgIH1cbiAgICB2YXIgX2NvbmZpZ3VyYXRpb25TdG9yZSRnMiA9IGNvbmZpZ3VyYXRpb25TdG9yZS5nZXRTdGF0ZSgpLFxuICAgICAgYXBpVXJsID0gX2NvbmZpZ3VyYXRpb25TdG9yZSRnMi5hcGlVcmw7XG4gICAgdmFyIHJvdXRlID0gXCIvbm90aWZpY2F0aW9ucy8/c3Vic2NyaWJlcl9pZD1cIiArIHRoaXMuY29uZmlnLnN1YnNjcmliZXJJZCArIFwiJmRpc3RpbmN0X2lkPVwiICsgdGhpcy5jb25maWcuZGlzdGluY3RJZCArIFwiJnRlbmFudF9pZD1cIiArIHRoaXMuY29uZmlnLnRlbmFudElkICsgXCImcGFnZV9ubz1cIiArIHBhZ2Vfbm8gKyBcIiZwYWdlX3NpemU9XCIgKyBwYWdlX3NpemUgKyBcIiZiZWZvcmU9XCIgKyBiZWZvcmU7XG4gICAgaWYgKHN0b3JlKSB7XG4gICAgICB2YXIgc3RvcmVkRmlsdGVyID0gdGhpcy5fZ2V0U3RvcmVRdWVyeVN0cmluZyhzdG9yZSk7XG4gICAgICByb3V0ZSArPSBcIiZzdG9yZT1cIiArIGVuY29kZVVSSUNvbXBvbmVudChKU09OLnN0cmluZ2lmeShzdG9yZWRGaWx0ZXIpKTtcbiAgICB9XG4gICAgcmV0dXJuIGZldGNoKFwiXCIgKyBhcGlVcmwgKyByb3V0ZSwge1xuICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgQXV0aG9yaXphdGlvbjogdGhpcy5jb25maWcud29ya3NwYWNlS2V5ICsgXCI6XCIgKyB1dWlkKClcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcbiAgX3Byb3RvLmdldE5vdGlmaWNhdGlvbkRldGFpbHMgPSBmdW5jdGlvbiBnZXROb3RpZmljYXRpb25EZXRhaWxzKG5vdGlmaWNhdGlvbl9pZCkge1xuICAgIHZhciBfY29uZmlndXJhdGlvblN0b3JlJGczID0gY29uZmlndXJhdGlvblN0b3JlLmdldFN0YXRlKCksXG4gICAgICBhcGlVcmwgPSBfY29uZmlndXJhdGlvblN0b3JlJGczLmFwaVVybDtcbiAgICB2YXIgcm91dGUgPSBcIi9ub3RpZmljYXRpb24vXCIgKyBub3RpZmljYXRpb25faWQgKyBcIi8/c3Vic2NyaWJlcl9pZD1cIiArIHRoaXMuY29uZmlnLnN1YnNjcmliZXJJZCArIFwiJmRpc3RpbmN0X2lkPVwiICsgdGhpcy5jb25maWcuZGlzdGluY3RJZCArIFwiJnRlbmFudF9pZD1cIiArIHRoaXMuY29uZmlnLnRlbmFudElkO1xuICAgIHJldHVybiBmZXRjaChcIlwiICsgYXBpVXJsICsgcm91dGUsIHtcbiAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIEF1dGhvcml6YXRpb246IHRoaXMuY29uZmlnLndvcmtzcGFjZUtleSArIFwiOlwiICsgdXVpZCgpXG4gICAgICB9XG4gICAgfSk7XG4gIH07XG4gIF9wcm90by5tYXJrQmVsbENsaWNrZWQgPSBmdW5jdGlvbiBtYXJrQmVsbENsaWNrZWQoKSB7XG4gICAgdmFyIF9jb25maWd1cmF0aW9uU3RvcmUkZzQgPSBjb25maWd1cmF0aW9uU3RvcmUuZ2V0U3RhdGUoKSxcbiAgICAgIGFwaVVybCA9IF9jb25maWd1cmF0aW9uU3RvcmUkZzQuYXBpVXJsO1xuICAgIHZhciByb3V0ZSA9ICcvYmVsbC1jbGlja2VkLyc7XG4gICAgdmFyIGJvZHkgPSBKU09OLnN0cmluZ2lmeSh7XG4gICAgICB0aW1lOiBlcG9jaE5vdygpLFxuICAgICAgZGlzdGluY3RfaWQ6IHRoaXMuY29uZmlnLmRpc3RpbmN0SWQsXG4gICAgICBzdWJzY3JpYmVyX2lkOiB0aGlzLmNvbmZpZy5zdWJzY3JpYmVySWQsXG4gICAgICB0ZW5hbnRfaWQ6IHRoaXMuY29uZmlnLnRlbmFudElkXG4gICAgfSk7XG4gICAgcmV0dXJuIGZldGNoKFwiXCIgKyBhcGlVcmwgKyByb3V0ZSwge1xuICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICBib2R5OiBib2R5LFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBBdXRob3JpemF0aW9uOiB0aGlzLmNvbmZpZy53b3Jrc3BhY2VLZXkgKyBcIjpcIiArIHV1aWQoKSxcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgfVxuICAgIH0pO1xuICB9O1xuICBfcHJvdG8ubWFya0FsbFJlYWQgPSBmdW5jdGlvbiBtYXJrQWxsUmVhZCgpIHtcbiAgICB2YXIgX2NvbmZpZ3VyYXRpb25TdG9yZSRnNSA9IGNvbmZpZ3VyYXRpb25TdG9yZS5nZXRTdGF0ZSgpLFxuICAgICAgYXBpVXJsID0gX2NvbmZpZ3VyYXRpb25TdG9yZSRnNS5hcGlVcmw7XG4gICAgdmFyIHJvdXRlID0gJy9tYXJrLWFsbC1yZWFkLyc7XG4gICAgdmFyIGJvZHkgPSBKU09OLnN0cmluZ2lmeSh7XG4gICAgICB0aW1lOiBlcG9jaE5vdygpLFxuICAgICAgZGlzdGluY3RfaWQ6IHRoaXMuY29uZmlnLmRpc3RpbmN0SWQsXG4gICAgICBzdWJzY3JpYmVyX2lkOiB0aGlzLmNvbmZpZy5zdWJzY3JpYmVySWQsXG4gICAgICB0ZW5hbnRfaWQ6IHRoaXMuY29uZmlnLnRlbmFudElkXG4gICAgfSk7XG4gICAgcmV0dXJuIGZldGNoKFwiXCIgKyBhcGlVcmwgKyByb3V0ZSwge1xuICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICBib2R5OiBib2R5LFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBBdXRob3JpemF0aW9uOiB0aGlzLmNvbmZpZy53b3Jrc3BhY2VLZXkgKyBcIjpcIiArIHV1aWQoKSxcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgfVxuICAgIH0pO1xuICB9O1xuICBfcHJvdG8ubWFya05vdGlmaWNhdGlvbkNsaWNrZWQgPSBmdW5jdGlvbiBtYXJrTm90aWZpY2F0aW9uQ2xpY2tlZChpZCkge1xuICAgIHZhciBfY29uZmlndXJhdGlvblN0b3JlJGc2ID0gY29uZmlndXJhdGlvblN0b3JlLmdldFN0YXRlKCksXG4gICAgICBjb2xsZWN0b3JBcGlVcmwgPSBfY29uZmlndXJhdGlvblN0b3JlJGc2LmNvbGxlY3RvckFwaVVybDtcbiAgICB2YXIgYm9keSA9IHtcbiAgICAgIGV2ZW50OiAnJG5vdGlmaWNhdGlvbl9jbGlja2VkJyxcbiAgICAgIGVudjogdGhpcy5jb25maWcud29ya3NwYWNlS2V5LFxuICAgICAgJGluc2VydF9pZDogdXVpZCgpLFxuICAgICAgJHRpbWU6IGVwb2NoTm93KCksXG4gICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIGlkOiBpZFxuICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIGZldGNoKGNvbGxlY3RvckFwaVVybCArIFwiL2V2ZW50L1wiLCB7XG4gICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGJvZHkpLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBBdXRob3JpemF0aW9uOiB0aGlzLmNvbmZpZy53b3Jrc3BhY2VLZXkgKyBcIjpcIixcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgfVxuICAgIH0pO1xuICB9O1xuICBfcHJvdG8ubWFya05vdGlmaWNhdGlvblJlYWQgPSBmdW5jdGlvbiBtYXJrTm90aWZpY2F0aW9uUmVhZChpZCkge1xuICAgIHZhciBfY29uZmlndXJhdGlvblN0b3JlJGc3ID0gY29uZmlndXJhdGlvblN0b3JlLmdldFN0YXRlKCksXG4gICAgICBhcGlVcmwgPSBfY29uZmlndXJhdGlvblN0b3JlJGc3LmFwaVVybDtcbiAgICByZXR1cm4gZmV0Y2goYXBpVXJsICsgXCIvbm90aWZpY2F0aW9uL1wiICsgaWQgKyBcIi9hY3Rpb25cIiwge1xuICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIGFjdGlvbjogJ3JlYWQnLFxuICAgICAgICBkaXN0aW5jdF9pZDogdGhpcy5jb25maWcuZGlzdGluY3RJZCxcbiAgICAgICAgc3Vic2NyaWJlcl9pZDogdGhpcy5jb25maWcuc3Vic2NyaWJlcklkXG4gICAgICB9KSxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgQXV0aG9yaXphdGlvbjogdGhpcy5jb25maWcud29ya3NwYWNlS2V5ICsgXCI6XCIsXG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcbiAgX3Byb3RvLm1hcmtOb3RpZmljYXRpb25VblJlYWQgPSBmdW5jdGlvbiBtYXJrTm90aWZpY2F0aW9uVW5SZWFkKGlkKSB7XG4gICAgdmFyIF9jb25maWd1cmF0aW9uU3RvcmUkZzggPSBjb25maWd1cmF0aW9uU3RvcmUuZ2V0U3RhdGUoKSxcbiAgICAgIGFwaVVybCA9IF9jb25maWd1cmF0aW9uU3RvcmUkZzguYXBpVXJsO1xuICAgIHJldHVybiBmZXRjaChhcGlVcmwgKyBcIi9ub3RpZmljYXRpb24vXCIgKyBpZCArIFwiL2FjdGlvblwiLCB7XG4gICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgYWN0aW9uOiAndW5yZWFkJyxcbiAgICAgICAgZGlzdGluY3RfaWQ6IHRoaXMuY29uZmlnLmRpc3RpbmN0SWQsXG4gICAgICAgIHN1YnNjcmliZXJfaWQ6IHRoaXMuY29uZmlnLnN1YnNjcmliZXJJZFxuICAgICAgfSksXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIEF1dGhvcml6YXRpb246IHRoaXMuY29uZmlnLndvcmtzcGFjZUtleSArIFwiOlwiLFxuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG4gICAgICB9XG4gICAgfSk7XG4gIH07XG4gIF9wcm90by5tYXJrTm90aWZpY2F0aW9uQXJjaGl2ZSA9IGZ1bmN0aW9uIG1hcmtOb3RpZmljYXRpb25BcmNoaXZlKGlkKSB7XG4gICAgdmFyIF9jb25maWd1cmF0aW9uU3RvcmUkZzkgPSBjb25maWd1cmF0aW9uU3RvcmUuZ2V0U3RhdGUoKSxcbiAgICAgIGFwaVVybCA9IF9jb25maWd1cmF0aW9uU3RvcmUkZzkuYXBpVXJsO1xuICAgIHJldHVybiBmZXRjaChhcGlVcmwgKyBcIi9ub3RpZmljYXRpb24vXCIgKyBpZCArIFwiL2FjdGlvblwiLCB7XG4gICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgYWN0aW9uOiAnYXJjaGl2ZScsXG4gICAgICAgIGRpc3RpbmN0X2lkOiB0aGlzLmNvbmZpZy5kaXN0aW5jdElkLFxuICAgICAgICBzdWJzY3JpYmVyX2lkOiB0aGlzLmNvbmZpZy5zdWJzY3JpYmVySWRcbiAgICAgIH0pLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBBdXRob3JpemF0aW9uOiB0aGlzLmNvbmZpZy53b3Jrc3BhY2VLZXkgKyBcIjpcIixcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgfVxuICAgIH0pO1xuICB9O1xuICByZXR1cm4gQXBpQ2xpZW50O1xufSgpO1xuXG5mdW5jdGlvbiBfY2F0Y2goYm9keSwgcmVjb3Zlcikge1xuICB0cnkge1xuICAgIHZhciByZXN1bHQgPSBib2R5KCk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4gcmVjb3ZlcihlKTtcbiAgfVxuICBpZiAocmVzdWx0ICYmIHJlc3VsdC50aGVuKSB7XG4gICAgcmV0dXJuIHJlc3VsdC50aGVuKHZvaWQgMCwgcmVjb3Zlcik7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn1cbnZhciBJbmJveCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIEluYm94KGNvbmZpZykge1xuICAgIHRoaXMuY29uZmlnID0gdm9pZCAwO1xuICAgIHRoaXMuY29uZmlnID0gY29uZmlnO1xuICB9XG4gIHZhciBfcHJvdG8gPSBJbmJveC5wcm90b3R5cGU7XG4gIF9wcm90by5fb3ZlcmFsbEZpcnN0QXBpQ2FsbCA9IGZ1bmN0aW9uIF9vdmVyYWxsRmlyc3RBcGlDYWxsKCkge1xuICAgIHZhciBub3RpZlN0b3JlID0gbm90aWZpY2F0aW9uU3RvcmUuZ2V0U3RhdGUoKTtcbiAgICBmb3IgKHZhciBzdG9yZUlkIGluIG5vdGlmU3RvcmUuc3RvcmVzKSB7XG4gICAgICB2YXIgc3RvcmUgPSBub3RpZlN0b3JlLnN0b3Jlc1tzdG9yZUlkXTtcbiAgICAgIGlmIChzdG9yZS5pc0ZpcnN0Q2FsbCA9PT0gZmFsc2UpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfTtcbiAgX3Byb3RvLmZldGNoTm90aWZpY2F0aW9ucyA9IGZ1bmN0aW9uIGZldGNoTm90aWZpY2F0aW9ucygpIHtcbiAgICB0cnkge1xuICAgICAgdmFyIF9ub3RpZlN0b3JlJHN0b3JlcywgX3RoaXMkY29uZmlnJHN0b3JlcztcbiAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICB2YXIgYXBpQ2xpZW50ID0gX3RoaXMuY29uZmlnLmNsaWVudDtcbiAgICAgIHZhciBub3RpZlN0b3JlID0gbm90aWZpY2F0aW9uU3RvcmUuZ2V0U3RhdGUoKTtcbiAgICAgIHZhciBjb25maWdTdG9yZSA9IGNvbmZpZ3VyYXRpb25TdG9yZS5nZXRTdGF0ZSgpO1xuICAgICAgdmFyIGFjdGl2ZVN0b3JlSWQgPSBub3RpZlN0b3JlLmFjdGl2ZVN0b3JlSWQ7XG4gICAgICBpZiAoIWFjdGl2ZVN0b3JlSWQgfHwgISgoX25vdGlmU3RvcmUkc3RvcmVzID0gbm90aWZTdG9yZS5zdG9yZXMpICE9IG51bGwgJiYgX25vdGlmU3RvcmUkc3RvcmVzW2FjdGl2ZVN0b3JlSWRdKSkgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgdmFyIHN0b3JlRGF0YSA9IG5vdGlmU3RvcmUuc3RvcmVzW2FjdGl2ZVN0b3JlSWRdO1xuICAgICAgdmFyIGlzRmlyc3RUaW1lID0gc3RvcmVEYXRhLmlzRmlyc3RDYWxsO1xuICAgICAgdmFyIGluaXRpYWxGZXRjaFRpbWUgPSBub3RpZlN0b3JlLmluaXRpYWxGZXRjaFRpbWUgfHwgRGF0ZS5ub3coKTtcbiAgICAgIHZhciBzdG9yZVF1ZXJ5ID0gKF90aGlzJGNvbmZpZyRzdG9yZXMgPSBfdGhpcy5jb25maWcuc3RvcmVzKSA9PSBudWxsID8gdm9pZCAwIDogX3RoaXMkY29uZmlnJHN0b3Jlcy5maW5kKGZ1bmN0aW9uIChzdG9yZSkge1xuICAgICAgICByZXR1cm4gc3RvcmUuc3RvcmVJZCA9PT0gYWN0aXZlU3RvcmVJZDtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShfY2F0Y2goZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIWFwaUNsaWVudCB8fCAhbm90aWZTdG9yZS5oYXNOZXh0KSByZXR1cm47XG4gICAgICAgIGlmIChpc0ZpcnN0VGltZSkge1xuICAgICAgICAgIG5vdGlmaWNhdGlvblN0b3JlLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGluaXRpYWxMb2FkaW5nOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgaWYgKF90aGlzLl9vdmVyYWxsRmlyc3RBcGlDYWxsKCkpIHtcbiAgICAgICAgICAgIF90aGlzLmdldE5vdGlmaWNhdGlvbnNDb3VudCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChub3RpZlN0b3JlLnBhZ2VOdW1iZXIgPiAxKSB7XG4gICAgICAgICAgbm90aWZpY2F0aW9uU3RvcmUuc2V0U3RhdGUoe1xuICAgICAgICAgICAgZmV0Y2hNb3JlTG9hZGluZzogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIF90aGlzLmNvbmZpZy5lbWl0dGVyLmVtaXQoJ3N5bmNfbm90aWZfc3RvcmUnKTtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShhcGlDbGllbnQuZ2V0Tm90aWZpY2F0aW9ucyhzdG9yZVF1ZXJ5LCBub3RpZlN0b3JlLnBhZ2VOdW1iZXIsIGNvbmZpZ1N0b3JlLnBhZ2VTaXplLCBpbml0aWFsRmV0Y2hUaW1lKSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHJlc3BvbnNlLmpzb24oKSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgdmFyIG5ld05vdGlmaWNhdGlvbnM7XG4gICAgICAgICAgICBpZiAoaXNGaXJzdFRpbWUgfHwgIWlzRmlyc3RUaW1lICYmIG5vdGlmU3RvcmUucGFnZU51bWJlciA9PT0gMSkge1xuICAgICAgICAgICAgICBuZXdOb3RpZmljYXRpb25zID0gZGF0YS5yZXN1bHRzO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgbmV3Tm90aWZpY2F0aW9ucyA9IFtdLmNvbmNhdChzdG9yZURhdGEubm90aWZpY2F0aW9ucywgZGF0YS5yZXN1bHRzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5vdGlmU3RvcmUuc3RvcmVzW2FjdGl2ZVN0b3JlSWRdLm5vdGlmaWNhdGlvbnMgPSBuZXdOb3RpZmljYXRpb25zO1xuICAgICAgICAgICAgbm90aWZTdG9yZS5zdG9yZXNbYWN0aXZlU3RvcmVJZF0uaXNGaXJzdENhbGwgPSBmYWxzZTtcbiAgICAgICAgICAgIG5vdGlmaWNhdGlvblN0b3JlLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgc3RvcmVzOiBub3RpZlN0b3JlLnN0b3JlcyxcbiAgICAgICAgICAgICAgcGFnZU51bWJlcjogbm90aWZTdG9yZS5wYWdlTnVtYmVyICsgMSxcbiAgICAgICAgICAgICAgaGFzTmV4dDogZGF0YS5tZXRhLmN1cnJlbnRfcGFnZSA8IGRhdGEubWV0YS50b3RhbF9wYWdlcyxcbiAgICAgICAgICAgICAgaW5pdGlhbEZldGNoVGltZTogaW5pdGlhbEZldGNoVGltZSxcbiAgICAgICAgICAgICAgaW5pdGlhbExvYWRpbmc6IGZhbHNlLFxuICAgICAgICAgICAgICBmZXRjaE1vcmVMb2FkaW5nOiBmYWxzZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBfdGhpcy5jb25maWcuZW1pdHRlci5lbWl0KCdzeW5jX25vdGlmX3N0b3JlJyk7XG4gICAgICAgICAgICBfdGhpcy5jb25maWcuX3N0YXJ0RXhpcHJ5Q2hlY2soKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICB9LCBmdW5jdGlvbiAoZSkge1xuICAgICAgICBjb25zb2xlLmxvZygnU1VQUlNFTkQ6IGVycm9yIGdldHRpbmcgbGF0ZXN0IG5vdGlmaWNhdGlvbnMnLCBlKTtcbiAgICAgICAgbm90aWZpY2F0aW9uU3RvcmUuc2V0U3RhdGUoe1xuICAgICAgICAgIGluaXRpYWxMb2FkaW5nOiBmYWxzZSxcbiAgICAgICAgICBmZXRjaE1vcmVMb2FkaW5nOiBmYWxzZVxuICAgICAgICB9KTtcbiAgICAgICAgX3RoaXMuY29uZmlnLmVtaXR0ZXIuZW1pdCgnc3luY19ub3RpZl9zdG9yZScpO1xuICAgICAgfSkpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlKTtcbiAgICB9XG4gIH07XG4gIF9wcm90by5nZXROb3RpZmljYXRpb25zQ291bnQgPSBmdW5jdGlvbiBnZXROb3RpZmljYXRpb25zQ291bnQoKSB7XG4gICAgdHJ5IHtcbiAgICAgIHZhciBfdGhpczIgPSB0aGlzO1xuICAgICAgdmFyIGFwaUNsaWVudCA9IF90aGlzMi5jb25maWcuY2xpZW50O1xuICAgICAgaWYgKCFhcGlDbGllbnQpIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgIHZhciBfdGVtcCA9IF9jYXRjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoYXBpQ2xpZW50LmdldE5vdGlmaWNhdGlvbnNDb3VudCgpKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUocmVzcG9uc2UuanNvbigpKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBub3RpZmljYXRpb25TdG9yZS5zZXRTdGF0ZShmdW5jdGlvbiAocHJldlN0YXRlKSB7XG4gICAgICAgICAgICAgIGZvciAodmFyIHN0b3JlSWQgaW4gcHJldlN0YXRlLnN0b3Jlcykge1xuICAgICAgICAgICAgICAgIHZhciBzdG9yZSA9IHByZXZTdGF0ZS5zdG9yZXNbc3RvcmVJZF07XG4gICAgICAgICAgICAgICAgc3RvcmUudW5zZWVuQ291bnQgPSBkYXRhW3N0b3JlSWRdIHx8IDA7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB1bnNlZW5Db3VudDogZGF0YS5zc19iZWxsX2NvdW50LFxuICAgICAgICAgICAgICAgIHN0b3JlczogX2V4dGVuZHMoe30sIHByZXZTdGF0ZS5zdG9yZXMpXG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIF90aGlzMi5jb25maWcuZW1pdHRlci5lbWl0KCdzeW5jX25vdGlmX3N0b3JlJyk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfSwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ1NVUFJTRU5EOiBlcnJvciBnZXR0aW5nIG5vdGlmaWNhdGlvbnMgY291bnQnLCBlKTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShfdGVtcCAmJiBfdGVtcC50aGVuID8gX3RlbXAudGhlbihmdW5jdGlvbiAoKSB7fSkgOiB2b2lkIDApO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlKTtcbiAgICB9XG4gIH07XG4gIF9wcm90by5tYXJrQ2xpY2tlZCA9IGZ1bmN0aW9uIG1hcmtDbGlja2VkKGlkKSB7XG4gICAgdHJ5IHtcbiAgICAgIHZhciBfbm90aWZTdG9yZSRzdG9yZXMyO1xuICAgICAgdmFyIF90aGlzMyA9IHRoaXM7XG4gICAgICB2YXIgYXBpQ2xpZW50ID0gX3RoaXMzLmNvbmZpZy5jbGllbnQ7XG4gICAgICB2YXIgbm90aWZTdG9yZSA9IG5vdGlmaWNhdGlvblN0b3JlLmdldFN0YXRlKCk7XG4gICAgICB2YXIgYWN0aXZlU3RvcmVJZCA9IG5vdGlmU3RvcmUuYWN0aXZlU3RvcmVJZDtcbiAgICAgIGlmICghYWN0aXZlU3RvcmVJZCB8fCAhKChfbm90aWZTdG9yZSRzdG9yZXMyID0gbm90aWZTdG9yZS5zdG9yZXMpICE9IG51bGwgJiYgX25vdGlmU3RvcmUkc3RvcmVzMlthY3RpdmVTdG9yZUlkXSkpIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgIHZhciBzdG9yZURhdGEgPSBub3RpZlN0b3JlLnN0b3Jlc1thY3RpdmVTdG9yZUlkXTtcbiAgICAgIHZhciBub3RpZmljYXRpb25zID0gc3RvcmVEYXRhLm5vdGlmaWNhdGlvbnM7XG4gICAgICB2YXIgY2xpY2tlZE5vdGlmaWNhdGlvbiA9IG5vdGlmaWNhdGlvbnMuZmluZChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICByZXR1cm4gaXRlbS5uX2lkID09PSBpZDtcbiAgICAgIH0pO1xuICAgICAgaWYgKGNsaWNrZWROb3RpZmljYXRpb24gJiYgKCFjbGlja2VkTm90aWZpY2F0aW9uLmludGVyYWN0ZWRfb24gfHwgIWNsaWNrZWROb3RpZmljYXRpb24uc2Vlbl9vbikpIHtcbiAgICAgICAgaWYgKCFhcGlDbGllbnQpIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBpZiAoIWNsaWNrZWROb3RpZmljYXRpb24uaW50ZXJhY3RlZF9vbikge1xuICAgICAgICAgICAgYXBpQ2xpZW50Lm1hcmtOb3RpZmljYXRpb25DbGlja2VkKGlkKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKCFjbGlja2VkTm90aWZpY2F0aW9uLnNlZW5fb24pIHtcbiAgICAgICAgICAgIGFwaUNsaWVudC5tYXJrTm90aWZpY2F0aW9uUmVhZChpZCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBjbGlja2VkT24gPSBlcG9jaE5vdygpO1xuICAgICAgICAgIGNsaWNrZWROb3RpZmljYXRpb24uaW50ZXJhY3RlZF9vbiA9IGNsaWNrZWRPbjtcbiAgICAgICAgICBpZiAoIWNsaWNrZWROb3RpZmljYXRpb24uc2Vlbl9vbikge1xuICAgICAgICAgICAgdmFyIF9sb29wID0gZnVuY3Rpb24gX2xvb3AoKSB7XG4gICAgICAgICAgICAgIHZhciBfc3RvcmUkbm90aWZpY2F0aW9ucztcbiAgICAgICAgICAgICAgdmFyIHN0b3JlID0gbm90aWZTdG9yZS5zdG9yZXNbc3RvcmVJZF07XG4gICAgICAgICAgICAgIChfc3RvcmUkbm90aWZpY2F0aW9ucyA9IHN0b3JlLm5vdGlmaWNhdGlvbnMpID09IG51bGwgPyB2b2lkIDAgOiBfc3RvcmUkbm90aWZpY2F0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgaWYgKGl0ZW0ubl9pZCA9PT0gY2xpY2tlZE5vdGlmaWNhdGlvbi5uX2lkKSB7XG4gICAgICAgICAgICAgICAgICBpdGVtLnNlZW5fb24gPSBjbGlja2VkT247XG4gICAgICAgICAgICAgICAgICBpdGVtLmludGVyYWN0ZWRfb24gPSBjbGlja2VkT247XG4gICAgICAgICAgICAgICAgICBpZiAoc3RvcmUudW5zZWVuQ291bnQgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0b3JlLnVuc2VlbkNvdW50IC09IDE7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBmb3IgKHZhciBzdG9yZUlkIGluIG5vdGlmU3RvcmUgPT0gbnVsbCA/IHZvaWQgMCA6IG5vdGlmU3RvcmUuc3RvcmVzKSB7XG4gICAgICAgICAgICAgIF9sb29wKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIG5vdGlmaWNhdGlvblN0b3JlLnNldFN0YXRlKF9leHRlbmRzKHt9LCBub3RpZlN0b3JlKSk7XG4gICAgICAgICAgX3RoaXMzLmNvbmZpZy5lbWl0dGVyLmVtaXQoJ3N5bmNfbm90aWZfc3RvcmUnKTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdTVVBSU0VORDogZXJyb3IgbWFya2luZyBub3RpZmljYXRpb24gY2xpY2tlZCcsIGUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGUpO1xuICAgIH1cbiAgfTtcbiAgX3Byb3RvLm1hcmtBbGxTZWVuID0gZnVuY3Rpb24gbWFya0FsbFNlZW4oKSB7XG4gICAgdHJ5IHtcbiAgICAgIHZhciBfdGhpczQgPSB0aGlzO1xuICAgICAgdmFyIGFwaUNsaWVudCA9IF90aGlzNC5jb25maWcuY2xpZW50O1xuICAgICAgdHJ5IHtcbiAgICAgICAgaWYgKCFhcGlDbGllbnQpIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgICAgYXBpQ2xpZW50Lm1hcmtCZWxsQ2xpY2tlZCgpO1xuICAgICAgICBub3RpZmljYXRpb25TdG9yZS5zZXRTdGF0ZSh7XG4gICAgICAgICAgdW5zZWVuQ291bnQ6IDBcbiAgICAgICAgfSk7XG4gICAgICAgIF90aGlzNC5jb25maWcuZW1pdHRlci5lbWl0KCdzeW5jX25vdGlmX3N0b3JlJyk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdTVVBSU0VORDogZXJyb3IgbWFya2luZyBhbGwgbm90aWZpY2F0aW9ucyBzZWVuJywgZSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGUpO1xuICAgIH1cbiAgfTtcbiAgX3Byb3RvLm1hcmtBbGxSZWFkID0gZnVuY3Rpb24gbWFya0FsbFJlYWQoKSB7XG4gICAgdHJ5IHtcbiAgICAgIHZhciBfdGhpczUgPSB0aGlzO1xuICAgICAgdmFyIGFwaUNsaWVudCA9IF90aGlzNS5jb25maWcuY2xpZW50O1xuICAgICAgdHJ5IHtcbiAgICAgICAgaWYgKCFhcGlDbGllbnQpIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgICAgYXBpQ2xpZW50Lm1hcmtBbGxSZWFkKCk7XG4gICAgICAgIHZhciBub3RpZlN0b3JlID0gbm90aWZpY2F0aW9uU3RvcmUuZ2V0U3RhdGUoKTtcbiAgICAgICAgdmFyIGNsaWNrZWRPbiA9IGVwb2NoTm93KCk7XG4gICAgICAgIGZvciAodmFyIHN0b3JlSWQgaW4gbm90aWZTdG9yZS5zdG9yZXMpIHtcbiAgICAgICAgICB2YXIgc3RvcmUgPSBub3RpZlN0b3JlLnN0b3Jlc1tzdG9yZUlkXTtcbiAgICAgICAgICBzdG9yZS5ub3RpZmljYXRpb25zLmZvckVhY2goZnVuY3Rpb24gKG5vdGlmaWNhdGlvbikge1xuICAgICAgICAgICAgaWYgKCFub3RpZmljYXRpb24uc2Vlbl9vbikge1xuICAgICAgICAgICAgICBub3RpZmljYXRpb24uc2Vlbl9vbiA9IGNsaWNrZWRPbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgICBzdG9yZS51bnNlZW5Db3VudCA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgbm90aWZpY2F0aW9uU3RvcmUuc2V0U3RhdGUoe1xuICAgICAgICAgIHN0b3Jlczogbm90aWZTdG9yZS5zdG9yZXNcbiAgICAgICAgfSk7XG4gICAgICAgIF90aGlzNS5jb25maWcuZW1pdHRlci5lbWl0KCdzeW5jX25vdGlmX3N0b3JlJyk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdTVVBSU0VORDogZXJyb3IgbWFya2luZyBhbGwgbm90aWZpY2F0aW9ucyByZWFkJywgZSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGUpO1xuICAgIH1cbiAgfTtcbiAgX3Byb3RvLm1hcmtSZWFkID0gZnVuY3Rpb24gbWFya1JlYWQoaWQpIHtcbiAgICB0cnkge1xuICAgICAgdmFyIF9ub3RpZlN0b3JlJHN0b3JlczM7XG4gICAgICB2YXIgX3RoaXM2ID0gdGhpcztcbiAgICAgIHZhciBhcGlDbGllbnQgPSBfdGhpczYuY29uZmlnLmNsaWVudDtcbiAgICAgIHZhciBub3RpZlN0b3JlID0gbm90aWZpY2F0aW9uU3RvcmUuZ2V0U3RhdGUoKTtcbiAgICAgIHZhciBhY3RpdmVTdG9yZUlkID0gbm90aWZTdG9yZS5hY3RpdmVTdG9yZUlkO1xuICAgICAgaWYgKCFhY3RpdmVTdG9yZUlkIHx8ICEoKF9ub3RpZlN0b3JlJHN0b3JlczMgPSBub3RpZlN0b3JlLnN0b3JlcykgIT0gbnVsbCAmJiBfbm90aWZTdG9yZSRzdG9yZXMzW2FjdGl2ZVN0b3JlSWRdKSkgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgdmFyIHN0b3JlRGF0YSA9IG5vdGlmU3RvcmUuc3RvcmVzW2FjdGl2ZVN0b3JlSWRdO1xuICAgICAgdmFyIG5vdGlmaWNhdGlvbnMgPSBzdG9yZURhdGEubm90aWZpY2F0aW9ucztcbiAgICAgIHZhciBjbGlja2VkTm90aWZpY2F0aW9uID0gbm90aWZpY2F0aW9ucy5maW5kKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgIHJldHVybiBpdGVtLm5faWQgPT09IGlkO1xuICAgICAgfSk7XG4gICAgICBpZiAoY2xpY2tlZE5vdGlmaWNhdGlvbiAmJiAhY2xpY2tlZE5vdGlmaWNhdGlvbi5zZWVuX29uKSB7XG4gICAgICAgIGlmICghYXBpQ2xpZW50KSByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgYXBpQ2xpZW50Lm1hcmtOb3RpZmljYXRpb25SZWFkKGlkKTtcbiAgICAgICAgICB2YXIgY2xpY2tlZE9uID0gZXBvY2hOb3coKTtcbiAgICAgICAgICBpZiAoIWNsaWNrZWROb3RpZmljYXRpb24uc2Vlbl9vbikge1xuICAgICAgICAgICAgdmFyIF9sb29wMiA9IGZ1bmN0aW9uIF9sb29wMigpIHtcbiAgICAgICAgICAgICAgdmFyIF9zdG9yZSRub3RpZmljYXRpb25zMjtcbiAgICAgICAgICAgICAgdmFyIHN0b3JlID0gbm90aWZTdG9yZS5zdG9yZXNbc3RvcmVJZF07XG4gICAgICAgICAgICAgIChfc3RvcmUkbm90aWZpY2F0aW9uczIgPSBzdG9yZS5ub3RpZmljYXRpb25zKSA9PSBudWxsID8gdm9pZCAwIDogX3N0b3JlJG5vdGlmaWNhdGlvbnMyLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICBpZiAoaXRlbS5uX2lkID09PSBjbGlja2VkTm90aWZpY2F0aW9uLm5faWQpIHtcbiAgICAgICAgICAgICAgICAgIGl0ZW0uc2Vlbl9vbiA9IGNsaWNrZWRPbjtcbiAgICAgICAgICAgICAgICAgIGlmIChzdG9yZS51bnNlZW5Db3VudCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgc3RvcmUudW5zZWVuQ291bnQgLT0gMTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGZvciAodmFyIHN0b3JlSWQgaW4gbm90aWZTdG9yZSA9PSBudWxsID8gdm9pZCAwIDogbm90aWZTdG9yZS5zdG9yZXMpIHtcbiAgICAgICAgICAgICAgX2xvb3AyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIG5vdGlmaWNhdGlvblN0b3JlLnNldFN0YXRlKF9leHRlbmRzKHt9LCBub3RpZlN0b3JlKSk7XG4gICAgICAgICAgX3RoaXM2LmNvbmZpZy5lbWl0dGVyLmVtaXQoJ3N5bmNfbm90aWZfc3RvcmUnKTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdTVVBSU0VORDogZXJyb3IgbWFya2luZyBub3RpZmljYXRpb24gcmVhZCcsIGUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGUpO1xuICAgIH1cbiAgfTtcbiAgX3Byb3RvLm1hcmtVblJlYWQgPSBmdW5jdGlvbiBtYXJrVW5SZWFkKGlkKSB7XG4gICAgdHJ5IHtcbiAgICAgIHZhciBfbm90aWZTdG9yZSRzdG9yZXM0O1xuICAgICAgdmFyIF90aGlzNyA9IHRoaXM7XG4gICAgICB2YXIgYXBpQ2xpZW50ID0gX3RoaXM3LmNvbmZpZy5jbGllbnQ7XG4gICAgICB2YXIgbm90aWZTdG9yZSA9IG5vdGlmaWNhdGlvblN0b3JlLmdldFN0YXRlKCk7XG4gICAgICB2YXIgYWN0aXZlU3RvcmVJZCA9IG5vdGlmU3RvcmUuYWN0aXZlU3RvcmVJZDtcbiAgICAgIGlmICghYWN0aXZlU3RvcmVJZCB8fCAhKChfbm90aWZTdG9yZSRzdG9yZXM0ID0gbm90aWZTdG9yZS5zdG9yZXMpICE9IG51bGwgJiYgX25vdGlmU3RvcmUkc3RvcmVzNFthY3RpdmVTdG9yZUlkXSkpIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgIHZhciBzdG9yZURhdGEgPSBub3RpZlN0b3JlLnN0b3Jlc1thY3RpdmVTdG9yZUlkXTtcbiAgICAgIHZhciBub3RpZmljYXRpb25zID0gc3RvcmVEYXRhLm5vdGlmaWNhdGlvbnM7XG4gICAgICB2YXIgY2xpY2tlZE5vdGlmaWNhdGlvbiA9IG5vdGlmaWNhdGlvbnMuZmluZChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICByZXR1cm4gaXRlbS5uX2lkID09PSBpZDtcbiAgICAgIH0pO1xuICAgICAgaWYgKGNsaWNrZWROb3RpZmljYXRpb24gJiYgY2xpY2tlZE5vdGlmaWNhdGlvbi5zZWVuX29uKSB7XG4gICAgICAgIGlmICghYXBpQ2xpZW50KSByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgYXBpQ2xpZW50Lm1hcmtOb3RpZmljYXRpb25VblJlYWQoaWQpO1xuICAgICAgICAgIGlmIChjbGlja2VkTm90aWZpY2F0aW9uLnNlZW5fb24pIHtcbiAgICAgICAgICAgIHZhciBfbG9vcDMgPSBmdW5jdGlvbiBfbG9vcDMoKSB7XG4gICAgICAgICAgICAgIHZhciBfc3RvcmUkbm90aWZpY2F0aW9uczM7XG4gICAgICAgICAgICAgIHZhciBzdG9yZSA9IG5vdGlmU3RvcmUuc3RvcmVzW3N0b3JlSWRdO1xuICAgICAgICAgICAgICAoX3N0b3JlJG5vdGlmaWNhdGlvbnMzID0gc3RvcmUubm90aWZpY2F0aW9ucykgPT0gbnVsbCA/IHZvaWQgMCA6IF9zdG9yZSRub3RpZmljYXRpb25zMy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgaWYgKGl0ZW0ubl9pZCA9PT0gY2xpY2tlZE5vdGlmaWNhdGlvbi5uX2lkKSB7XG4gICAgICAgICAgICAgICAgICBpdGVtLnNlZW5fb24gPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICBpZiAoc3RvcmUudW5zZWVuQ291bnQgPj0gMCkge1xuICAgICAgICAgICAgICAgICAgICBzdG9yZS51bnNlZW5Db3VudCArPSAxO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgZm9yICh2YXIgc3RvcmVJZCBpbiBub3RpZlN0b3JlID09IG51bGwgPyB2b2lkIDAgOiBub3RpZlN0b3JlLnN0b3Jlcykge1xuICAgICAgICAgICAgICBfbG9vcDMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgbm90aWZpY2F0aW9uU3RvcmUuc2V0U3RhdGUoX2V4dGVuZHMoe30sIG5vdGlmU3RvcmUpKTtcbiAgICAgICAgICBfdGhpczcuY29uZmlnLmVtaXR0ZXIuZW1pdCgnc3luY19ub3RpZl9zdG9yZScpO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ1NVUFJTRU5EOiBlcnJvciBtYXJraW5nIG5vdGlmaWNhdGlvbiByZWFkJywgZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZSk7XG4gICAgfVxuICB9O1xuICBfcHJvdG8ubWFya0FyY2hpdmVkID0gZnVuY3Rpb24gbWFya0FyY2hpdmVkKGlkKSB7XG4gICAgdmFyIF9ub3RpZlN0b3JlJHN0b3JlczU7XG4gICAgdmFyIGFwaUNsaWVudCA9IHRoaXMuY29uZmlnLmNsaWVudDtcbiAgICB2YXIgbm90aWZTdG9yZSA9IG5vdGlmaWNhdGlvblN0b3JlLmdldFN0YXRlKCk7XG4gICAgdmFyIGFjdGl2ZVN0b3JlSWQgPSBub3RpZlN0b3JlLmFjdGl2ZVN0b3JlSWQ7XG4gICAgaWYgKCFhY3RpdmVTdG9yZUlkIHx8ICEoKF9ub3RpZlN0b3JlJHN0b3JlczUgPSBub3RpZlN0b3JlLnN0b3JlcykgIT0gbnVsbCAmJiBfbm90aWZTdG9yZSRzdG9yZXM1W2FjdGl2ZVN0b3JlSWRdKSkgcmV0dXJuO1xuICAgIHZhciBzdG9yZXMgPSBub3RpZlN0b3JlID09IG51bGwgPyB2b2lkIDAgOiBub3RpZlN0b3JlLnN0b3JlcztcbiAgICB2YXIgc3RvcmVEYXRhID0gc3RvcmVzW2FjdGl2ZVN0b3JlSWRdO1xuICAgIHZhciBjbGlja2VkTm90aWZpY2F0aW9uID0gc3RvcmVEYXRhLm5vdGlmaWNhdGlvbnMuZmluZChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgcmV0dXJuIGl0ZW0ubl9pZCA9PT0gaWQ7XG4gICAgfSk7XG4gICAgaWYgKGNsaWNrZWROb3RpZmljYXRpb24gJiYgIWNsaWNrZWROb3RpZmljYXRpb24uYXJjaGl2ZWQpIHtcbiAgICAgIGlmICghYXBpQ2xpZW50KSByZXR1cm47XG4gICAgICB0cnkge1xuICAgICAgICBhcGlDbGllbnQubWFya05vdGlmaWNhdGlvbkFyY2hpdmUoaWQpO1xuICAgICAgICBzdG9yZURhdGEubm90aWZpY2F0aW9ucyA9IHN0b3JlRGF0YS5ub3RpZmljYXRpb25zLmZpbHRlcihmdW5jdGlvbiAobm90aWZpY2F0aW9uKSB7XG4gICAgICAgICAgcmV0dXJuIG5vdGlmaWNhdGlvbi5uX2lkICE9PSBpZDtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmICghY2xpY2tlZE5vdGlmaWNhdGlvbi5zZWVuX29uICYmIHN0b3JlRGF0YS51bnNlZW5Db3VudCA+IDApIHtcbiAgICAgICAgICBzdG9yZURhdGEudW5zZWVuQ291bnQgLT0gMTtcbiAgICAgICAgfVxuICAgICAgICBub3RpZmljYXRpb25TdG9yZS5zZXRTdGF0ZShfZXh0ZW5kcyh7fSwgbm90aWZTdG9yZSkpO1xuICAgICAgICB0aGlzLmNvbmZpZy5lbWl0dGVyLmVtaXQoJ3N5bmNfbm90aWZfc3RvcmUnKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ1NVUFJTRU5EOiBlcnJvciBtYXJraW5nIG5vdGlmaWNhdGlvbiBhcmNoaXZlZCcsIGUpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbiAgX2NyZWF0ZUNsYXNzKEluYm94LCBbe1xuICAgIGtleTogXCJzdG9yZXNcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLmNvbmZpZy5zdG9yZXM7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiBcImRhdGFcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHZhciBub3RpZlN0b3JlID0gbm90aWZpY2F0aW9uU3RvcmUuZ2V0U3RhdGUoKTtcbiAgICAgIHZhciBhY3RpdmVTdG9yZUlkID0gbm90aWZTdG9yZS5hY3RpdmVTdG9yZUlkO1xuICAgICAgdmFyIHN0b3JlRmlsdGVycyA9IHRoaXMuc3RvcmVzO1xuICAgICAgaWYgKCFhY3RpdmVTdG9yZUlkKSByZXR1cm47XG4gICAgICByZXR1cm4ge1xuICAgICAgICB1bnNlZW5Db3VudDogbm90aWZTdG9yZS51bnNlZW5Db3VudCxcbiAgICAgICAgYWN0aXZlU3RvcmVJZDogbm90aWZTdG9yZS5hY3RpdmVTdG9yZUlkLFxuICAgICAgICBzdG9yZXM6IG5vdGlmU3RvcmUuc3RvcmVzLFxuICAgICAgICBoYXNTdG9yZXM6IHN0b3JlRmlsdGVycyA/IChzdG9yZUZpbHRlcnMgPT0gbnVsbCA/IHZvaWQgMCA6IHN0b3JlRmlsdGVycy5sZW5ndGgpID4gMCA6IGZhbHNlLFxuICAgICAgICBoYXNOZXh0OiBub3RpZlN0b3JlLmhhc05leHQsXG4gICAgICAgIGluaXRpYWxMb2FkaW5nOiBub3RpZlN0b3JlLmluaXRpYWxMb2FkaW5nLFxuICAgICAgICBmZXRjaE1vcmVMb2FkaW5nOiBub3RpZlN0b3JlLmZldGNoTW9yZUxvYWRpbmdcbiAgICAgIH07XG4gICAgfVxuICB9XSk7XG4gIHJldHVybiBJbmJveDtcbn0oKTtcblxudmFyIFN1cHJTZW5kSW5ib3ggPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBTdXByU2VuZEluYm94KHdvcmtzcGFjZUtleSwgY29uZmlnKSB7XG4gICAgdGhpcy53b3Jrc3BhY2VLZXkgPSAnJztcbiAgICB0aGlzLnRlbmFudElkID0gdm9pZCAwO1xuICAgIHRoaXMuc3RvcmVzID0gdm9pZCAwO1xuICAgIHRoaXMuZGlzdGluY3RJZCA9IHZvaWQgMDtcbiAgICB0aGlzLnN1YnNjcmliZXJJZCA9IHZvaWQgMDtcbiAgICB0aGlzLl9jbGllbnQgPSB2b2lkIDA7XG4gICAgdGhpcy5fZXhwaXJ5VGltZXJJZCA9IHZvaWQgMDtcbiAgICB0aGlzLmZlZWQgPSBuZXcgSW5ib3godGhpcyk7XG4gICAgdGhpcy5lbWl0dGVyID0gbWl0dF9fZGVmYXVsdFtcImRlZmF1bHRcIl0oKTtcbiAgICB0aGlzLl92YWxpZGF0ZUNvbmZpZyh3b3Jrc3BhY2VLZXkpO1xuICAgIHRoaXMudGVuYW50SWQgPSAoY29uZmlnID09IG51bGwgPyB2b2lkIDAgOiBjb25maWcudGVuYW50SUQpIHx8ICdkZWZhdWx0JztcbiAgICB0aGlzLl92YWxpZGF0ZVN0b3JlKGNvbmZpZyA9PSBudWxsID8gdm9pZCAwIDogY29uZmlnLnN0b3Jlcyk7XG4gICAgdGhpcy5fdmFsaWRhdGVQYWdlU2l6ZShjb25maWcgPT0gbnVsbCA/IHZvaWQgMCA6IGNvbmZpZy5wYWdlU2l6ZSk7XG4gICAgdGhpcy5faW5pdGlhbGl6ZVN0b3JlU3RhdGUoKTtcbiAgfVxuICB2YXIgX3Byb3RvID0gU3VwclNlbmRJbmJveC5wcm90b3R5cGU7XG4gIF9wcm90by5fdmFsaWRhdGVDb25maWcgPSBmdW5jdGlvbiBfdmFsaWRhdGVDb25maWcod29ya3NwYWNlS2V5KSB7XG4gICAgaWYgKCF3b3Jrc3BhY2VLZXkpIHtcbiAgICAgIHRocm93IG5ldyBTdXByU2VuZEVycm9yKCd3b3Jrc3BhY2VLZXkgbWlzc2luZycpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLndvcmtzcGFjZUtleSA9IHdvcmtzcGFjZUtleTtcbiAgICB9XG4gIH07XG4gIF9wcm90by5fdmFsaWRhdGVTdG9yZSA9IGZ1bmN0aW9uIF92YWxpZGF0ZVN0b3JlKHN0b3Jlcykge1xuICAgIGlmICghc3RvcmVzIHx8ICFBcnJheS5pc0FycmF5KHN0b3JlcykpIHJldHVybjtcbiAgICB2YXIgdmFsaWRhdGVkU3RvcmVzID0gW107XG4gICAgc3RvcmVzLmZvckVhY2goZnVuY3Rpb24gKHN0b3JlKSB7XG4gICAgICBpZiAoIXN0b3JlLnN0b3JlSWQpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ1N1cHJTZW5kSW5ib3g6IHN0b3JlSWQgaXMgbWFuZGF0b3J5IGlmIHN0b3JlcyBhcmUgdXNlZCcpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB2YXIgcXVlcnkgPSBzdG9yZSA9PSBudWxsID8gdm9pZCAwIDogc3RvcmUucXVlcnk7XG4gICAgICB2YXIgcmVhZDtcbiAgICAgIHZhciB0YWdzID0gW107XG4gICAgICB2YXIgY2F0ZWdvcmllcyA9IFtdO1xuICAgICAgdmFyIGFyY2hpdmVkO1xuICAgICAgaWYgKHR5cGVvZiAocXVlcnkgPT0gbnVsbCA/IHZvaWQgMCA6IHF1ZXJ5LnJlYWQpID09PSAnYm9vbGVhbicpIHtcbiAgICAgICAgcmVhZCA9IHF1ZXJ5LnJlYWQ7XG4gICAgICB9XG4gICAgICBpZiAodHlwZW9mIChxdWVyeSA9PSBudWxsID8gdm9pZCAwIDogcXVlcnkuYXJjaGl2ZWQpID09PSAnYm9vbGVhbicpIHtcbiAgICAgICAgYXJjaGl2ZWQgPSBxdWVyeS5hcmNoaXZlZDtcbiAgICAgIH1cbiAgICAgIGlmICh0eXBlb2YgKHF1ZXJ5ID09IG51bGwgPyB2b2lkIDAgOiBxdWVyeS50YWdzKSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgdGFncyA9IFtxdWVyeS50YWdzXTtcbiAgICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShxdWVyeSA9PSBudWxsID8gdm9pZCAwIDogcXVlcnkudGFncykpIHtcbiAgICAgICAgdGFncyA9IHF1ZXJ5ID09IG51bGwgPyB2b2lkIDAgOiBxdWVyeS50YWdzLmZpbHRlcihmdW5jdGlvbiAodGFnKSB7XG4gICAgICAgICAgcmV0dXJuIHR5cGVvZiB0YWcgPT09ICdzdHJpbmcnO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmICh0eXBlb2YgKHF1ZXJ5ID09IG51bGwgPyB2b2lkIDAgOiBxdWVyeS5jYXRlZ29yaWVzKSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgY2F0ZWdvcmllcyA9IFtxdWVyeS5jYXRlZ29yaWVzXTtcbiAgICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShxdWVyeSA9PSBudWxsID8gdm9pZCAwIDogcXVlcnkuY2F0ZWdvcmllcykpIHtcbiAgICAgICAgY2F0ZWdvcmllcyA9IHF1ZXJ5ID09IG51bGwgPyB2b2lkIDAgOiBxdWVyeS5jYXRlZ29yaWVzLmZpbHRlcihmdW5jdGlvbiAoY2F0ZWdvcnkpIHtcbiAgICAgICAgICByZXR1cm4gdHlwZW9mIGNhdGVnb3J5ID09PSAnc3RyaW5nJztcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICB2YWxpZGF0ZWRTdG9yZXMucHVzaCh7XG4gICAgICAgIHN0b3JlSWQ6IHN0b3JlLnN0b3JlSWQsXG4gICAgICAgIGxhYmVsOiBzdG9yZS5sYWJlbCB8fCBzdG9yZS5zdG9yZUlkLFxuICAgICAgICBxdWVyeToge1xuICAgICAgICAgIGFyY2hpdmVkOiBhcmNoaXZlZCxcbiAgICAgICAgICByZWFkOiByZWFkLFxuICAgICAgICAgIHRhZ3M6IHRhZ3MsXG4gICAgICAgICAgY2F0ZWdvcmllczogY2F0ZWdvcmllc1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgICB0aGlzLnN0b3JlcyA9IHZhbGlkYXRlZFN0b3JlcztcbiAgfTtcbiAgX3Byb3RvLl92YWxpZGF0ZVBhZ2VTaXplID0gZnVuY3Rpb24gX3ZhbGlkYXRlUGFnZVNpemUocGFnZVNpemUpIHtcbiAgICBpZiAocGFnZVNpemUgJiYgdHlwZW9mIHBhZ2VTaXplID09PSAnbnVtYmVyJykge1xuICAgICAgdmFyIE1BWF9BTExPV0VEX1BBR0VfU0laRSA9IDUwO1xuICAgICAgdmFyIHZhbGlkYXRlZFBhZ2VTaXplID0gcGFnZVNpemUgPD0gTUFYX0FMTE9XRURfUEFHRV9TSVpFID8gcGFnZVNpemUgOiBNQVhfQUxMT1dFRF9QQUdFX1NJWkU7XG4gICAgICBjb25maWd1cmF0aW9uU3RvcmUuc2V0U3RhdGUoe1xuICAgICAgICBwYWdlU2l6ZTogdmFsaWRhdGVkUGFnZVNpemVcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcbiAgX3Byb3RvLl9pbml0aWFsaXplU3RvcmVTdGF0ZSA9IGZ1bmN0aW9uIF9pbml0aWFsaXplU3RvcmVTdGF0ZSgpIHtcbiAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgIHZhciBkZWZhdWx0X3N0b3JlID0gJ2RlZmF1bHRfc3RvcmUnO1xuICAgIHZhciBpbml0aWFsU3RvcmVEYXRhID0ge1xuICAgICAgbm90aWZpY2F0aW9uczogW10sXG4gICAgICB1bnNlZW5Db3VudDogMCxcbiAgICAgIGlzRmlyc3RDYWxsOiB0cnVlXG4gICAgfTtcbiAgICBpZiAodGhpcy5zdG9yZXMgJiYgQXJyYXkuaXNBcnJheSh0aGlzLnN0b3JlcykgJiYgdGhpcy5zdG9yZXMubGVuZ3RoID4gMCkge1xuICAgICAgdmFyIGZpbmFsU3RvcmVzID0ge307XG4gICAgICB0aGlzLnN0b3Jlcy5tYXAoZnVuY3Rpb24gKHN0b3JlKSB7XG4gICAgICAgIGZpbmFsU3RvcmVzW3N0b3JlLnN0b3JlSWRdID0gX2V4dGVuZHMoe30sIGluaXRpYWxTdG9yZURhdGEpO1xuICAgICAgfSk7XG4gICAgICBub3RpZmljYXRpb25TdG9yZS5zZXRTdGF0ZSh7XG4gICAgICAgIHN0b3JlczogZmluYWxTdG9yZXMsXG4gICAgICAgIGFjdGl2ZVN0b3JlSWQ6IHRoaXMuc3RvcmVzWzBdLnN0b3JlSWRcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgX3N0b3JlcztcbiAgICAgIG5vdGlmaWNhdGlvblN0b3JlLnNldFN0YXRlKHtcbiAgICAgICAgc3RvcmVzOiAoX3N0b3JlcyA9IHt9LCBfc3RvcmVzW2RlZmF1bHRfc3RvcmVdID0gX2V4dGVuZHMoe30sIGluaXRpYWxTdG9yZURhdGEpLCBfc3RvcmVzKSxcbiAgICAgICAgYWN0aXZlU3RvcmVJZDogZGVmYXVsdF9zdG9yZVxuICAgICAgfSk7XG4gICAgfVxuICAgIC8vIG5lZWRlZCBhcyB3YWl0IGZvciBldmVuIGxpc3RlbmVyIHRvIHJlZ2lzdGVyIGFmdGVyIGluaXRpYWxpemF0aW9uXG4gICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICBfdGhpcy5lbWl0dGVyLmVtaXQoJ3N5bmNfbm90aWZfc3RvcmUnKTtcbiAgICB9LCAwKTtcbiAgfTtcbiAgX3Byb3RvLl9zdGFydEV4aXByeUNoZWNrID0gZnVuY3Rpb24gX3N0YXJ0RXhpcHJ5Q2hlY2soKSB7XG4gICAgdmFyIF90aGlzMiA9IHRoaXM7XG4gICAgaWYgKHRoaXMuX2V4cGlyeVRpbWVySWQpIHJldHVybjtcbiAgICB0aGlzLl9leHBpcnlUaW1lcklkID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgdmFyIG5vdGlmRGF0YSA9IG5vdGlmaWNhdGlvblN0b3JlLmdldFN0YXRlKCk7XG4gICAgICAgIHZhciBzdG9yZU5vdGlmc0RhdGEgPSBub3RpZkRhdGEuc3RvcmVzO1xuICAgICAgICB2YXIgaGFzRXhwaXJlZCA9IGZhbHNlO1xuICAgICAgICBmb3IgKHZhciBzdG9yZSBpbiBzdG9yZU5vdGlmc0RhdGEpIHtcbiAgICAgICAgICB2YXIgbm90aWZpY2F0aW9ucyA9IHN0b3JlTm90aWZzRGF0YVtzdG9yZV0ubm90aWZpY2F0aW9ucztcbiAgICAgICAgICBub3RpZmljYXRpb25zID0gbm90aWZpY2F0aW9ucy5maWx0ZXIoZnVuY3Rpb24gKG5vdGlmaWNhdGlvbikge1xuICAgICAgICAgICAgdmFyIGV4cGlyZWQgPSBub3RpZmljYXRpb24uZXhwaXJ5ID8gRGF0ZS5ub3coKSA+IG5vdGlmaWNhdGlvbi5leHBpcnkgOiBmYWxzZTtcbiAgICAgICAgICAgIGlmIChleHBpcmVkKSB7XG4gICAgICAgICAgICAgIGhhc0V4cGlyZWQgPSB0cnVlO1xuICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgICBzdG9yZU5vdGlmc0RhdGFbc3RvcmVdLm5vdGlmaWNhdGlvbnMgPSBub3RpZmljYXRpb25zO1xuICAgICAgICB9XG4gICAgICAgIHZhciBfdGVtcCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBpZiAoaGFzRXhwaXJlZCkge1xuICAgICAgICAgICAgbm90aWZpY2F0aW9uU3RvcmUuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICBzdG9yZXM6IHN0b3JlTm90aWZzRGF0YVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKF90aGlzMi5mZWVkLmdldE5vdGlmaWNhdGlvbnNDb3VudCgpKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgX3RoaXMyLmVtaXR0ZXIuZW1pdCgnc3luY19ub3RpZl9zdG9yZScpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KCk7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoX3RlbXAgJiYgX3RlbXAudGhlbiA/IF90ZW1wLnRoZW4oZnVuY3Rpb24gKCkge30pIDogdm9pZCAwKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGUpO1xuICAgICAgfVxuICAgIH0sIDMwMDAwKTtcbiAgfTtcbiAgX3Byb3RvLmlkZW50aWZ5VXNlciA9IGZ1bmN0aW9uIGlkZW50aWZ5VXNlcihkaXN0aW5jdElkLCBzdWJzY3JpYmVySWQpIHtcbiAgICB0aGlzLmRpc3RpbmN0SWQgPSBkaXN0aW5jdElkO1xuICAgIHRoaXMuc3Vic2NyaWJlcklkID0gc3Vic2NyaWJlcklkO1xuICB9O1xuICBfcHJvdG8uY2hhbmdlQWN0aXZlU3RvcmUgPSBmdW5jdGlvbiBjaGFuZ2VBY3RpdmVTdG9yZShzdG9yZUlkKSB7XG4gICAgdmFyIF9zdG9yZURhdGEkc3RvcmVzO1xuICAgIHZhciBzdG9yZURhdGEgPSBub3RpZmljYXRpb25TdG9yZS5nZXRTdGF0ZSgpO1xuICAgIHZhciBuZXdTdG9yZXMgPSB7fTtcbiAgICBpZiAoc3RvcmVEYXRhLmFjdGl2ZVN0b3JlSWQgPT09IHN0b3JlSWQpIHJldHVybjtcbiAgICBpZiAoISgoX3N0b3JlRGF0YSRzdG9yZXMgPSBzdG9yZURhdGEuc3RvcmVzKSAhPSBudWxsICYmIF9zdG9yZURhdGEkc3RvcmVzW3N0b3JlSWRdKSkgcmV0dXJuO1xuICAgIGZvciAodmFyIF9zdG9yZUlkIGluIHN0b3JlRGF0YS5zdG9yZXMpIHtcbiAgICAgIHZhciBzdG9yZSA9IHN0b3JlRGF0YS5zdG9yZXNbX3N0b3JlSWRdO1xuICAgICAgdmFyIHN0b3JlTm90aWZpY2F0aW9ucyA9IHN0b3JlLm5vdGlmaWNhdGlvbnMuc2xpY2UoMCwgMjApO1xuICAgICAgbmV3U3RvcmVzW19zdG9yZUlkXSA9IHtcbiAgICAgICAgbm90aWZpY2F0aW9uczogc3RvcmVOb3RpZmljYXRpb25zLFxuICAgICAgICB1bnNlZW5Db3VudDogc3RvcmUudW5zZWVuQ291bnQsXG4gICAgICAgIGlzRmlyc3RDYWxsOiBzdG9yZS5pc0ZpcnN0Q2FsbFxuICAgICAgfTtcbiAgICB9XG4gICAgbm90aWZpY2F0aW9uU3RvcmUuc2V0U3RhdGUoe1xuICAgICAgYWN0aXZlU3RvcmVJZDogc3RvcmVJZCxcbiAgICAgIHN0b3JlczogbmV3U3RvcmVzLFxuICAgICAgcGFnZU51bWJlcjogMSxcbiAgICAgIGhhc05leHQ6IHRydWUsXG4gICAgICBpbml0aWFsTG9hZGluZzogZmFsc2UsXG4gICAgICBmZXRjaE1vcmVMb2FkaW5nOiBmYWxzZSxcbiAgICAgIGluaXRpYWxGZXRjaFRpbWU6IG51bGxcbiAgICB9KTtcbiAgICBpZiAodGhpcy5jbGllbnQpIHtcbiAgICAgIHRoaXMuZmVlZC5mZXRjaE5vdGlmaWNhdGlvbnMoKTtcbiAgICB9XG4gIH07XG4gIF9wcm90by5yZXNldFVzZXIgPSBmdW5jdGlvbiByZXNldFVzZXIoKSB7XG4gICAgdmFyIF90aGlzJF9jbGllbnQ7XG4gICAgbm90aWZpY2F0aW9uU3RvcmUuc2V0U3RhdGUoe1xuICAgICAgdW5zZWVuQ291bnQ6IDAsXG4gICAgICBwYWdlTnVtYmVyOiAxLFxuICAgICAgaGFzTmV4dDogdHJ1ZSxcbiAgICAgIGluaXRpYWxMb2FkaW5nOiBmYWxzZSxcbiAgICAgIGZldGNoTW9yZUxvYWRpbmc6IGZhbHNlLFxuICAgICAgaW5pdGlhbEZldGNoVGltZTogbnVsbFxuICAgIH0pO1xuICAgIHRoaXMuX2luaXRpYWxpemVTdG9yZVN0YXRlKCk7XG4gICAgKF90aGlzJF9jbGllbnQgPSB0aGlzLl9jbGllbnQpID09IG51bGwgPyB2b2lkIDAgOiBfdGhpcyRfY2xpZW50LnNvY2tldC5kaXNjb25uZWN0KCk7XG4gICAgdGhpcy5kaXN0aW5jdElkID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuc3Vic2NyaWJlcklkID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuX2NsaWVudCA9IHVuZGVmaW5lZDtcbiAgICBjbGVhckludGVydmFsKHRoaXMuX2V4cGlyeVRpbWVySWQpO1xuICAgIHRoaXMuX2V4cGlyeVRpbWVySWQgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5mZWVkID0gbmV3IEluYm94KHRoaXMpO1xuICB9O1xuICBfY3JlYXRlQ2xhc3MoU3VwclNlbmRJbmJveCwgW3tcbiAgICBrZXk6IFwiY2xpZW50XCIsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICBpZiAodGhpcy5kaXN0aW5jdElkICYmIHRoaXMuc3Vic2NyaWJlcklkKSB7XG4gICAgICAgIGlmICghdGhpcy5fY2xpZW50KSB7XG4gICAgICAgICAgdGhpcy5fY2xpZW50ID0gbmV3IEFwaUNsaWVudCh0aGlzKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXMuX2NsaWVudDtcbiAgICB9XG4gIH1dKTtcbiAgcmV0dXJuIFN1cHJTZW5kSW5ib3g7XG59KCk7XG5cbm1vZHVsZS5leHBvcnRzID0gU3VwclNlbmRJbmJveDtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmNqcy5tYXBcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@suprsend/js-inbox/dist/index.cjs\n");

/***/ })

};
;